


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta content="Vision, Library, Vitis Vision Library, Iterative Pyramidal, Corner Tracking, cornerUpdate, cornersImgToList, cv, mat" name="keywords" />
<meta content="Vitis Vision library application programming interface reference." name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />

		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="_static/js/jquery.min.js"></script>	
	  <script type="text/javascript" src="_static/js/gtm.js"></script>
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="_static/js/common-ui-all.min.js"></script>		
    <script type="text/javascript" src="_static/js/header-footer.min.js"></script>	
    <script type="text/javascript" src="_static/js/jquery-ui.min.js"></script>	
    <script type="text/javascript" src="_static/js/CoveoJsSearch.Lazy.min.js"></script>	
    <script type="text/javascript" src="_static/js/linkid.js"></script>		
    <script type="text/javascript" src="_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search" 
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a> 
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search" 
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Vitis Vision Library
          

          
          </a>

          
            
            
              <div class="version">
                2020.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Vitis Vision Library User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#getting-started-with-vitis-vision">Getting Started with Vitis Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#getting-started-with-hls">Getting Started with HLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#design-examples-using-vitis-vision-library">Design Examples Using Vitis Vision Library</a></li>
</ul>
<p class="caption"><span class="caption-text">Vitis Vision Library API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#xf-cv-mat-image-container-class">xf::cv::Mat Image Container Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-definition">Class Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pixel-level-parallelism">Pixel-Level Parallelism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#macros-to-work-with-parallelism">Macros to Work With Parallelism</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-types">Data Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#manipulating-data-type">Manipulating Data Type</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xf-cv-imread">xf::cv::imread</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xf-cv-imwrite">xf::cv::imwrite</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xf-cv-absdiff">xf::cv::absDiff</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xf-cv-convertto">xf::cv::convertTo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#vitis-vision-library-functions">Vitis Vision Library Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#absolute-difference">Absolute Difference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accumulate">Accumulate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accumulate-squared">Accumulate Squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accumulate-weighted">Accumulate Weighted</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adds">AddS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#addweighted">Addweighted</a></li>
<li class="toctree-l2"><a class="reference internal" href="#autoexposurecorrection">Autoexposurecorrection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">Autowhitebalance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#badpixelcorrection">Badpixelcorrection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#brute-force-bf-feature-matcher">Brute-force (Bf) Feature Matcher</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bilateral-filter">Bilateral Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bit-depth-conversion">Bit Depth Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bitwise-and">Bitwise AND</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bitwise-not">Bitwise NOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bitwise-or">Bitwise OR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bitwise-xor">Bitwise XOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blacklevelcorrection">Blacklevelcorrection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#box-filter">Box Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#boundingbox">BoundingBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="#canny-edge-detection">Canny Edge Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#channel-combine">Channel Combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="#channel-extract">Channel Extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#color-conversion">Color Conversion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rgb-to-yuv-conversion-matrix">RGB to YUV Conversion Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yuv-to-rgb-conversion-matrix">YUV to RGB Conversion Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgba-rgb-to-yuv4">RGBA/RGB to YUV4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgba-rgb-to-iyuv">RGBA/RGB to IYUV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgba-to-nv12">RGBA to NV12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgba-to-nv21">RGBA to NV21</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yuyv-to-rgba">YUYV to RGBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yuyv-to-nv12">YUYV to NV12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yuyv-to-iyuv">YUYV to IYUV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uyvy-to-iyuv">UYVY to IYUV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uyvy-to-nv12">UYVY to NV12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iyuv-to-rgba-rgb">IYUV to RGBA/RGB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iyuv-to-nv12">IYUV to NV12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iyuv-to-yuv4">IYUV to YUV4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-to-iyuv">NV12 to IYUV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-to-rgba">NV12 to RGBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-to-yuv4">NV12 to YUV4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv21-to-iyuv">NV21 to IYUV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv21-to-rgba">NV21 to RGBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv21-to-yuv4">NV21 to YUV4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-to-gray">RGB to GRAY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bgr-to-gray">BGR to GRAY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gray-to-rgb">GRAY to RGB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gray-to-bgr">GRAY to BGR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-to-xyz">RGB to XYZ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bgr-to-xyz">BGR to XYZ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-bgr-to-hsv">RGB/BGR to HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-bgr-to-hls">RGB/BGR to HLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ycrcb-to-rgb-bgr">YCrCb to RGB/BGR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hsv-to-rgb-bgr">HSV to RGB/BGR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-nv21-to-rgb-bgr">NV12/NV21 to RGB/ BGR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nv122rgb">NV122RGB:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv122bgr">NV122BGR:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv212rgb">NV212RGB:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv212bgr">NV212BGR:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-to-nv21-nv21-to-nv12">NV12 to NV21/NV21 to NV12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nv122nv21">NV122NV21:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv212nv12">NV212NV12:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nv12-nv21-to-uyvy-yuyv">NV12/NV21 to UYVY/YUYV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nv122uyvy">NV122UYVY:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv122yuyv">NV122YUYV:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv212uyvy">NV212UYVY:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nv212yuyv">NV212YUYV:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#uyvy-yuyv-to-rgb-bgr">UYVY/YUYV to RGB/BGR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#yuyv2rgb">YUYV2RGB:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yuyv2bgr">YUYV2BGR:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uyvy2rgb">UYVY2RGB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uyvy2bgr">UYVY2BGR:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#uyvy-to-yuyv-yuyv-to-uyvy">UYVY to YUYV/ YUYV to UYVY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#uyvy2yuyv">UYVY2YUYV:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yuyv2uyvy">YUYV2UYVY:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#uyvy-yuyv-to-nv21">UYVY/YUYV to NV21</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#uyvy2nv21">UYVY2NV21:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yuyv2nv21">YUYV2NV21:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-bgr-to-nv12-nv21">RGB/ BGR to NV12/NV21</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rgb2nv12">RGB2NV12</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgr2nv12">BGR2NV12</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rgb2nv21">RGB2NV21</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgr2nv21">BGR2NV21</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bgr-to-rgb-rgb-to-bgr">BGR to RGB / RGB to BGR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rgb-bgr-to-uyvy-yuyv">RGB/BGR to UYVY/YUYV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rgb-to-uyvy">RGB to UYVY:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rgb-to-yuyv">RGB to YUYV:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgr-to-uyvy">BGR to UYVY:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgr-to-yuyv">BGR to YUYV:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#xyz-to-rgb-bgr">XYZ to RGB/BGR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#color-correction-matrix">Color correction matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#color-thresholding">Color Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compare">Compare</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compares">CompareS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convertscaleabs">convertScaleAbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crop">Crop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#multiple-roi-extraction">Multiple ROI Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-roi-extraction-example">Multiple ROI Extraction Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#custom-convolution">Custom Convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delay">Delay</a></li>
<li class="toctree-l2"><a class="reference internal" href="#demosaicing">Demosaicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dilate">Dilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#distance-transform-feature-matcher">Distance Transform Feature Matcher</a></li>
<li class="toctree-l2"><a class="reference internal" href="#duplicate">Duplicate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#erode">Erode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fast-corner-detection">FAST Corner Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gaincontrol">Gaincontrol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gammacorrection">Gammacorrection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gaussian-filter">Gaussian Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gradient-magnitude">Gradient Magnitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gradient-phase">Gradient Phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="#harris-corner-detection">Harris Corner Detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#non-maximum-suppression">Non-Maximum Suppression:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#threshold">Threshold:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#histogram-computation">Histogram Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#histogram-equalization">Histogram Equalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hog">HOG</a></li>
<li class="toctree-l2"><a class="reference internal" href="#houghlines">HoughLines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing-for-deep-neural-networks">Preprocessing for Deep Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyramid-up">Pyramid Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyramid-down">Pyramid Down</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initundistortrectifymapinverse">InitUndistortRectifyMapInverse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inrange">InRange</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integral-image">Integral Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dense-pyramidal-lk-optical">Dense Pyramidal LK Optical Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dense-non-pyramidal-lk-optical">Dense Non-Pyramidal LK Optical Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kalman-filter">Kalman Filter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#extended-kalman-filter">Extended Kalman Filter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-for-extended-kalman-filter">Example for Extended Kalman Filter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#laplacian-operator">Laplacian Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lens-shading-correction">Lens shading correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-tone-mapping">Local Tone Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#look-up-table">Look Up Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mean-and-standard-deviation">Mean and Standard Deviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#max">Max</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maxs">MaxS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#median-blur-filter">Median Blur Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#min">Min</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mins">MinS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#minmax-location">MinMax Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mean-shift-tracking">Mean Shift Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mode-filter">Mode filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#otsu-threshold">Otsu Threshold</a></li>
<li class="toctree-l2"><a class="reference internal" href="#paintmask">Paintmask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pixel-wise-addition">Pixel-Wise Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pixel-wise-multiplication">Pixel-Wise Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pixel-wise-subtraction">Pixel-Wise Subtraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantization-dithering">Quantization &amp; Dithering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reduce">Reduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remap">Remap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resolution-conversion">Resolution Conversion (Resize)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bgr2hsv">BGR2HSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scharr-filter">Scharr Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#set">Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sobel-filter">Sobel Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#semi-global-method-for-stereo-disparity-estimation">Semi Global Method for Stereo Disparity Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stereo-local-block-matching">Stereo Local Block Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subrs">SubRS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subs">SubS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sum">Sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#svm">SVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thresholding">Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#atan2">Atan2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inverse-reciprocal">Inverse (Reciprocal)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#square-root">Square Root</a></li>
<li class="toctree-l2"><a class="reference internal" href="#warptransform">WarpTransform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zero">Zero</a></li>
</ul>
</li>
</ul>

            
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="_sources/api-reference.rst.txt"
						rel="nofollow">Show Source</a></li>						
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Vitis Vision Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api-reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview">
<span id="libapireference"></span><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>To facilitate local memory allocation on FPGA devices, the Vitis Vision
library functions are provided in templates with compile-time
parameters. Data is explicitly copied from <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code> to <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code>
and is stored in physically contiguous memory to achieve the best
possible performance. After processing, the output in <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> is
copied back to <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code> to write it into the memory.</p>
</div>
<div class="section" id="xf-cv-mat-image-container-class">
<span id="xf-mat-class"></span><h1>xf::cv::Mat Image Container Class<a class="headerlink" href="#xf-cv-mat-image-container-class" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> is a template class that serves as a container for storing
image data and its attributes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> image container class is similar to the <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code> class of the OpenCV library.</p>
</div>
<div class="section" id="class-definition">
<span id="xfmat-calls-def"></span><h2>Class Definition<a class="headerlink" href="#class-definition" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span> <span class="kt">int</span> <span class="n">XFCVDEPTH</span> <span class="o">=</span> <span class="mi">2</span><span class="o">&gt;</span>
<span class="n">class</span> <span class="n">Mat</span> <span class="p">{</span>
   <span class="nl">public</span><span class="p">:</span>
        <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">allocatedFlag</span><span class="p">;</span> <span class="c1">// flag to mark memory allocation in this class</span>
        <span class="kt">int</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">size</span><span class="p">;</span>        <span class="c1">// actual image size</span>

        <span class="k">typedef</span> <span class="nf">XF_TNAME</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">DATATYPE</span><span class="p">;</span>

<span class="cp">#if defined(__SYNTHESIS__) &amp;&amp; !defined(__SDA_MEM_MAP__)</span>
        <span class="n">hls</span><span class="o">::</span><span class="n">stream</span><span class="o">&lt;</span><span class="n">DATATYPE</span><span class="p">,</span> <span class="n">XFCVDEPTH</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">;</span>
<span class="cp">#else</span>
        <span class="n">DATATYPE</span><span class="o">*</span> <span class="n">data</span><span class="p">;</span>
<span class="cp">#endif</span>

        <span class="n">Mat</span><span class="p">();</span> <span class="c1">// default constructor</span>
        <span class="n">Mat</span><span class="p">(</span><span class="n">Size</span> <span class="n">_sz</span><span class="p">);</span>
        <span class="n">Mat</span><span class="p">(</span><span class="kt">int</span> <span class="n">_rows</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_cols</span><span class="p">);</span>
        <span class="n">Mat</span><span class="p">(</span><span class="kt">int</span> <span class="n">_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_rows</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_cols</span><span class="p">);</span>
        <span class="n">Mat</span><span class="p">(</span><span class="kt">int</span> <span class="n">_rows</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_cols</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">_data</span><span class="p">);</span>
        <span class="n">Mat</span><span class="p">(</span><span class="k">const</span> <span class="n">Mat</span><span class="o">&amp;</span><span class="p">);</span> <span class="c1">// copy constructor</span>

        <span class="o">~</span><span class="n">Mat</span><span class="p">();</span>

        <span class="n">Mat</span><span class="o">&amp;</span> <span class="n">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Mat</span><span class="o">&amp;</span><span class="p">);</span> <span class="c1">// Assignment operator</span>
        <span class="c1">//  XF_TNAME(T, XF_NPPC1) operator() (unsigned int r, unsigned int c);</span>
        <span class="c1">//  XF_CTUNAME(T, NPC) operator() (unsigned int r, unsigned int c, unsigned int ch);</span>
        <span class="n">XF_TNAME</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">read</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
        <span class="kt">float</span> <span class="nf">read_float</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
        <span class="kt">void</span> <span class="nf">write</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">XF_TNAME</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">val</span><span class="p">);</span>
        <span class="kt">void</span> <span class="nf">write_float</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="kt">float</span> <span class="n">val</span><span class="p">);</span>

        <span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">_rows</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_cols</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">allocate</span> <span class="o">=</span> <span class="nb">true</span><span class="p">);</span>
        <span class="kt">void</span> <span class="nf">copyTo</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">fromData</span><span class="p">);</span>
        <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">copyFrom</span><span class="p">();</span>

        <span class="k">const</span> <span class="kt">int</span> <span class="nf">type</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="nf">depth</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="nf">channels</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

        <span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">DST_T</span><span class="o">&gt;</span>
        <span class="kt">void</span> <span class="n">convertTo</span><span class="p">(</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="p">,</span> <span class="n">XFCVDEPTH</span><span class="o">&gt;&amp;</span> <span class="n">dst</span><span class="p">,</span> <span class="kt">int</span> <span class="n">otype</span><span class="p">,</span> <span class="kt">double</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">double</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table lists the <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> class parameters and their
descriptions:</p>
<table class="docutils align-default" id="id100">
<caption><span class="caption-text">Table xf::cv::Mat Class Parameter Descriptions</span><a class="headerlink" href="#id100" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rows</p></td>
<td><p>The number of rows in the image or height of the
image.</p></td>
</tr>
<tr class="row-odd"><td><p>cols</p></td>
<td><p>The number of columns in the image or width of the
image.</p></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>The number of words stored in the data member. The
value is calculated using
<code class="docutils literal notranslate"><span class="pre">rows*cols/(number</span> <span class="pre">of</span> <span class="pre">pixels</span> <span class="pre">packed</span> <span class="pre">per</span>&#160; <span class="pre">word)</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>allocatedFlag</p></td>
<td><p>Flag for memory allocation status</p></td>
</tr>
<tr class="row-even"><td><p>*data</p></td>
<td><p>class parameters and the pointer to the words that
store the pixels of the image.</p></td>
</tr>
</tbody>
</table>
<p>The following table lists the member functions and their descriptions:</p>
<table class="docutils align-default" id="id101">
<caption><span class="caption-text">Table xf::cv::Mat Member Function Descriptions</span><a class="headerlink" href="#id101" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Member
Functions</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mat()</p></td>
<td><p>This default constructor initializes the Mat object
sizes, using the template parameters ROWS and COLS.</p></td>
</tr>
<tr class="row-odd"><td><p>Mat(int
_rows, int
_cols)</p></td>
<td><p>This constructor initializes the Mat object using
arguments _rows and _cols.</p></td>
</tr>
<tr class="row-even"><td><p>Mat(const
xf::cv::Mat
&amp;_src)</p></td>
<td><p>This constructor helps clone a Mat object to
another. New memory will be allocated for the newly
created constructor.</p></td>
</tr>
<tr class="row-odd"><td><p>Mat(int
_rows, int
_cols, void
*_data)</p></td>
<td><p>This constructor initializes the Mat object using
arguments _rows, _cols, and _data. The *data
member of the Mat object points to the memory
allocated for _data argument, when this constructor
is used. No new memory is allocated for the *data
member.</p></td>
</tr>
<tr class="row-even"><td><p>convertTo(Mat
&lt;DST_T,ROWS,
COLS, NPC&gt;
&amp;dst, int
otype, double
alpha=1,
double
beta=0)</p></td>
<td><blockquote>
<div><p>Refer to</p>
</div></blockquote>
<p><a class="reference external" href="api-reference.html#xf-convertto">xf::cv::convertTo</a></p>
</td>
</tr>
<tr class="row-odd"><td><p>copyTo(*
fromData)</p></td>
<td><p>Copies the data from Data pointer into physically
contiguous memory allocated inside the constructor.</p></td>
</tr>
<tr class="row-even"><td><p>copyFrom()</p></td>
<td><p>Returns the pointer to the first location of the
*data member.</p></td>
</tr>
<tr class="row-odd"><td><p>read(int
index)</p></td>
<td><p>Readout a value from a given location and return it
as a packed (for multi-pixel/clock) value.</p></td>
</tr>
<tr class="row-even"><td><p>read_float(in
t
index)</p></td>
<td><p>Readout a value from a given location and return it
as a float value</p></td>
</tr>
<tr class="row-odd"><td><p>write(int
index,
XF_TNAME(T,NP
C)
val)</p></td>
<td><p>Writes a packed (for multi-pixel/clock) value into
the given location.</p></td>
</tr>
<tr class="row-even"><td><p>write_float(i
nt
index, float
val)</p></td>
<td><p>Writes a float value into the given location.</p></td>
</tr>
<tr class="row-odd"><td><p>type()</p></td>
<td><p>Returns the type of the image.</p></td>
</tr>
<tr class="row-even"><td><p>depth()</p></td>
<td><p>Returns the depth of the image</p></td>
</tr>
<tr class="row-odd"><td><p>channels()</p></td>
<td><p>Returns number of channels of the image</p></td>
</tr>
<tr class="row-even"><td><p>~Mat()</p></td>
<td><p>This is a default destructor of the Mat object.</p></td>
</tr>
</tbody>
</table>
<p>Template parameters of the <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> class are used to set the depth
of the pixel, number of channels in the image, number of pixels packed
per word, maximum number of rows and columns of the image. The following
table lists the template parameters and their descriptions:</p>
<table class="docutils align-default" id="id102">
<caption><span class="caption-text">Table xf::cv::Mat Template Parameter Descriptions</span><a class="headerlink" href="#id102" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Type of the pixel data. For example, XF_8UC1 stands
for 8-bit unsigned and one channel pixel. More types
can be found in include/common/xf_params.h.</p></td>
</tr>
<tr class="row-odd"><td><p>HEIGHT</p></td>
<td><p>Maximum height of an image.</p></td>
</tr>
<tr class="row-even"><td><p>WIDTH</p></td>
<td><p>Maximum width of an image.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>The number of pixels to be packed per word. For
instance, XF_NPPC1 for 1 pixel per word; and
XF_NPPC8 for 8 pixels per word.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pixel-level-parallelism">
<h2>Pixel-Level Parallelism<a class="headerlink" href="#pixel-level-parallelism" title="Permalink to this headline">¶</a></h2>
<p>The amount of parallelism to be implemented in a function from Vitis Vision
is kept as a configurable parameter. In most functions, there are two
options for processing data.</p>
<ul class="simple">
<li><p>Single-pixel processing</p></li>
<li><p>Processing eight pixels in parallel</p></li>
</ul>
<p>The following table describes the options available for specifying the
level of parallelism required in a particular function:</p>
<table class="docutils align-default" id="id103">
<caption><span class="caption-text">Table Options Available for Specifying the Level of Parallelism</span><a class="headerlink" href="#id103" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>XF_NPPC1</p></td>
<td><p>Process 1 pixel per clock cycle</p></td>
</tr>
<tr class="row-odd"><td><p>XF_NPPC2</p></td>
<td><p>Process 2 pixels per clock cycle</p></td>
</tr>
<tr class="row-even"><td><p>XF_NPPC4</p></td>
<td><p>Process 4 pixels per clock cycle</p></td>
</tr>
<tr class="row-odd"><td><p>XF_NPPC8</p></td>
<td><p>Process 8 pixels per clock cycle</p></td>
</tr>
</tbody>
</table>
<div class="section" id="macros-to-work-with-parallelism">
<h3>Macros to Work With Parallelism<a class="headerlink" href="#macros-to-work-with-parallelism" title="Permalink to this headline">¶</a></h3>
<p>There are two macros that are defined to work with parallelism.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">XF_NPIXPERCYCLE(flags)</span></code> macro resolves to the number of pixels
processed per cycle.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_NPIXPERCYCLE(XF_NPPC1)</span></code> resolves to 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_NPIXPERCYCLE(XF_NPPC2)</span></code> resolves to 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_NPIXPERCYCLE(XF_NPPC4)</span></code> resolves to 4</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_NPIXPERCYCLE(XF_NPPC8)</span></code> resolves to 8</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">XF_BITSHIFT(flags)</span></code> macro resolves to the number of times to
shift the image size to right to arrive at the final data transfer
size for parallel processing.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_BITSHIFT(XF_NPPC1)</span></code> resolves to 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_BITSHIFT(XF_NPPC2)</span></code> resolves to 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_BITSHIFT(XF_NPPC4)</span></code> resolves to 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_BITSHIFT(XF_NPPC8)</span></code> resolves to 3</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
<p>Data types will differ, depending on the combination of the depth
of pixels and the number of channels in the image. The generic
nomenclature of the parameter is listed below.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">XF_</span><span class="o">&lt;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">bits</span> <span class="n">per</span> <span class="n">pixel</span><span class="o">&gt;&lt;</span><span class="kt">signed</span> <span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="n">or</span> <span class="kt">unsigned</span> <span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="n">or</span> <span class="kt">float</span> <span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">&gt;</span><span class="n">C</span><span class="o">&lt;</span><span class="n">number</span> <span class="n">of</span> <span class="n">channels</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For example, for an 8-bit pixel - unsigned - 1 channel the data type is
<code class="docutils literal notranslate"><span class="pre">XF_8UC1</span></code>.</p>
<p>The following table lists the available data types for the <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code>
class:</p>
<table class="docutils align-default" id="id104">
<caption><span class="caption-text">Table xf::cv::Mat Class - Available Data Types</span><a class="headerlink" href="#id104" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 30%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Number of bits
per Pixel</p></th>
<th class="head"><p>Unsigned/ Signed/
Float Type</p></th>
<th class="head"><p>Number of
Channels</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>XF_2UC1</p></td>
<td><p>2</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>XF_8UC1</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>XF_8UC2</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>XF_8UC3</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>XF_8UC4</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>XF_10UC1</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>XF_10UC2</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>XF_10UC3</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>XF_10UC4</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>XF_12UC1</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>XF_12UC2</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>XF_12UC3</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>XF_12UC4</p></td>
<td><p>8</p></td>
<td><p>Unsigned</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>XF_16UC1</p></td>
<td><p>16</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>XF_16SC1</p></td>
<td><p>16</p></td>
<td><p>Signed</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>XF_32UC1</p></td>
<td><p>32</p></td>
<td><p>Unsigned</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>XF_32FC1</p></td>
<td><p>32</p></td>
<td><p>Float</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>XF_32FC3</p></td>
<td><p>32</p></td>
<td><p>Float</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>XF_32SC1</p></td>
<td><p>32</p></td>
<td><p>Signed</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<div class="section" id="manipulating-data-type">
<h3>Manipulating Data Type<a class="headerlink" href="#manipulating-data-type" title="Permalink to this headline">¶</a></h3>
<p>Based on the number of pixels to process per clock cycle and the type
parameter, there are different possible data types. The Vitis Vision library
uses these datatypes for internal processing and inside the <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code>
class. The following are a few supported types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">XF_TNAME(TYPE,NPPC)</span></code> resolves to the data type of the data member
of the <code class="docutils literal notranslate"><span class="pre">xf::cv::Mat</span></code> object. For instance,
<code class="docutils literal notranslate"><span class="pre">XF_TNAME(XF_8UC1,XF_NPPC8)</span></code> resolves to <code class="docutils literal notranslate"><span class="pre">ap_uint&lt;64&gt;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Word</span> <span class="pre">width</span> <span class="pre">=</span> <span class="pre">pixel</span> <span class="pre">depth</span> <span class="pre">*</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">channels</span> <span class="pre">*</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">pixels</span> <span class="pre">to</span> <span class="pre">process</span> <span class="pre">per</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">cycle</span> <span class="pre">(NPPC)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_DTUNAME(TYPE,NPPC)</span></code> resolves to the data type of the pixel. For
instance, <code class="docutils literal notranslate"><span class="pre">XF_DTUNAME(XF_32FC1,XF_NPPC1)</span></code> resolves to <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XF_PTSNAME(TYPE,NPPC)</span></code> resolves to the ‘C’ data type of the pixel.
For instance, <code class="docutils literal notranslate"><span class="pre">XF_PTSNAME</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(XF_16UC1,XF_NPPC2)</span></code> resolves
to <code class="docutils literal notranslate"><span class="pre">unsigned</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">short</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">ap_uint&lt;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ap_int&lt;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ap_fixed&lt;&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">ap_ufixed&lt;&gt;</span></code> types belong to the high-level synthesis (HLS) library. For more information, see the Vivado Design Suite User Guide: High-Level Synthesis (<a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/rdoc?v=2019.1;d=ug902-vivado-high-level-synthesis.pdf">UG902</a>).</p>
</div>
</div>
</div>
<div class="section" id="xf-cv-imread">
<span id="xf-imread"></span><h2>xf::cv::imread<a class="headerlink" href="#xf-cv-imread" title="Permalink to this headline">¶</a></h2>
<p>The function <cite>xf::cv::imread</cite> loads an image from the specified file path,
copies into xf::cv::Mat and returns it. If the image cannot be read (because
of missing file, improper permissions, unsupported or invalid format),
the function exits with a non-zero return code and an error statement.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In an HLS standalone mode like Cosim, use <code class="docutils literal notranslate"><span class="pre">cv::imread</span></code> followed by <code class="docutils literal notranslate"><span class="pre">copyTo</span></code> function, instead of <code class="docutils literal notranslate"><span class="pre">xf::cv::imread</span></code>.</p>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">PTYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">PTYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">imread</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">filename</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default" id="id105">
<caption><span class="caption-text">Table xf::cv::imread Parameter Description</span><a class="headerlink" href="#id105" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PTYPE</p></td>
<td><p>Input pixel type. Value should be in accordance with
the ‘type’ argument’s value.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of the image to be read</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of the image to be read</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>filename</p></td>
<td><p>Name of the file to be loaded</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>Flag that depicts the type of image. The values are:</p>
<ul class="simple">
<li><p>‘0’ for gray scale</p></li>
<li><p>‘1’ for color image</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="xf-cv-imwrite">
<span id="ariaid-title4"></span><h2>xf::cv::imwrite<a class="headerlink" href="#xf-cv-imwrite" title="Permalink to this headline">¶</a></h2>
<p>The function xf::cv::imwrite saves the image to the specified file from the
given xf::cv::Mat. The image format is chosen based on the file name
extension. This function internally uses cv::imwrite for the processing.
Therefore, all the limitations of cv::imwrite are also applicable to
xf::cv::imwrite.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">PTYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">imwrite</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">img_name</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">PTYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default" id="id106">
<caption><span class="caption-text">Table xf::cv::imwrite Parameter Description</span><a class="headerlink" href="#id106" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PTYPE</p></td>
<td><p>Input pixel type. Supported types are: XF_8UC1,
XF_16UC1, XF_8UC4, and XF_16UC4</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of the image to be read</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of the image to be read</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>img_name</p></td>
<td><p>Name of the file with the extension</p></td>
</tr>
<tr class="row-odd"><td><p>img</p></td>
<td><p>xf::cv::Mat array to be saved</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="xf-cv-absdiff">
<span id="xf-absdiff"></span><h2>xf::cv::absDiff<a class="headerlink" href="#xf-cv-absdiff" title="Permalink to this headline">¶</a></h2>
<p>The function xf::cv::absDiff computes the absolute difference between each
individual pixels of an xf::cv::Mat and a cv::Mat, and returns the
difference values in a cv::Mat.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">PTYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">absDiff</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span> <span class="o">&amp;</span><span class="n">cv_img</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">PTYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">xf_img</span><span class="p">,</span> <span class="n">cv</span><span class="o">::</span><span class="n">Mat</span> <span class="o">&amp;</span><span class="n">diff_img</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default" id="id107">
<caption><span class="caption-text">Table xf::cv::absDiff Parameter Description</span><a class="headerlink" href="#id107" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PTYPE</p></td>
<td><p>Input pixel type</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of the image to be read</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of the image to be read</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1, XF_NPPC4, and XF_NPPC8 for
1-pixel, 4-pixel, and 8-pixel parallel operations
respectively.</p></td>
</tr>
<tr class="row-even"><td><p>cv_img</p></td>
<td><p>cv::Mat array to be compared</p></td>
</tr>
<tr class="row-odd"><td><p>xf_img</p></td>
<td><p>xf::cv::Mat array to be compared</p></td>
</tr>
<tr class="row-even"><td><p>diff_img</p></td>
<td><p>Output difference image(cv::Mat)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="xf-cv-convertto">
<span id="xf-convertto"></span><h2>xf::cv::convertTo<a class="headerlink" href="#xf-cv-convertto" title="Permalink to this headline">¶</a></h2>
<p>The xf::cv::convertTo function performs bit depth conversion on each
individual pixel of the given input image. This method converts the
source pixel values to the target data type with appropriate casting.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>dst(x,y)= cast&lt;target-data-type&gt;(α(src(x,y)+β))
</pre></div>
</div>
<p>Note: The output and input Mat cannot be the same. That is, the
converted image cannot be stored in the Mat of the input image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">DST_T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">convertTo</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">dst</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ctype</span><span class="p">,</span> <span class="kt">double</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">double</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and function parameters.</p>
<table class="docutils align-default" id="id108">
<caption><span class="caption-text">Table xf::cv::convertTo Parameter Description</span><a class="headerlink" href="#id108" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Possible values are XF_8UC1,
XF_16UC1, XF_16SC1, and XF_32SC1.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of image to be read</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of image to be read</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1, XF_NPPC4, and XF_NPPC8 for
1-pixel, 4-pixel, and 8-pixel parallel operations
respectively. XF_32SC1 and XF_NPPC8 combination is
not supported.</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Converted xf Mat</p></td>
</tr>
<tr class="row-odd"><td><p>ctype</p></td>
<td><p>Conversion type : Possible values are listed here.</p>
<blockquote>
<div><p>//Down-convert:</p>
</div></blockquote>
<ul class="simple">
<li><p>XF_CONVERT_16U_TO_8U</p></li>
<li><p>XF_CONVERT_16S_TO_8U</p></li>
<li><p>XF_CONVERT_32S_TO_8U</p></li>
<li><p>XF_CONVERT_32S_TO_16U</p></li>
<li><p>XF_CONVERT_32S_TO_16S</p></li>
</ul>
<p>//Up-convert:</p>
<ul class="simple">
<li><p>XF_CONVERT_8U_TO_16U</p></li>
<li><p>XF_CONVERT_8U_TO_16S</p></li>
<li><p>XF_CONVERT_8U_TO_32S</p></li>
<li><p>XF_CONVERT_16U_TO_32S</p></li>
<li><p>XF_CONVERT_16S_TO_32S</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>Optional scale factor</p></td>
</tr>
<tr class="row-odd"><td><p>beta</p></td>
<td><p>Optional delta added to the scaled values</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="vitis-vision-library-functions">
<span id="xfopencv-lib-fns"></span><h1>Vitis Vision Library Functions<a class="headerlink" href="#vitis-vision-library-functions" title="Permalink to this headline">¶</a></h1>
<p>The Vitis Vision library is a set of select OpenCV functions optimized for
Zynq-7000, Zynq UltraScale+ MPSoC, Alveo U200 and U50 devices. The maximum resolution supported for all the functions is 4K, except
Houghlines and HOG (RB mode).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="#resolution-conversion">Resolution Conversion (Resize)</a> in 8 pixel per cycle mode, <a class="reference external" href="#dense-pyramidal-lk-optical">Dense Pyramidal LK Optical Flow</a>, and <a class="reference external" href="#dense-non-pyramidal-lk-optical">Dense Non-Pyramidal LK Optical Flow</a> functions are not supported on the Zynq-7000 SoC ZC702 devices, due to the higher resource utilization.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Number of pixel per clock depends on the maximum bus width a device can support. For example: Zynq-7000 SoC has 64-bit interface and so for a pixel type 16UC1, maximum of four pixel per clock (XF_NPPC4) is possible.</p>
</div>
<div class="section" id="absolute-difference">
<span id="absdiff"></span><h2>Absolute Difference<a class="headerlink" href="#absolute-difference" title="Permalink to this headline">¶</a></h2>
<p class="rubric">API Syntax</p>
<p>The <code class="docutils literal notranslate"><span class="pre">absdiff</span></code> function finds the pixel wise absolute difference
between two input images and returns an output image. The input and the
output images must be the XF_8UC1 type.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image0" class="image" src="_images/rwz1554997340040.png" /></div>
</div>
<p>Where,</p>
<ul class="simple">
<li><p>I<sub>out</sub>(x, y) is the intensity of output image at (x,y)
position.</p></li>
<li><p>I<sub>in1</sub>(x, y) is the intensity of first input image at (x,y)
position.</p></li>
<li><p>I<sub>in2</sub>(x, y) is the intensity of second input image at (x,y)
position.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">absdiff</span><span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id109">
<caption><span class="caption-text">Table absdiff Parameter Description</span><a class="headerlink" href="#id109" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only
8-bit, unsigned, 1 and 3 channels
are supported (XF_8UC1 and
XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and
output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output
image. Must be multiple of 8, for
8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed
per cycle; possible options are
XF_NPPC1 and XF_NPPC8 for 1 pixel
and 8 pixel operations
respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default" id="id110">
<caption><span class="caption-text">Table absdiff Function Resource Utilization Summary</span><a class="headerlink" href="#id110" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>67</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>67</p></td>
<td><p>234</p></td>
<td><p>39</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default" id="id111">
<caption><span class="caption-text">Table absdiff Function Performance Estimate Summary</span><a class="headerlink" href="#id111" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.69</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>There is no deviation from OpenCV, except that the <code class="docutils literal notranslate"><span class="pre">absdiff</span></code> function
supports 8-bit pixels.</p>
</div>
<div class="section" id="accumulate">
<span id="id1"></span><h2>Accumulate<a class="headerlink" href="#accumulate" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">accumulate</span></code> function adds an image (src1) to the accumulator
image (src2), and generates the accumulated result image (dst).</p>
<p><img alt="image1" class="image" src="_images/btr1554997275001.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">accumulate</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id112">
<caption><span class="caption-text">Table accumulate Parameter Description</span><a class="headerlink" href="#id112" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, unsigned, 1 and 3
channels are supported (XF_16UC1 and XF_16UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Recommend
using a multiple of 8, for an 8-pixel operation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>55</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>389</p></td>
<td><p>285</p></td>
<td><p>61</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process 4K 3 Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>207</p></td>
<td><p>72</p></td>
<td><p>32</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<div class="line-block">
<div class="line">In OpenCV the accumulated image is stored in the second input image.
The src2 image acts as both input and output, as shown below:</div>
<div class="line"><img alt="image2" class="image" src="_images/gve1554996977881.png" /></div>
</div>
<p>Whereas, in the Vitis Vision implementation, the accumulated image is stored
separately, as shown below:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image3" class="image" src="_images/hoi1554997009176.png" /></div>
</div>
</div>
<div class="section" id="accumulate-squared">
<span id="acumulate-squared"></span><h2>Accumulate Squared<a class="headerlink" href="#accumulate-squared" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">accumulateSquare</span></code> function adds the square of an image (src1) to
the accumulator image (src2) and generates the accumulated result (dst).</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image4" class="image" src="_images/hoy1554996989429.png" /></div>
</div>
<p>The accumulated result is a separate argument in the function, instead
of having src2 as the accumulated result. In this implementation, having
a bi-directional accumulator is not possible as the function makes use
of streams.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">accumulateSquare</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id113">
<caption><span class="caption-text">Table accumulateSquare Parameter Description</span><a class="headerlink" href="#id113" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, unsigned, 1 and 3
channels are supported (XF_16UC1 and XF_16UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>71</p></td>
<td><p>52</p></td>
<td><p>14</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>401</p></td>
<td><p>247</p></td>
<td><p>48</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process 4K 3 Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>227</p></td>
<td><p>86</p></td>
<td><p>37</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.6</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>In OpenCV the accumulated squared image is stored in the second input
image. The src2 image acts as input as well as output.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image5" class="image" src="_images/smn1554997359151.png" /></div>
<div class="line">Whereas, in the Vitis Vision implementation, the accumulated squared image
is stored separately. <img alt="image6" class="image" src="_images/fre1554997017719.png" /></div>
</div>
</div>
<div class="section" id="accumulate-weighted">
<span id="id2"></span><h2>Accumulate Weighted<a class="headerlink" href="#accumulate-weighted" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">accumulateWeighted</span></code> function computes the weighted sum of the
input image (src1) and the accumulator image (src2) and generates the
result in dst.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image7" class="image" src="_images/crc1554997159141.png" /></div>
</div>
<p>The accumulated result is a separate argument in the function, instead
of having src2 as the accumulated result. In this implementation, having
a bi-directional accumulator is not possible, as the function uses
streams.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">accumulateWeighted</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span><span class="p">,</span>
<span class="kt">float</span> <span class="n">alpha</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id114">
<caption><span class="caption-text">Table accumulateWeighted Parameter Description</span><a class="headerlink" href="#id114" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, unsigned, 1 and 3
channels are supported (XF_16UC1 and XF_16UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Recommend
multiples of 8, for an 8-pixel operation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>Weight applied to input image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default" id="id115">
<caption><span class="caption-text">Table accumulateWeighted Function Resource Utilization Summary</span><a class="headerlink" href="#id115" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>295</p></td>
<td><p>255</p></td>
<td><p>52</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>19</p></td>
<td><p>556</p></td>
<td><p>476</p></td>
<td><p>88</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3 Channel image.</p>
<table class="docutils align-default" id="id116">
<caption><span class="caption-text">Table accumulateWeighted Function Resource Utilization Summary</span><a class="headerlink" href="#id116" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>457</p></td>
<td><p>387</p></td>
<td><p>95</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default" id="id117">
<caption><span class="caption-text">Table accumulateWeighted Function Performance Estimate Summary</span><a class="headerlink" href="#id117" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>The resultant image in OpenCV is stored in the second input image. The
src2 image acts as input as well as output, as shown below:</p>
<p><img alt="image8" class="image" src="_images/nnu1554997133828.png" /></p>
<p>Whereas, in Vitis Vision implementation, the accumulated weighted image is
stored separately.</p>
<p><img alt="image9" class="image" src="_images/tig1554997364481.png" /></p>
</div>
<div class="section" id="adds">
<span id="id3"></span><h2>AddS<a class="headerlink" href="#adds" title="Permalink to this headline">¶</a></h2>
<p>The AddS function performs the addition operation between pixels of
input image src and given scalar value scl and stores the result in dst.</p>
<p>dst(x,y)= src(x,y) + scl</p>
<p>Where (x,y) is the spatial coordinate of the pixel.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">addS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id118">
<caption><span class="caption-text">Table 26. AddS Parameter Description</span><a class="headerlink" href="#id118" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Input scalar value, the size should be number of
channels.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the AddS
function in both the resource optimized (8 pixel) mode and normal mode,
as generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>100</p></td>
<td><p>101</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>52</p></td>
<td><p>185</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>20</p></td>
<td><p>45</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="addweighted">
<span id="id4"></span><h2>Addweighted<a class="headerlink" href="#addweighted" title="Permalink to this headline">¶</a></h2>
<p>The addweighted function calculates a weighted sum of two input images
src1, src2 and generates the result in dst.</p>
<p>dst(x,y)= src1(x,y)*alpha+src2(x,y)*beta+ gamma</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span>   <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">addWeighted</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">float</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src2</span><span class="p">,</span> <span class="kt">float</span> <span class="n">beta</span><span class="p">,</span> <span class="kt">float</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id119">
<caption><span class="caption-text">Table 29. Addweighted Parameter Description</span><a class="headerlink" href="#id119" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned,1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output Pixel Type. 8-bit, unsigned,1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src1</p></td>
<td><p>First Input image</p></td>
</tr>
<tr class="row-even"><td><p>Alpha</p></td>
<td><p>Weight applied on first image</p></td>
</tr>
<tr class="row-odd"><td><p>_src2</p></td>
<td><p>Second Input image</p></td>
</tr>
<tr class="row-even"><td><p>Beta</p></td>
<td><p>Weight applied on second image</p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p>Scalar added to each sum</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
Addweighted function in Resource optimized (8 pixel) mode and normal
mode, as generated in Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>903</p></td>
<td><p>680</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>851</p></td>
<td><p>1077</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>187</p></td>
<td><p>229</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="autoexposurecorrection">
<span id="id5"></span><h2>Autoexposurecorrection<a class="headerlink" href="#autoexposurecorrection" title="Permalink to this headline">¶</a></h2>
<p>Auto exposure correction improves contrast and brightness of the image and also corrects the exposure of the input frame. The algorithm uses luminence histogram equalization to improve overall exposure and contrast of the image.
Luminence (V) is extracted after converting input image to HSV color space. Once the algorthm is applied the image is converted back to RGB color space.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SIN_CHANNEL_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">autoexposurecorrection</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">src</span><span class="p">,</span>
                            <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">dst</span><span class="p">,</span>
                            <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hist_array1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">256</span><span class="p">],</span>
                            <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hist_array2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">256</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes template parameters and arguments of the function.</p>
<table class="docutils align-default" id="id120">
<caption><span class="caption-text">Table AEC Parameter Description</span><a class="headerlink" href="#id120" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit unsigned 3 channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit unsigned 3 channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>SIN_CHANNEL_TYPE</p></td>
<td><p>Single channel type. should be XF_8UC1</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options is XF_NPPC1, XF_NPPC2 AND so on</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>hist_array1</p></td>
<td><p>Histogram array</p></td>
</tr>
<tr class="row-odd"><td><p>hist_array2</p></td>
<td><p>Histogram array</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of kernel in different configurations, generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id121">
<caption><span class="caption-text">Table AEC Resource Utilization Summary</span><a class="headerlink" href="#id121" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>4</p></td>
<td><p>18</p></td>
<td><p>6713</p></td>
<td><p>2996</p></td>
<td><p>1103</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>4</p></td>
<td><p>27</p></td>
<td><p>7618</p></td>
<td><p>3705</p></td>
<td><p>1257</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, as generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency Estimate
<strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>3.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id6">
<h2>Autowhitebalance<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p><strong>Grayworld whitebalancing algorithm:</strong></p>
<p>This algorithm scales the values of pixels based on a gray-world assumption which states that the average of all channels should result in a gray image.
It adds a modification which thresholds pixels based on their saturation value and only uses pixels below the provided threshold in finding average pixel values.
Saturation is calculated using the following for a 3-channel RGB image per pixel I and is in the range [0, 1]:</p>
<p><img alt="image161" class="image" src="_images/awbeq1.png" /></p>
<p>A threshold of 1 means that all pixels are used to white-balance, while a threshold of 0 means no pixels are used. Lower thresholds are useful in white-balancing saturated images.</p>
<p><strong>Simple whitebalancing algorithm:</strong></p>
<p>A simple white balance algorithm that works by independently stretching each of the input image channels to the specified range(maximum and minimum). Computes channel wise intensity histogram and ignores p% maximum and minimum values and finally normalize each channel with min and max. For increased robustness it ignores the top and bottom <span class="math notranslate nohighlight">\(p\%\ \ (4\%\ is\ fixed)\)</span> of pixel values.</p>
<p class="rubric">API Syntax for Simple white balance</p>
<p class="rubric">API Syntax for Grayworld white balance</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WB_TYPE</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">AWBChannelGain</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">src</span><span class="p">,</span>
            <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">dst</span><span class="p">,</span>
            <span class="kt">float</span> <span class="n">thresh</span><span class="p">,</span>
            <span class="kt">int</span> <span class="n">i_gain</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WB_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">S_DEPTH</span> <span class="o">=</span> <span class="mi">2</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">AWBGainUpdate</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">src1</span><span class="p">,</span>
           <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="p">,</span> <span class="n">S_DEPTH</span><span class="o">&gt;&amp;</span> <span class="n">src2</span><span class="p">,</span>
           <span class="kt">float</span> <span class="n">thresh</span><span class="p">,</span>
           <span class="kt">int</span> <span class="n">i_gain</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations, generated using Vitis HLS 2020.1 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process a 4K image.</p>
<table class="docutils align-default" id="id122">
<caption><span class="caption-text">Table Autowhitebalance Resource Utilization Summary</span><a class="headerlink" href="#id122" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>14</p></td>
<td><p>10</p></td>
<td><p>4798</p></td>
<td><p>4953</p></td>
<td><p>1757</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>14</p></td>
<td><p>10</p></td>
<td><p>8335</p></td>
<td><p>8535</p></td>
<td><p>2901</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, as generated using Vitis HLS 2020.1 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process a 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p><strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>55.2 for still image(27.9 for video stream)</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>28 for still image(14.2 for video stream)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="badpixelcorrection">
<span id="id7"></span><h2>Badpixelcorrection<a class="headerlink" href="#badpixelcorrection" title="Permalink to this headline">¶</a></h2>
<p>An image sensor may have a certain number of defective/bad pixels that may be the result of manufacturing faults or variations in pixel voltage levels based on temperature or exposure. The Badpixelcorrection module removes the defective pixels in the image using below operation.</p>
<p>If the middle pixel value is lesser than minimum neighborhood value, will consider minimum neighborhood value as mid pixel, otherwise mid pixel value is greater than maximum neighborhood value, will consider maximum neighborhood as mid pixel.</p>
<p class="rubric">API Syntax</p>
<p>template&lt;int TYPE, int ROWS, int COLS, int NPPC=1, int BORDER_T=XF_BORDER_CONSTANT, int USE_URAM=0&gt;void badpixelcorrection(xf::cv::Mat&lt;TYPE, ROWS, COLS, NPPC&gt; &amp;_src,xf::cv::Mat&lt;TYPE, ROWS, COLS, NPPC&gt; &amp;_dst)</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id123">
<caption><span class="caption-text">Table badpixelcorrection Parameter Description</span><a class="headerlink" href="#id123" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and Output Pixel Type.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image (Must be multiple of NPPC)</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (Must be multiple of NPPC)</p></td>
</tr>
<tr class="row-odd"><td><p>NPPC</p></td>
<td><p>Number of Pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-even"><td><p>BORDER_T</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input Bayer image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output Bayer image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process a 4K image.</p>
<table class="docutils align-default" id="id124">
<caption><span class="caption-text">Table badpixelcorrection Resource Utilization Summary</span><a class="headerlink" href="#id124" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 25%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Utilization Estimate</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>SLICE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>10</p></td>
<td><p>0</p></td>
<td><p>979</p></td>
<td><p>744</p></td>
<td><p>355</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>10</p></td>
<td><p>0</p></td>
<td><p>1148</p></td>
<td><p>1177</p></td>
<td><p>458</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1, to process 4K image.</p>
<table class="docutils align-default" id="id125">
<caption><span class="caption-text">Table badpixelcorrection Resource Utilization Summary</span><a class="headerlink" href="#id125" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>27.8</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>14.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="brute-force-bf-feature-matcher">
<span id="bruteforce-feature-matcher"></span><h2>Brute-force (Bf) Feature Matcher<a class="headerlink" href="#brute-force-bf-feature-matcher" title="Permalink to this headline">¶</a></h2>
<p>Bf matcher takes the descriptor of one feature in first set and is matched
with all other features in second set and the closest one is returned.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">PU</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAX_KEYPOINTS</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bfMatcher</span><span class="p">(</span><span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;</span> <span class="n">desc_list_q</span><span class="p">[</span><span class="n">MAX_KEYPOINTS</span><span class="p">],</span>
               <span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;</span> <span class="n">desc_list_t</span><span class="p">[</span><span class="n">MAX_KEYPOINTS</span><span class="p">],</span>
               <span class="n">ap_int</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span> <span class="n">match_list</span><span class="p">[</span><span class="n">MAX_KEYPOINTS</span><span class="p">],</span>
               <span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">num_keypoints_q</span><span class="p">,</span>
               <span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">num_keypoints_t</span><span class="p">,</span>
               <span class="kt">float</span> <span class="n">ratio_thresh</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes template paramters and arguments of the function.</p>
<table class="docutils align-default" id="id126">
<caption><span class="caption-text">Table brute-force matcher Parameter Description</span><a class="headerlink" href="#id126" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PU</p></td>
<td><p>Parallel units / compute units. Number of parallel
matches computed. Default is ‘1’. Increasing this
parameter results in lesser compute time, but also
consumes more hardware resources.</p></td>
</tr>
<tr class="row-odd"><td><p>MAX_KEYPOINTS</p></td>
<td><p>Maximum keypoints in the query and training feature
sets.</p></td>
</tr>
<tr class="row-even"><td><p>desc_list_q</p></td>
<td><p>Feature descriptor query list of 256-bit type.</p></td>
</tr>
<tr class="row-odd"><td><p>desc_list_t</p></td>
<td><p>Feature descriptor training list of 256-bit type.</p></td>
</tr>
<tr class="row-even"><td><p>match_list</p></td>
<td><p>Index of corresponding matches for query list in
training set.</p></td>
</tr>
<tr class="row-odd"><td><p>num_keypoints_q</p></td>
<td><p>Total number keypoints in the query set. This must
not exceed MAX_KEYPOINTS.</p></td>
</tr>
<tr class="row-even"><td><p>num_keypoints_t</p></td>
<td><p>Total number keypoints in the training set. This
must not exceed MAX_KEYPOINTS.</p></td>
</tr>
<tr class="row-odd"><td><p>ratio_thresh</p></td>
<td><p>Ratio threshold for lowe’s test, for strong matches.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations, generated using Vitis 2020.2 tool, for MAX_KEYPOINTS of 10000.</p>
<table class="docutils align-default" id="id127">
<caption><span class="caption-text">Table brute-force matcher Resource Utilization Summary</span><a class="headerlink" href="#id127" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 14%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>PU = 1</p></td>
<td><p>300</p></td>
<td><p>162</p></td>
<td><p>0</p></td>
<td><p>5152</p></td>
<td><p>8453</p></td>
</tr>
<tr class="row-even"><td><p>PU = 2</p></td>
<td><p>300</p></td>
<td><p>176</p></td>
<td><p>0</p></td>
<td><p>9471</p></td>
<td><p>16320</p></td>
</tr>
<tr class="row-odd"><td><p>PU = 10</p></td>
<td><p>300</p></td>
<td><p>176</p></td>
<td><p>0</p></td>
<td><p>17708</p></td>
<td><p>48839</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, as generated using Vitis 2020.2 tool, for MAX_KEYPOINTS of 10000.</p>
<table class="docutils align-default" id="id128">
<caption><span class="caption-text">Table brute-force matcher Function Performance Estimate Summary</span><a class="headerlink" href="#id128" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency Estimate
<strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PU = 1</p></td>
<td><p>300</p></td>
<td><p>333.4</p></td>
</tr>
<tr class="row-odd"><td><p>PU = 2</p></td>
<td><p>300</p></td>
<td><p>168.6</p></td>
</tr>
<tr class="row-even"><td><p>PU = 10</p></td>
<td><p>300</p></td>
<td><p>34.285</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bilateral-filter">
<span id="id8"></span><h2>Bilateral Filter<a class="headerlink" href="#bilateral-filter" title="Permalink to this headline">¶</a></h2>
<p>In general, any smoothing filter smoothens the image which will affect
the edges of the image. To preserve the edges while smoothing, a
bilateral filter can be used. In an analogous way as the Gaussian
filter, the bilateral filter also considers the neighboring pixels with
weights assigned to each of them. These weights have two components, the
first of which is the same weighing used by the Gaussian filter. The
second component takes into account the difference in the intensity
between the neighboring pixels and the evaluated one.</p>
<div class="line-block">
<div class="line">The bilateral filter applied on an image is:</div>
<div class="line"><img alt="image10" class="image" src="_images/zii1554997199141.png" /></div>
</div>
<div class="line-block">
<div class="line">Where</div>
<div class="line"><img alt="image11" class="image" src="_images/hrk1554997268325.png" /></div>
<div class="line">and <img alt="image12" class="image" src="_images/onb1554997280367.png" /> is a gaussian filter with variance <img alt="image13" class="image" src="_images/quo1554997314377.png" />.</div>
</div>
<p>The gaussian filter is given by: <img alt="image14" class="image" src="_images/nwd1554997212544.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTER_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bilateralFilter</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span><span class="p">,</span>
<span class="kt">float</span> <span class="n">sigma_space</span><span class="p">,</span> <span class="kt">float</span> <span class="n">sigma_color</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id129">
<caption><span class="caption-text">Table bilateralFilter Parameter Description</span><a class="headerlink" href="#id129" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_SIZE</p></td>
<td><p>Filter size. Filter size of 3
(XF_FILTER_3X3), 5 (XF_FILTER_5X5) and 7
(XF_FILTER_7X7) are supported</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>Border type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and output pixel type. Only 8-bit,
unsigned, 1 channel, and 3 channels are
supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must
be multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
this function supports XF_NPPC1 and XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>sigma_space</p></td>
<td><p>Standard deviation of filter in spatial
domain</p></td>
</tr>
<tr class="row-odd"><td><p>sigma_color</p></td>
<td><p>Standard deviation of filter used in color
space</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to progress a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>6</p></td>
<td><p>22</p></td>
<td><p>4934</p></td>
<td><p>4293</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>12</p></td>
<td><p>30</p></td>
<td><p>5481</p></td>
<td><p>4943</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>37</p></td>
<td><p>48</p></td>
<td><p>7084</p></td>
<td><p>6195</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to progress a 4K 3 channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>12</p></td>
<td><p>32</p></td>
<td><p>8342</p></td>
<td><p>7442</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>27</p></td>
<td><p>57</p></td>
<td><p>10663</p></td>
<td><p>8857</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>49</p></td>
<td><p>107</p></td>
<td><p>12870</p></td>
<td><p>12181</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 28%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Operating Mode</p></th>
<th class="head" rowspan="3"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>300 MHz</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>1 pixel</p></td>
<td><p>3x3</p></td>
<td><p>7.18</p></td>
</tr>
<tr class="row-odd"><td><p>5x5</p></td>
<td><p>7.20</p></td>
</tr>
<tr class="row-even"><td><p>7x7</p></td>
<td><p>7.22</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>Unlike OpenCV, Vitis Vision only supports filter sizes of 3, 5 and 7.</p>
</div>
<div class="section" id="bit-depth-conversion">
<span id="id9"></span><h2>Bit Depth Conversion<a class="headerlink" href="#bit-depth-conversion" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">convertTo</span></code> function converts the input image bit depth to the
required bit depth in the output image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">convertTo</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_dst_mat</span><span class="p">,</span> <span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">_convert_type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_shift</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id130">
<caption><span class="caption-text">Table 36. convertTo Parameter Description</span><a class="headerlink" href="#id130" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel
(XF_8UC1),</p>
<p>16-bit, unsigned, 1 channel (XF_16UC1),</p>
<p>16-bit, signed, 1 channel (XF_16SC1),</p>
<p>32-bit, signed, 1 channel (XF_32SC1) are supported.</p>
</td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit, unsigned, 1 channel
(XF_8UC1),</p>
<p>16-bit, unsigned, 1 channel (XF_16UC1),</p>
<p>16-bit, signed, 1 channel (XF_16SC1),</p>
<p>32-bit, signed, 1 channel (XF_32SC1) are supported.</p>
</td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Height of input and output images</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Width of input and output images</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively. XF_NPPC8 is not
supported with the 32-bit input and output pixel
type.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>_convert_ty
pe</p></td>
<td><p>This parameter specifies the type of conversion
required. (See XF_convert_bit_depth_e enumerated type
in file xf_params.h for possible values.)</p></td>
</tr>
<tr class="row-even"><td><p>_shift</p></td>
<td><p>Optional scale factor</p></td>
</tr>
</tbody>
</table>
<p>Possible Conversions</p>
<p>The following table summarizes supported conversions. The rows are
possible input image bit depths and the columns are corresponding
possible output image bit depths (U=unsigned, S=signed).</p>
<table class="docutils align-default" id="id131">
<caption><span class="caption-text">Table 37. convertTo Function Supported Conversions</span><a class="headerlink" href="#id131" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>INPUT/OUTPUT</p></th>
<th class="head"><p>U8</p></th>
<th class="head"><p>U16</p></th>
<th class="head"><p>S16</p></th>
<th class="head"><p>U32</p></th>
<th class="head"><p>S32</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>U8</p></td>
<td><p>NA</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>NA</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>U16</p></td>
<td><p>yes</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>S16</p></td>
<td><p>yes</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>U32</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
</tr>
<tr class="row-even"><td><p>S32</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the <cite>convertTo</cite>
function, generated using Vivado HLS 2019.1 tool for the Xilinx®
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>581</p></td>
<td><p>523</p></td>
<td><p>119</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>963</p></td>
<td><p>1446</p></td>
<td><p>290</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>591</p></td>
<td><p>541</p></td>
<td><p>124</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>915</p></td>
<td><p>1500</p></td>
<td><p>308</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.69</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bitwise-and">
<span id="id10"></span><h2>Bitwise AND<a class="headerlink" href="#bitwise-and" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">bitwise_and</span></code> function performs the bitwise AND operation for each
pixel between two input images, and returns an output image.</p>
<blockquote>
<div><p><img alt="image15" class="image" src="_images/eqk1554997012608.png" /></p>
</div></blockquote>
<p>Where,</p>
<ul class="simple">
<li><p><img alt="image16" class="image" src="_images/hnx1554997239083.png" /> is the intensity of output image at (x, y) position</p></li>
<li><p><img alt="image17" class="image" src="_images/flv1554997335256.png" /> is the intensity of first input image at (x, y) position</p></li>
<li><p><img alt="image18" class="image" src="_images/hzb1554997205336.png" /> is the intensity of second input image at (x, y) position</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bitwise_and</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id132">
<caption><span class="caption-text">Table 41. bitwise_and Parameter Description</span><a class="headerlink" href="#id132" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. Supports 1 channel and 3
channels (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8 pixel mode)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations, respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>44</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
<td><p>72</p></td>
<td><p>13</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>155</p></td>
<td><p>61</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bitwise-not">
<span id="id11"></span><h2>Bitwise NOT<a class="headerlink" href="#bitwise-not" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">bitwise_not</span></code> function performs the pixel wise bitwise NOT
operation for the pixels in the input image, and returns an output
image. <img alt="image19" class="image" src="_images/oue1554997369417.png" /></p>
<p>Where,</p>
<ul class="simple">
<li><p><img alt="image20" class="image" src="_images/dji1554997345308.png" /> is the intensity of output image at (x, y) position</p></li>
<li><p><img alt="image21" class="image" src="_images/mou1554997322298.png" /> is the intensity of input image at (x, y) position</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bitwise_not</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id133">
<caption><span class="caption-text">Table 45. bitwise_not Parameter Description</span><a class="headerlink" href="#id133" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. Supports 1 channel and 3
channels (XF_8UC1 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations, respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<p>Table 46. bitwise_not Function Resource Utilization Summary</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>97</p></td>
<td><p>78</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>88</p></td>
<td><p>97</p></td>
<td><p>21</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>155</p></td>
<td><p>61</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<p>… rubric:: Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bitwise-or">
<span id="id12"></span><h2>Bitwise OR<a class="headerlink" href="#bitwise-or" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">bitwise_or</span></code> function performs the pixel wise bitwise OR</p>
</div></blockquote>
<p>operation between two input images, and returns an output image.
<img alt="image22" class="image" src="_images/wai1554997365850.png" /></p>
<p>Where,</p>
<ul class="simple">
<li><p><img alt="image23" class="image" src="_images/oqz1554997327566.png" /> is the intensity of output image at (x, y) position</p></li>
<li><p><img alt="image24" class="image" src="_images/fyd1554997300667.png" /> is the intensity of first input image at (x, y) position</p></li>
<li><p><img alt="image25" class="image" src="_images/six1554997114193.png" /> is the intensity of second input image at (x, y) position</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bitwise_or</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id134">
<caption><span class="caption-text">Table 49. bitwise_or Parameter Description</span><a class="headerlink" href="#id134" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. Supports 1 channel and 3
channels (XF_8UC1 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>44</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
<td><p>72</p></td>
<td><p>13</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3Channel image</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>155</p></td>
<td><p>61</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bitwise-xor">
<span id="id13"></span><h2>Bitwise XOR<a class="headerlink" href="#bitwise-xor" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">bitwise_xor</span></code> function performs the pixel wise bitwise XOR
operation between two input images, and returns an output image, as
shown below:</p>
<p><img alt="image26" class="image" src="_images/cdo1554997316350.png" /></p>
<p>Where,</p>
<ul class="simple">
<li><p><img alt="image27" class="image" src="_images/smm1554997300028.png" /> is the intensity of output image at (x, y) position</p></li>
<li><p><img alt="image28" class="image" src="_images/uif1554997296614.png" /> is the intensity of first input image at (x, y) position</p></li>
<li><p><img alt="image29" class="image" src="_images/hww1554997016357.png" /> is the intensity of second input image at (x, y) position</p></li>
</ul>
<p class="rubric" id="api-syntax-15">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bitwise_xor</span><span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id135">
<caption><span class="caption-text">Table 53. bitwise_xor Parameter Description</span><a class="headerlink" href="#id135" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. Supports 1 channel
and 3 channels (XF_8UC1 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>44</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
<td><p>72</p></td>
<td><p>13</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4k Channel image</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>155</p></td>
<td><p>61</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="blacklevelcorrection">
<span id="id14"></span><h2>Blacklevelcorrection<a class="headerlink" href="#blacklevelcorrection" title="Permalink to this headline">¶</a></h2>
<p>Black level leads to the whitening of image in dark region and perceived loss of overall
contrast. The Blacklevelcorrection algorithm corrects the black and white levels of the overall image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAX_ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAX_COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPPC</span> <span class="o">=</span> <span class="n">XF_NPPC1</span><span class="p">,</span><span class="kt">int</span> <span class="n">MUL_VALUE_WIDTH</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span><span class="kt">int</span> <span class="n">FL_POS</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span><span class="kt">int</span> <span class="n">USE_DSP</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">blackLevelCorrection</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">MAX_ROWS</span><span class="p">,</span> <span class="n">MAX_COLS</span><span class="p">,</span> <span class="n">NPPC</span><span class="o">&gt;&amp;</span> <span class="n">_Src</span><span class="p">,</span>
                          <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">MAX_ROWS</span><span class="p">,</span> <span class="n">MAX_COLS</span><span class="p">,</span> <span class="n">NPPC</span><span class="o">&gt;&amp;</span> <span class="n">_Dst</span><span class="p">,</span>
                          <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">NPPC</span><span class="p">)</span> <span class="n">black_level</span><span class="p">,</span>
                          <span class="kt">float</span> <span class="n">mul_value</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id136">
<caption><span class="caption-text">Table blacklevelcorrection correction Parameter Description</span><a class="headerlink" href="#id136" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MUL_VALUE_WIDTH</p></td>
<td><p>Width of multiplication factor.</p></td>
</tr>
<tr class="row-odd"><td><p>FL_POS</p></td>
<td><p>Number of fractional bits in multiplication factor.</p></td>
</tr>
<tr class="row-even"><td><p>USE_DSP</p></td>
<td><p>Enables usage of DSP for multiplication.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8/10/12/16-bit unsigned 1 channel
are supported (XF_8UC1, XF_10UC1, XF_12UC1, XF_16UC1).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8/10/12/16-bit unsigned 1 channel are
supported (XF_8UC1, XF_10UC1, XF_12UC1, XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>MAX_ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>MAX_COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1, XF_NPPC2 AND so on</p></td>
</tr>
<tr class="row-even"><td><p>_Src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_Dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>black_level</p></td>
<td><p>Black level value</p></td>
</tr>
<tr class="row-odd"><td><p>mul_value</p></td>
<td><p>Multiplication factor for blacklevel correction;
which is computed as maxlevel/(maxlevel-blacklevel)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations,
generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id137">
<caption><span class="caption-text">Table blacklevelcorrection Resource Utilization Summary</span><a class="headerlink" href="#id137" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel-8U</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>279</p></td>
<td><p>271</p></td>
<td><p>70</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id138">
<caption><span class="caption-text">Table blacklevelcorrection Function Performance Estimate Summary</span><a class="headerlink" href="#id138" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" rowspan="2"><p>Latency Estimate</p>
<p><strong>Max (ms)</strong></p>
</th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>3.6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="box-filter">
<span id="id15"></span><h2>Box Filter<a class="headerlink" href="#box-filter" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">boxFilter</span></code> function performs box filtering on the input image. Box filter acts as a low-pass filter and performs blurring over the image. The <code class="docutils literal notranslate"><span class="pre">boxFilter</span></code> function or the box blur is a spatial domain linear filter in which each pixel in the resulting image has a value equal to the average value of the neighboring pixels in the image.
<img alt="image30" class="image" src="_images/pqr1554997320952.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">boxFilter</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric" id="parameter-descriptions-17">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id139">
<caption><span class="caption-text">Table 57. boxFilter Parameter Description</span><a class="headerlink" href="#id139" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_SIZE</p></td>
<td><p>Filter size. Filter size of 3(XF_FILTER_3X3),
5(XF_FILTER_5X5) and 7(XF_FILTER_7X7) are supported</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. 8-bit, unsigned,
16-bit unsigned and 16-bit signed, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using Vivado HLS 2019.1 tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 25%" />
<col style="width: 16%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>545</p></td>
<td><p>519</p></td>
<td><p>104</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>876</p></td>
<td><p>870</p></td>
<td><p>189</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>1539</p></td>
<td><p>1506</p></td>
<td><p>300</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>8 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>1002</p></td>
<td><p>1368</p></td>
<td><p>264</p></td>
</tr>
<tr class="row-odd"><td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
<td><p>1576</p></td>
<td><p>3183</p></td>
<td><p>611</p></td>
</tr>
<tr class="row-even"><td><p>7x7</p></td>
<td><p>150</p></td>
<td><p>14</p></td>
<td><p>8</p></td>
<td><p>2414</p></td>
<td><p>5018</p></td>
<td><p>942</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using the Vivado HLS™ 2019.1 tool for the xczu7ev-ffvc1156-2-e FPGA, to process a grayscale 4K (3840x2160) image with UltraRAM enable.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>URAM</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>821</p></td>
<td><p>521</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1204</p></td>
<td><p>855</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>2083</p></td>
<td><p>1431</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>8 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>8</p></td>
<td><p>1263</p></td>
<td><p>1480</p></td>
</tr>
<tr class="row-odd"><td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>8</p></td>
<td><p>1771</p></td>
<td><p>3154</p></td>
</tr>
<tr class="row-even"><td><p>7x7</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
<td><p>8</p></td>
<td><p>2700</p></td>
<td><p>5411</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in different configurations, as generated using Vivado HLS 2019.1 tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 28%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><dl class="simple">
<dt>Operating Frequency</dt><dd><p>(MHz)</p>
</dd>
</dl>
</th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>3x3</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>5x5</p></td>
<td><p>7.21</p></td>
</tr>
<tr class="row-odd"><td><p>300</p></td>
<td><p>7x7</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>3x3</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-odd"><td><p>150</p></td>
<td><p>5x5</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>7x7</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="boundingbox">
<span id="id16"></span><h2>BoundingBox<a class="headerlink" href="#boundingbox" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">boundingbox</span></code> function highlights the region of interest (ROI)
from the input image using below equations.</p>
<p>P(X,Y) ≤ P(xi, yi) ≤ P(X,Y’)</p>
<p>P(X’,Y) ≤ P(xi, yi) ≤ P(X’,Y’)</p>
<p>Where,</p>
<ul class="simple">
<li><p>P(xi, yi) - Current pixel location</p></li>
<li><p>P(X,Y) - Top left corner of ROI</p></li>
<li><p>P(X,Y’) - Top right corner of ROI</p></li>
<li><p>P(X’,Y) - Bottom left corner of ROI</p></li>
<li><p>P(X’,Y’) - Bottom Right of ROI</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAX_BOXES</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">boundingbox</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Rect_</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">roi</span> <span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Scalar</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">&gt;</span> <span class="o">*</span><span class="n">color</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num_box</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id140">
<caption><span class="caption-text">Table 61. boundingbox Parameter Description</span><a class="headerlink" href="#id140" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel Type. Only 8-bit, unsigned, 1
channel and 3 channel is supported
(XF_8UC1,XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of NPC.</p></td>
</tr>
<tr class="row-odd"><td><p>MAX_BOXES</p></td>
<td><p>Maximum number of boxes, fixed to 5.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle,
possible options are XF_NPPC1 only.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>roi</p></td>
<td><p>ROI is a <code class="docutils literal notranslate"><span class="pre">xf::cv::Rect</span></code> object that consists of
the top left corner of the rectangle along with
the height and width of the rectangle.</p></td>
</tr>
<tr class="row-odd"><td><p>color</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">xf::cv::Scalar</span></code> object consists of color
information for each box (ROI).</p></td>
</tr>
<tr class="row-even"><td><p>num_box</p></td>
<td><p>Number of boxes to be detected. It should be
equal or less than MAX_BOXES.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>2521</p></td>
<td><p>1649</p></td>
<td><p>409</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in 1-pixel
mode as generated using Vivado HLS 2019.1 tool for the Xilinx
xczu9eg-ffvb1156-2-i-es2 FPGA to process a grayscale 4K (2160x3840)
image for highlighting 3 different boundaries (480x640, 100x200,
300x300).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>0.15</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Vitis Vision Reference</p>
<p>The <code class="docutils literal notranslate"><span class="pre">xf::cv::boundingbox</span></code> is complaint with below Vitis Vision function:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">rectangle</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">img</span><span class="p">,</span> <span class="n">Rect</span> <span class="n">rec</span><span class="p">,</span> <span class="k">const</span> <span class="n">Scalar</span><span class="o">&amp;</span> <span class="n">color</span><span class="p">,</span> <span class="kt">int</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lineType</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="kt">int</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="canny-edge-detection">
<span id="ariaid-title22"></span><h2>Canny Edge Detection<a class="headerlink" href="#canny-edge-detection" title="Permalink to this headline">¶</a></h2>
<p>The Canny edge detector finds the edges in an image or video frame. It
is one of the most popular algorithms for edge detection. Canny
algorithm aims to satisfy three main criteria:</p>
<ol class="arabic simple">
<li><p>Low error rate: A good detection of only existent edges.</p></li>
<li><p>Good localization: The distance between edge pixels detected and real
edge pixels have to be minimized.</p></li>
<li><p>Minimal response: Only one detector response per edge.</p></li>
</ol>
<p>In this algorithm, the noise in the image is reduced first by applying a
Gaussian mask. The Gaussian mask used here is the average mask of size
3x3. Thereafter, gradients along x and y directions are computed using
the Sobel gradient function. The gradients are used to compute the
magnitude and phase of the pixels. The phase is quantized and the pixels
are binned accordingly. Non-maximal suppression is applied on the pixels
to remove the weaker edges.</p>
<p>Edge tracing is applied on the remaining pixels to draw the edges on the
image. In this algorithm, the canny up to non-maximal suppression is in
one kernel and the edge linking module is in another kernel. After
non-maxima suppression, the output is represented as 2-bit per pixel,
Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">00</span></code> - represents the background</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">01</span></code> - represents the weaker edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">11</span></code> - represents the strong edge</p></li>
</ul>
<p>The output is packed as 8-bit (four 2-bit pixels) in 1 pixel per cycle
operation and packed as 16-bit (eight 2-bit pixels) in 8 pixel per cycle
operation. For the edge linking module, the input is 64-bit, such 32
pixels of 2-bit are packed into a 64-bit. The edge tracing is applied on
the pixels and returns the edges in the image.</p>
<p class="rubric">API Syntax</p>
<p>The .. rubric:: API Syntax for <code class="docutils literal notranslate"><span class="pre">Canny</span></code> is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTER_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">NORM_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Canny</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC1</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_lowthreshold</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_highthreshold</span><span class="p">)</span>
</pre></div>
</div>
<p>The .. rubric:: API Syntax for <code class="docutils literal notranslate"><span class="pre">EdgeTracing</span></code> is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_SRC</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_DST</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="n">voidEdgeTracing</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC_SRC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC_DST</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the <code class="docutils literal notranslate"><span class="pre">xf::cv::Canny</span></code> template and function
parameters:</p>
<table class="docutils align-default" id="id141">
<caption><span class="caption-text">Table 64. xf::cv::Canny Parameter Description</span><a class="headerlink" href="#id141" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_TYPE</p></td>
<td><p>The filter window dimensions. The options
are 3 and 5.</p></td>
</tr>
<tr class="row-odd"><td><p>NORM_TYPE</p></td>
<td><p>The type of norm used. The options for norm
type are L1NORM and L2NORM.</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1
channel is supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only XF_2UC1 is
supported. The output in case of
NPC=XF_NPPC1 is 8-bit, where four 2-bit pixel
values are packed into 8-bit. The output in
case of NPC=XF_NPPC8 is 16-bit, where 8 2-bit
pixel values are packed into 16-bit.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image
(must be a multiple of 8, in case of 8 pixel
mode)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8
for 1 pixel and 8 pixel operations
respectively. In XF_NPPC, the output image
pixels are packed and precision is XF_NPPC4.
In XF_NPPC8, output pixels precision is
XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>USE_URAM</p></td>
<td><p>Enable to map some storage structures to
URAM</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>_lowthreshold</p></td>
<td><p>The lower value of threshold for binary
thresholding.</p></td>
</tr>
<tr class="row-odd"><td><p>_highthreshold</p></td>
<td><p>The higher value of threshold for binary
thresholding.</p></td>
</tr>
</tbody>
</table>
<p>The following table describes the <code class="docutils literal notranslate"><span class="pre">EdgeTracing</span></code> template and function
parameters:</p>
<table class="docutils align-default" id="id142">
<caption><span class="caption-text">Table 65. EdgeTracing Parameter Description</span><a class="headerlink" href="#id142" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only XF_2UC1 is
supported. The input in case of NPC=XF_NPPC1
is 8-bit, where four 2-bit pixel values
are packed into 8-bit. The input in case of
of NPC=XF_NPPC8 is 16-bit, where 8 2-bit
pixel values are packed into 16-bit.</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1
channel is supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image
(must be a multiple of 32)</p></td>
</tr>
<tr class="row-even"><td><p>NPC_SRC</p></td>
<td><p>Number of pixels to be processed per cycle.
Fixed to XF_NPPC32.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_DST</p></td>
<td><p>Number of pixels to be written to
destination. Fixed to XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to URAM.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">xf::cv::Canny</span></code>
and <code class="docutils literal notranslate"><span class="pre">EdgeTracing</span></code> in different configurations, generated using Vivado
HLS 2019.1 tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a
grayscale HD (1080x1920) image for Filter size is 3.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="4"><p>Name</p></th>
<th class="head" colspan="6"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
<th class="head" rowspan="2"><p>Edge Linking</p></th>
<th class="head" rowspan="2"><p>Edge Linking</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>L1NORM,FS:3</p></th>
<th class="head"><p>L2NORM,FS:3</p></th>
<th class="head"><p>L1NORM,FS:3</p></th>
<th class="head"><p>L2NORM,FS:3</p></th>
</tr>
<tr class="row-even"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>BRAM_18K</p></td>
<td><p>22</p></td>
<td><p>18</p></td>
<td><p>36</p></td>
<td><p>32</p></td>
<td><p>84</p></td>
<td><p>84</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>16</p></td>
<td><p>32</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>3027</p></td>
<td><p>3507</p></td>
<td><p>4899</p></td>
<td><p>6208</p></td>
<td><p>17600</p></td>
<td><p>14356</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>2626</p></td>
<td><p>3170</p></td>
<td><p>6518</p></td>
<td><p>9560</p></td>
<td><p>15764</p></td>
<td><p>14274</p></td>
</tr>
<tr class="row-odd"><td><p>CLB</p></td>
<td><p>606</p></td>
<td><p>708</p></td>
<td><p>1264</p></td>
<td><p>1871</p></td>
<td><p>2955</p></td>
<td><p>3241</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">xf::cv::Canny</span></code>
and <code class="docutils literal notranslate"><span class="pre">EdgeTracing</span></code> in different configurations, generated using Vivado HLS
2019.1 tool for the xczu7ev-ffvc1156-2-e FPGA, to process a grayscale 4K
image for Filter size is 3.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="4"><p>Name</p></th>
<th class="head" colspan="6"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
<th class="head" rowspan="2"><p>Edge Linking</p></th>
<th class="head" rowspan="2"><p>Edge Linking</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>L1NORM,FS:3</p></th>
<th class="head"><p>L2NORM,FS:3</p></th>
<th class="head"><p>L1NORM,FS:3</p></th>
<th class="head"><p>L2NORM,FS:3</p></th>
</tr>
<tr class="row-even"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>BRAM_18K</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>URAM</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>15</p></td>
<td><p>13</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>16</p></td>
<td><p>32</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>3184</p></td>
<td><p>3749</p></td>
<td><p>5006</p></td>
<td><p>7174</p></td>
<td><p>5581</p></td>
<td><p>7054</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>2511</p></td>
<td><p>2950</p></td>
<td><p>6695</p></td>
<td><p>9906</p></td>
<td><p>4092</p></td>
<td><p>6380</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image for L1NORM, filter size is 3 and including the edge linking
module.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>10.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>8.5</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>In OpenCV <cite>Canny</cite> function, the Gaussian blur is not applied as a pre-processing step.</p>
</div>
<div class="section" id="channel-combine">
<span id="id17"></span><h2>Channel Combine<a class="headerlink" href="#channel-combine" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">merge</span></code> function, merges single channel images into a
multi-channel image. The number of channels to be merged should be two, three or four.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">merge</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src3</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src4</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_dst</span><span class="p">)</span>

<span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">merge</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src3</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_dst</span><span class="p">)</span>

<span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">merge</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id143">
<caption><span class="caption-text">Table 69. merge Parameter Description</span><a class="headerlink" href="#id143" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Paramete
r</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1, channel
is supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit, unsigned,2,3 and 4 channels are
supported (XF_8UC2, XF_8UC3 and XF_8UC4)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be multiple
of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 for 1 pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>_src1</p></td>
<td><p>Input single-channel image</p></td>
</tr>
<tr class="row-even"><td><p>_src2</p></td>
<td><p>Input single-channel image</p></td>
</tr>
<tr class="row-odd"><td><p>_src3</p></td>
<td><p>Input single-channel image (only for 3 and 4 input config)</p></td>
</tr>
<tr class="row-even"><td><p>_src4</p></td>
<td><p>Input single-channel image (only for 4 input config)</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output multi-channel image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the merge
function, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process 4 single-channel HD
(1080x1920) images.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>494</p></td>
<td><p>386</p></td>
<td><p>85</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process 4 single channel HD (1080x1920)
images.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.92</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="channel-extract">
<span id="id18"></span><h2>Channel Extract<a class="headerlink" href="#channel-extract" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">extractChannel</span></code> function splits a multi-channel array (32-bit
pixel-interleaved data) into several single-channel arrays and returns a
single channel. The channel to be extracted is specified by using the
channel argument.</p>
<p>The value of the channel argument is specified by macros defined in the
<code class="docutils literal notranslate"><span class="pre">xf_channel_extract_e</span></code> enumerated data type. The following table
summarizes the possible values for the <code class="docutils literal notranslate"><span class="pre">xf_channel_extract_e</span></code>
enumerated data type:</p>
<table class="docutils align-default" id="id144">
<caption><span class="caption-text">Table 72. xf_channel_extract_e Enumerated Data Type Values</span><a class="headerlink" href="#id144" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 41%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Channel</p></th>
<th class="head"><p>Enumerated Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Unknown</p></td>
<td><p>XF_EXTRACT_CH_0</p></td>
</tr>
<tr class="row-odd"><td><p>Unknown</p></td>
<td><p>XF_EXTRACT_CH_1</p></td>
</tr>
<tr class="row-even"><td><p>Unknown</p></td>
<td><p>XF_EXTRACT_CH_2</p></td>
</tr>
<tr class="row-odd"><td><p>Unknown</p></td>
<td><p>XF_EXTRACT_CH_3</p></td>
</tr>
<tr class="row-even"><td><p>RED</p></td>
<td><p>XF_EXTRACT_CH_R</p></td>
</tr>
<tr class="row-odd"><td><p>GREEN</p></td>
<td><p>XF_EXTRACT_CH_G</p></td>
</tr>
<tr class="row-even"><td><p>BLUE</p></td>
<td><p>XF_EXTRACT_CH_B</p></td>
</tr>
<tr class="row-odd"><td><p>ALPHA</p></td>
<td><p>XF_EXTRACT_CH_A</p></td>
</tr>
<tr class="row-even"><td><p>LUMA</p></td>
<td><p>XF_EXTRACT_CH_Y</p></td>
</tr>
<tr class="row-odd"><td><p>Cb/U</p></td>
<td><p>XF_EXTRACT_CH_U</p></td>
</tr>
<tr class="row-even"><td><p>Cr/V/Value</p></td>
<td><p>XF_EXTRACT_CH_V</p></td>
</tr>
</tbody>
</table>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">extractChannel</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">_channel</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id145">
<caption><span class="caption-text">Table 73. extractChannel Parameter Description</span><a class="headerlink" href="#id145" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Paramete
r</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 4channel is
supported (XF_8UC4)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be multiple
of 8 for 8 pixel mode</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 for 1 pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_ma
t</p></td>
<td><p>Input multi-channel image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_ma
t</p></td>
<td><p>Output single channel image</p></td>
</tr>
<tr class="row-odd"><td><p>_channe
l</p></td>
<td><p>Channel to be extracted (See xf_channel_extract_e
enumerated type in file xf_params.h for possible values.)</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
extractChannel function, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4 channel HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>508</p></td>
<td><p>354</p></td>
<td><p>96</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a 4 channel HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.92</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="color-conversion">
<span id="id19"></span><h2>Color Conversion<a class="headerlink" href="#color-conversion" title="Permalink to this headline">¶</a></h2>
<p>The color conversion functions convert one image format to another image
format, for the combinations listed in the following table. The rows
represent the input formats and the columns represent the output
formats. Supported conversions are discussed in the following sections.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 3%" />
<col style="width: 10%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>I/O Formats</p></th>
<th class="head"><p>RGBA</p></th>
<th class="head"><p>NV12</p></th>
<th class="head"><p>NV21</p></th>
<th class="head"><p>IYUV</p></th>
<th class="head"><p>UYVY</p></th>
<th class="head"><p>YUYV</p></th>
<th class="head"><p>YUV4</p></th>
<th class="head"><p>RGB</p></th>
<th class="head"><p>BGR</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RGBA</p></td>
<td><p>N/A</p></td>
<td><p>For details, see the RGBA to NV12</p></td>
<td><p>For details, see the RGBA to NV21</p></td>
<td><p>For details, see the RGBA/RGB to IYUV</p></td>
<td></td>
<td></td>
<td><p>For details, see the RGBA/RGB to YUV4</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>NV12</p></td>
<td><p>For details, see the NV12 to RGBA</p></td>
<td><p>N/A</p></td>
<td><p>For details, see the NV12 to NV21/NV21 to NV12</p></td>
<td><p>For details, see the NV12 to IYUV</p></td>
<td><p>For details, see the NV12/NV21 to UYVY/YUYV</p></td>
<td><p>For details, see the NV12/NV21 to UYVY/YUYV</p></td>
<td><p>For details, see the NV12 to YUV4</p></td>
<td><p>For details, see the NV12/NV21 to RGB/ BGR</p></td>
<td><p>For details, see the NV12/NV21 to RGB/ BGR</p></td>
</tr>
<tr class="row-even"><td><p>NV21</p></td>
<td><p>For details, see the NV21 to RGBA</p></td>
<td><p>For details, see the NV12 to NV21/NV21 to NV12</p></td>
<td><p>N/A</p></td>
<td><p>For details, see the NV21 to IYUV</p></td>
<td><p>For details, see the NV12/NV21 to UYVY/YUYV</p></td>
<td><p>For details, see the NV12/NV21 to UYVY/YUYV</p></td>
<td><p>For details, see the NV21 to YUV4</p></td>
<td><p>For details, see the NV12/NV21 to RGB/ BGR</p></td>
<td><p>For details, see the NV12/NV21 to RGB/ BGR</p></td>
</tr>
<tr class="row-odd"><td><p>IYUV</p></td>
<td><p>For details, see the IYUV to RGBA/RGB</p></td>
<td><p>For details, see the IYUV to NV12</p></td>
<td></td>
<td><p>N/A</p></td>
<td></td>
<td></td>
<td><p>For details, see the IYUV to YUV4</p></td>
<td><p>For details, see the IYUV to RGBA/RGB</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>UYVY</p></td>
<td><p>For details, see the UYVY to RGBA</p></td>
<td><p>For details, see the UYVY to NV12</p></td>
<td></td>
<td><p>For details, see the UYVY to IYUV</p></td>
<td><p>N/A</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>YUYV</p></td>
<td><p>For details, see the YUYV to RGBA</p></td>
<td><p>For details, see the YUYV to NV12</p></td>
<td></td>
<td><p>For details, see the YUYV to IYUV</p></td>
<td></td>
<td><p>N/A</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>YUV4</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><p>N/A</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>RGB</p></td>
<td></td>
<td><p>For details see the RGB/ BGR to NV12/NV21</p></td>
<td><p>For details see theRGB/ BGR to NV12/NV21</p></td>
<td><p>For details see the RGBA/RGB to IYUV</p></td>
<td><p>For details see the RGB/BGR to UYVY/YUYV</p></td>
<td><p>For details see the RGB/BGR to UYVY/YUYV</p></td>
<td><p>For details see the RGBA/RGB to YUV4</p></td>
<td></td>
<td><p>For details see the BGR to RGB / RGB to BGR</p></td>
</tr>
<tr class="row-even"><td><p>BGR</p></td>
<td></td>
<td><p>For details see the RGB/ BGR to NV12/NV21</p></td>
<td><p>For details see theRGB/ BGR to NV12/NV21</p></td>
<td></td>
<td><p>For details see the RGB/BGR to UYVY/YUYV</p></td>
<td><p>For details see the RGB/BGR to UYVY/YUYV</p></td>
<td></td>
<td><p>For details see the BGR to RGB / RGB to BGR</p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Other conversions</p>
<p>Few other conversions are also added.
BGR/RGB&lt;-&gt;HSV,BGR/RGB&lt;-&gt;HLS,BGR/RGB&lt;-&gt;YCrCb,BGR/RGB&lt;-&gt;XYZ and RGB&lt;-&gt;BGR
conversions are added.</p>
<div class="section" id="rgb-to-yuv-conversion-matrix">
<span id="rgb-to-yuv"></span><h3>RGB to YUV Conversion Matrix<a class="headerlink" href="#rgb-to-yuv-conversion-matrix" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Following is the formula to convert RGB data to YUV data:</div>
<div class="line"><img alt="image31" class="image" src="_images/yjz1554997272230.png" /></div>
</div>
</div>
<div class="section" id="yuv-to-rgb-conversion-matrix">
<span id="yuv-to-rgb"></span><h3>YUV to RGB Conversion Matrix<a class="headerlink" href="#yuv-to-rgb-conversion-matrix" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Following is the formula to convert YUV data to RGB data:</div>
<div class="line"><img alt="image32" class="image" src="_images/mte1554997313655.png" /></div>
</div>
<p>Source: <a class="reference external" href="http://www.fourcc.org/fccyvrgb.php">http://www.fourcc.org/fccyvrgb.php</a></p>
</div>
<div class="section" id="rgba-rgb-to-yuv4">
<span id="rgba-yuv4"></span><h3>RGBA/RGB to YUV4<a class="headerlink" href="#rgba-rgb-to-yuv4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgba2yuv4</span></code> function converts a 4-channel RGBA image to YUV444
format and the <code class="docutils literal notranslate"><span class="pre">rgb2yuv4</span></code> function converts a 3-channel RGB image to
YUV444 format. The function outputs Y, U, and V streams separately.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgba2yuv4</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgb2yuv4</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id146">
<caption><span class="caption-text">Table (rgba/rgb)2yuv4 Parameter Description</span><a class="headerlink" href="#id146" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 4(RGBA) and
3(RGB)-channel are supported (XF_8UC4 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGBA/RGB to
YUV4 for different configurations, generated using Vivado HLS 2019.1
tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>589</p></td>
<td><p>328</p></td>
<td><p>96</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGBA/RGB to YUV4 for
different configurations, as generated using the Vivado HLS 2019.1
version for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>1.89</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgba-rgb-to-iyuv">
<span id="rgba-iyuv"></span><h3>RGBA/RGB to IYUV<a class="headerlink" href="#rgba-rgb-to-iyuv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgba2iyuv</span></code> function converts a 4-channel RGBA image to IYUV
(4:2:0) format and the <code class="docutils literal notranslate"><span class="pre">rgb2iyuv</span></code> function converts a 3-channel RGB
image to IYUV (4:2:0) format. The function outputs Y, U, and V planes
separately. IYUV holds subsampled data, Y is sampled for every RGBA/RGB
pixel and U,V are sampled once for 2row and 2column(2x2) pixels. U and V
planes are of (rows/2)*(columns/2) size, by cascading the consecutive
rows into a single row the planes size becomes (rows/4)*columns.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgba2iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgb2iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id147">
<caption><span class="caption-text">Table (rgba/rgb)2iyuv Parameter Description</span><a class="headerlink" href="#id147" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit,unsigned, 4(RGBA) and
3(RGB)-channel are supported (XF_8UC4 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit,unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U image of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V image of size (ROWS/4, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGBA/RGB to
IYUV for different configurations, generated using Vivado HLS 2019.1
tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>816</p></td>
<td><p>472</p></td>
<td><p>149</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGBA/RGB to IYUV for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>1.8</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgba-to-nv12">
<span id="rgba-nv12"></span><h3>RGBA to NV12<a class="headerlink" href="#rgba-to-nv12" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgba2nv12</span></code> function converts a 4-channel RGBA image to NV12
(4:2:0) format. The function outputs Y plane and interleaved UV plane
separately. NV12 holds the subsampled data, Y is sampled for every RGBA
pixel and U, V are sampled once for 2row and 2columns (2x2) pixels. UV
plane is of (rows/2)*(columns/2) size as U and V values are interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgba2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id148">
<caption><span class="caption-text">Table rgba2nv12 Parameter Description</span><a class="headerlink" href="#id148" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit,unsigned, 4-channel is
supported (XF_8UC4).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output pixel type. Only 8-bit,unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output pixel type. Only 8-bit,unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input RGBA image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_y</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_uv</p></td>
<td><p>Output UV image of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGBA to NV12
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>802</p></td>
<td><p>452</p></td>
<td><p>128</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGBA to NV12 for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>1.8</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgba-to-nv21">
<span id="rgba-nv21"></span><h3>RGBA to NV21<a class="headerlink" href="#rgba-to-nv21" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgba2nv21</span></code> function converts a 4-channel RGBA image to NV21
(4:2:0) format. The function outputs Y plane and interleaved VU plane
separately. NV21 holds subsampled data, Y is sampled for every RGBA
pixel and U, V are sampled once for 2 row and 2 columns (2x2) RGBA
pixels. UV plane is of (rows/2)*(columns/2) size as V and U values are
interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgba2nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id149">
<caption><span class="caption-text">Table rgba2nv21 Parameter Description</span><a class="headerlink" href="#id149" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 4-channel is
supported (XF_8UC4).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input RGBA image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_y</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_uv</p></td>
<td><p>Output UV image of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGBA to NV21
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>802</p></td>
<td><p>453</p></td>
<td><p>131</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGBA to NV21 for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>1.89</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="yuyv-to-rgba">
<span id="yuyv-rgba"></span><h3>YUYV to RGBA<a class="headerlink" href="#yuyv-to-rgba" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">yuyv2rgba</span></code> function converts a single-channel YUYV (YUV 4:2:2)
image format to a 4-channel RGBA image. YUYV is a sub-sampled format, a
set of YUYV value gives 2 RGBA pixel values. YUYV is represented in
16-bit values where as, RGBA is represented in 32-bit values.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">yuyv2rgba</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id150">
<caption><span class="caption-text">Table yuyv2rgba Parameter Description</span><a class="headerlink" href="#id150" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned, 1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 4-channel is
supported (XF_8UC4).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 incase of 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of YUYV to RGBA
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>6</p></td>
<td><p>765</p></td>
<td><p>705</p></td>
<td><p>165</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of UYVY to RGBA for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="yuyv-to-nv12">
<span id="yuv-to-nv12"></span><h3>YUYV to NV12<a class="headerlink" href="#yuyv-to-nv12" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">yuyv2nv12</span></code> function converts a single-channel YUYV (YUV 4:2:2)
image format to NV12 (YUV 4:2:0) format. YUYV is a sub-sampled format, 1
set of YUYV value gives 2 Y values and 1 U and V value each.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">yuyv2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id151">
<caption><span class="caption-text">Table yuyv2nv12 Parameter Description</span><a class="headerlink" href="#id151" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned, 1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output UV image pixel type. Only 8-bit, unsigned,
2-channel is supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_uv_image</p></td>
<td><p>Output U plane of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of YUYV to NV12
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>831</p></td>
<td><p>491</p></td>
<td><p>149</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1196</p></td>
<td><p>632</p></td>
<td><p>161</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of YUYV to NV12 for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="yuyv-to-iyuv">
<span id="id20"></span><h3>YUYV to IYUV<a class="headerlink" href="#yuyv-to-iyuv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">yuyv2iyuv</span></code> function converts a single-channel YUYV (YUV 4:2:2)
image format to IYUV(4:2:0) format. Outputs of the function are separate
Y, U, and V planes. YUYV is a sub-sampled format, 1 set of YUYV value
gives 2 Y values and 1 U and V value each. U, V values of the odd rows
are dropped as U, V values are sampled once for 2 rows and 2 columns in
the IYUV(4:2:0) format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">yuyv2iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id152">
<caption><span class="caption-text">Table yuyv2iyuv Parameter Description</span><a class="headerlink" href="#id152" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned,1 channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel modes.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS/4, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of YUYV to IYUV
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>835</p></td>
<td><p>497</p></td>
<td><p>149</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1428</p></td>
<td><p>735</p></td>
<td><p>210</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of YUYV to IYUV for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="uyvy-to-iyuv">
<span id="id21"></span><h3>UYVY to IYUV<a class="headerlink" href="#uyvy-to-iyuv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">uyvy2iyuv</span></code> function converts a UYVY (YUV 4:2:2) single-channel
image to the IYUV format. The outputs of the functions are separate Y,
U, and V planes. UYVY is sub sampled format. One set of UYVY value gives
two Y values and one U and V value each.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">uyvy2iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id153">
<caption><span class="caption-text">Table uyvy2iyuv Parameter Description</span><a class="headerlink" href="#id153" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned, 1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS/4, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of UYVY to IYUV
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<p>Table uyvy2iyuv Function Resource Utilization Summary</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>835</p></td>
<td><p>494</p></td>
<td><p>139</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1428</p></td>
<td><p>740</p></td>
<td><p>209</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of UYVY to IYUV for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
<p id="uyvy-to-rgba">UYVY to RGBA</p>
<p>The <code class="docutils literal notranslate"><span class="pre">uyvy2rgba</span></code> function converts a UYVY (YUV 4:2:2) single-channel
image to a 4-channel RGBA image. UYVY is sub sampled format, 1set of
UYVY value gives 2 RGBA pixel values. UYVY is represented in 16-bit
values where as RGBA is represented in 32-bit values.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">uyvy2rgba</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id154">
<caption><span class="caption-text">Table uyvy2rgba Parameter Description</span><a class="headerlink" href="#id154" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned, 1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of UYVY to RGBA
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>6</p></td>
<td><p>773</p></td>
<td><p>704</p></td>
<td><p>160</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of UYVY to RGBA for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.8</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="uyvy-to-nv12">
<span id="id22"></span><h3>UYVY to NV12<a class="headerlink" href="#uyvy-to-nv12" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">uyvy2nv12</span></code> function converts a UYVY (YUV 4:2:2) single-channel
image to NV12 format. The outputs are separate Y and UV planes. UYVY is
sub sampled format, 1 set of UYVY value gives 2 Y values and 1 U and V
value each.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">uyvy2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id155">
<caption><span class="caption-text">Table uyvy2nv12 Parameter Description</span><a class="headerlink" href="#id155" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned, 1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output UV image pixel type. Only 8-bit, unsigned,
2-channel is supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_uv_image</p></td>
<td><p>Output U plane of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of UYVY to NV12
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>831</p></td>
<td><p>488</p></td>
<td><p>131</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1235</p></td>
<td><p>677</p></td>
<td><p>168</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of UYVY to NV12 for
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="iyuv-to-rgba-rgb">
<span id="iyuv-to-rgba"></span><h3>IYUV to RGBA/RGB<a class="headerlink" href="#iyuv-to-rgba-rgb" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">iyuv2rgba</span></code> function converts single channel IYUV (YUV 4:2:0)
image to a 4-channel RGBA image and <code class="docutils literal notranslate"><span class="pre">iyuv2rgb</span></code> function converts
single channel IYUV (YUV 4:2:0) image to a 3-channel RGB image . The
inputs to the function are separate Y, U, and V planes. IYUV is sub
sampled format, U and V values are sampled once for 2 rows and 2 columns
of the RGBA/RGB pixels. The data of the consecutive rows of size
(columns/2) is combined to form a single row of size (columns).</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">iyuv2rgba</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_u</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_v</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">iyuv2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_u</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_v</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id156">
<caption><span class="caption-text">Table iyuv2(rgba/rgb) Parameter Description</span><a class="headerlink" href="#id156" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 4(RGBA) and
3(RGB)-channel are supported (XF_8UC4 and XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>src_u</p></td>
<td><p>Input U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_v</p></td>
<td><p>Input V plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_dst0</p></td>
<td><p>Output RGBA image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of IYUV to
RGBA/RGB for different configurations, generated using Vivado HLS 2019.1
tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>1208</p></td>
<td><p>728</p></td>
<td><p>196</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of IYUV to RGBA/RGB for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="iyuv-to-nv12">
<span id="id23"></span><h3>IYUV to NV12<a class="headerlink" href="#iyuv-to-nv12" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">iyuv2nv12</span></code> function converts single channel IYUV image to NV12
format. The inputs are separate U and V planes. There is no need of
processing Y plane as both the formats have a same Y plane. U and V
values are rearranged from plane interleaved to pixel interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">iyuv2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_u</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_v</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id157">
<caption><span class="caption-text">Table iyuv2nv12 Parameter Description</span><a class="headerlink" href="#id157" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8 for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 4-pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_u</p></td>
<td><p>Input U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>src_v</p></td>
<td><p>Input V plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_y_image</p></td>
<td><p>Output V plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_uv_image</p></td>
<td><p>Output UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of IYUV to NV12
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image..</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>12</p></td>
<td><p>907</p></td>
<td><p>677</p></td>
<td><p>158</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>12</p></td>
<td><p>1591</p></td>
<td><p>1022</p></td>
<td><p>235</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of IYUV to NV12 for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="iyuv-to-yuv4">
<span id="id24"></span><h3>IYUV to YUV4<a class="headerlink" href="#iyuv-to-yuv4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">iyuv2yuv4</span></code> function converts a single channel IYUV image to a
YUV444 format. Y plane is same for both the formats. The inputs are
separate U and V planes of IYUV image and the outputs are separate U and
V planes of YUV4 image. IYUV stores subsampled U,V values. YUV format
stores U and V values for every pixel. The same U, V values are
duplicated for 2 rows and 2 columns (2x2) pixels in order to get the
required data in the YUV444 format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">iyuv2yuv4</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_u</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_v</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id158">
<caption><span class="caption-text">Table iyuv2yuv4 Parameter Description</span><a class="headerlink" href="#id158" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_u</p></td>
<td><p>Input U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>src_v</p></td>
<td><p>Input V plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_y_image</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_u_image</p></td>
<td><p>Output U image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_v_image</p></td>
<td><p>Output V image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of IYUV to YUV4
for different configurations, generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1398</p></td>
<td><p>870</p></td>
<td><p>232</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>2134</p></td>
<td><p>1214</p></td>
<td><p>304</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of IYUV to YUV4 for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>13.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>3.4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv12-to-iyuv">
<span id="id25"></span><h3>NV12 to IYUV<a class="headerlink" href="#nv12-to-iyuv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv122iyuv</span></code> function converts NV12 format to IYUV format. The
function inputs the interleaved UV plane and the outputs are separate U
and V planes. There is no need of processing the Y plane as both the
formats have a same Y plane. U and V values are rearranged from pixel
interleaved to plane interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv122iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id159">
<caption><span class="caption-text">Table nv122iyuv Parameter Description</span><a class="headerlink" href="#id159" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8 pixel mode).</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 4-pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS/4, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV12 to IYUV
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1344</p></td>
<td><p>717</p></td>
<td><p>208</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1961</p></td>
<td><p>1000</p></td>
<td><p>263</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV12 to IYUV for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv12-to-rgba">
<span id="id26"></span><h3>NV12 to RGBA<a class="headerlink" href="#nv12-to-rgba" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv122rgba</span></code> function converts NV12 image format to a 4-channel
RGBA image. The inputs to the function are separate Y and UV planes.
NV12 holds sub sampled data, Y plane is sampled at unit rate and 1 U and
1 V value each for every 2x2 Y values. To generate the RGBA data, each U
and V value is duplicated (2x2) times.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv122rgba</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id160">
<caption><span class="caption-text">Table nv122rgba Parameter Description</span><a class="headerlink" href="#id160" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit,unsigned,4channel is
supported (XF_8UC4).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_dst0</p></td>
<td><p>Output RGBA image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV12 to RGBA
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>1191</p></td>
<td><p>708</p></td>
<td><p>195</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV12 to RGBA for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv12-to-yuv4">
<span id="id27"></span><h3>NV12 to YUV4<a class="headerlink" href="#nv12-to-yuv4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv122yuv4</span></code> function converts a NV12 image format to a YUV444
format. The function outputs separate U and V planes. Y plane is same
for both the image formats. The UV planes are duplicated 2x2 times to
represent one U plane and V plane of the YUV444 image format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv122yuv4</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id161">
<caption><span class="caption-text">Table nv122yuv4 Parameter Description</span><a class="headerlink" href="#id161" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8 pixel mode).</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 4-pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV12 to YUV4
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1383</p></td>
<td><p>832</p></td>
<td><p>230</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1772</p></td>
<td><p>1034</p></td>
<td><p>259</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV12 to YUV4 for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>13.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>3.4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv21-to-iyuv">
<span id="id28"></span><h3>NV21 to IYUV<a class="headerlink" href="#nv21-to-iyuv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv212iyuv</span></code> function converts a NV21 image format to an IYUV image
format. The input to the function is the interleaved VU plane only and
the outputs are separate U and V planes. There is no need of processing
Y plane as both the formats have same the Y plane. U and V values are
rearranged from pixel interleaved to plane interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv212iyuv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id162">
<caption><span class="caption-text">Table nv212iyuv Parameter Description</span><a class="headerlink" href="#id162" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image .</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 4-pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS/4, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS/4, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV21 to IYUV
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1377</p></td>
<td><p>730</p></td>
<td><p>219</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1975</p></td>
<td><p>1012</p></td>
<td><p>279</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV21 to IYUV for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv21-to-rgba">
<span id="id29"></span><h3>NV21 to RGBA<a class="headerlink" href="#nv21-to-rgba" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv212rgba</span></code> function converts a NV21 image format to a 4-channel
RGBA image. The inputs to the function are separate Y and VU planes.
NV21 holds sub sampled data, Y plane is sampled at unit rate and one U
and one V value each for every 2x2 Yvalues. To generate the RGBA data,
each U and V value is duplicated (2x2) times.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv212rgba</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id163">
<caption><span class="caption-text">Table nv212rgba Parameter Description</span><a class="headerlink" href="#id163" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 4-channel is
supported (XF_8UC4).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8, incase of 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_dst0</p></td>
<td><p>Output RGBA image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV21 to RGBA
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>1170</p></td>
<td><p>673</p></td>
<td><p>183</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV12 to RGBA for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv21-to-yuv4">
<span id="id30"></span><h3>NV21 to YUV4<a class="headerlink" href="#nv21-to-yuv4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv212yuv4</span></code> function converts an image in the NV21 format to a
YUV444 format. The function outputs separate U and V planes. Y plane is
same for both formats. The UV planes are duplicated 2x2 times to
represent one U plane and V plane of YUV444 format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv212yuv4</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_u_image</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_v_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id164">
<caption><span class="caption-text">Table nv212yuv4 Parameter Description</span><a class="headerlink" href="#id164" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8 pixel mode).</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV image Pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC4 for 1
pixel and 4-pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Input Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>Input UV plane of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Output Y plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_u_image</p></td>
<td><p>Output U plane of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-even"><td><p>_v_image</p></td>
<td><p>Output V plane of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of NV21 to YUV4
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1383</p></td>
<td><p>817</p></td>
<td><p>233</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1887</p></td>
<td><p>1087</p></td>
<td><p>287</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of NV21 to YUV4 for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>13.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>3.5</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgb-to-gray">
<span id="id31"></span><h3>RGB to GRAY<a class="headerlink" href="#rgb-to-gray" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgb2gray</span></code> function converts a 3-channel RGB image to GRAY format.</p>
<p>Y= 0.299*R+0.587*G+0.114*B</p>
<p>Where,</p>
<ul class="simple">
<li><p>Y = Gray pixel</p></li>
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id165">
<caption><span class="caption-text">Table RGB2GRAY Parameter Description</span><a class="headerlink" href="#id165" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>GRAY output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB to GRAY
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>439</p></td>
<td><p>280</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGB to GRAY for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<p>Table RGB2GRAY Function Performance Estimate Summary
+—————————–+——————+
| Operating Mode              | Latency Estimate |
+                             +——————+
|                             | Max Latency (ms) |
+=============================+==================+
| 1 pixel operation (300 MHz) | 6.9              |
+—————————–+——————+</p>
</div>
<div class="section" id="bgr-to-gray">
<span id="id32"></span><h3>BGR to GRAY<a class="headerlink" href="#bgr-to-gray" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">bgr2gray</span></code> function converts a 3-channel BGR image to GRAY format.</p>
<p>Y= 0.299*R+0.587*G+0.114*B</p>
<p>Where,</p>
<ul class="simple">
<li><p>Y = Gray pixel</p></li>
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">bgr2gray</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id166">
<caption><span class="caption-text">Table bgr2gray Parameter Description</span><a class="headerlink" href="#id166" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>SRC_T</strong></p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DST_T</strong></p></td>
<td><p>Output pixel type. Only 8-bit, unsigned,1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p><strong>ROWS</strong></p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>COLS</strong></p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p><strong>NPC</strong></p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>_src</strong></p></td>
<td><p>BGR input image</p></td>
</tr>
<tr class="row-even"><td><p><strong>_dst</strong></p></td>
<td><p>GRAY output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of BGR to GRAY
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>439</p></td>
<td><p>280</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of BGR to GRAY for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<p>Table bgr2gray Function Performance Estimate Summary</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gray-to-rgb">
<span id="id33"></span><h3>GRAY to RGB<a class="headerlink" href="#gray-to-rgb" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gray2rgb</span></code> function converts a gray intensity image to RGB color
format.</p>
<p>R&lt;-Y, G&lt;-Y, B&lt;-Y</p>
<ul class="simple">
<li><p>Y = Gray pixel</p></li>
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">gray2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id167">
<caption><span class="caption-text">Table gray2rgb Parameter Description</span><a class="headerlink" href="#id167" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>GRAY input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of gray2rgb for
different configurations, as generated in the Vivado HLS 2019.1 version
tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>156</p></td>
<td><p>184</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of gray2rgb for different
configurations, as generated using the Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gray-to-bgr">
<span id="id34"></span><h3>GRAY to BGR<a class="headerlink" href="#gray-to-bgr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gray2bgr</span></code> function converts a gray intensity image to RGB color
format.</p>
<p>R&lt;-Y, G&lt;-Y, B&lt;-Y</p>
<p>Where,</p>
<ul class="simple">
<li><p>Y = Gray pixel</p></li>
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">gray2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id168">
<caption><span class="caption-text">Table gray2bgr Parameter Description</span><a class="headerlink" href="#id168" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>GRAY input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>BGR output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of gray2bgr for
different configurations, as generated in the Vivado HLS 2019.1 version
tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>156</p></td>
<td><p>184</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of gray2bgr for different
configurations, as generated using the Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1, to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
<p id="hls-to-rgb">HLS to RGB/BGR</p>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">hls2(rgb/bgr)</span></code> function converts HLS color space to 3-channel
RGB/BGR image.</div>
<div class="line"><img alt="image33" class="image" src="_images/kfj1558525968533.svg" /></div>
<div class="line"><img alt="image34" class="image" src="_images/xuh1558526048657.svg" /></div>
<div class="line"><img alt="image35" class="image" src="_images/xfi1558526076955.svg" /></div>
<div class="line"><img alt="image36" class="image" src="_images/lfz1558526114011.svg" /></div>
<div class="line"><img alt="image37" class="image" src="_images/wnz1558526149545.svg" /></div>
<div class="line"><img alt="image38" class="image" src="_images/pxm1558526179484.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">hls2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">hls2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id169">
<caption><span class="caption-text">Table HLS2RGB/BGR Parameter Description</span><a class="headerlink" href="#id169" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>HLS input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB/BGR output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of HLS2RGB/BGRR
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>4366</p></td>
<td><p>3096</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of HLS2RGB/BGR for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgb-to-xyz">
<span id="id35"></span><h3>RGB to XYZ<a class="headerlink" href="#rgb-to-xyz" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">rgb2xyz</span></code> function converts a 3-channel RGB image to XYZ color
space.</div>
<div class="line"><img alt="image39" class="image" src="_images/fpa1558523902475.svg" /></div>
</div>
<ul class="simple">
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2xyz</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id170">
<caption><span class="caption-text">Table RGB2XYZ Parameter Description</span><a class="headerlink" href="#id170" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported. (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>XYZ output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB to XYZ
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>644</p></td>
<td><p>380</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGB to XYZ for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bgr-to-xyz">
<span id="id36"></span><h3>BGR to XYZ<a class="headerlink" href="#bgr-to-xyz" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">bgr2xyz</span></code> function converts a 3-channel BGR image to XYZ color
space.</div>
<div class="line"><img alt="image40" class="image" src="_images/fif1558524209767.svg" /></div>
</div>
<ul class="simple">
<li><p>R= Red channel</p></li>
<li><p>G= Green channel</p></li>
<li><p>B= Blue channel</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2xyz</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id171">
<caption><span class="caption-text">Table RGB2XYZ Parameter Description</span><a class="headerlink" href="#id171" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be a
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>BGR input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>XYZ output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of BGR to XYZ
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>644</p></td>
<td><p>380</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of BGR to XYZ for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
<p id="rgb-to-ycrcb">RGB/BGR to YCrCb</p>
<p>The <code class="docutils literal notranslate"><span class="pre">(rgb/bgr)2ycrcb</span></code> function converts a 3-channel RGB image to YCrCb
color space.</p>
<ul class="simple">
<li><p>Y = 0.299*R + 0.587*G + 0.114*B</p></li>
<li><p>Cr= (R-Y)*0.713+delta</p></li>
<li><p>Cb= (B-Y)*0.564+delta</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image41" class="image" src="_images/imv1558524546359.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2ycrcb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2ycrcb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id172">
<caption><span class="caption-text">Table RGB/BGR2YCrCb Parameter Description</span><a class="headerlink" href="#id172" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB/BGR input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>YCrCb output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB/BGR2YCrCb
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>660</p></td>
<td><p>500</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGB/BGR2YCrCb for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgb-bgr-to-hsv">
<span id="rgb-to-hsv"></span><h3>RGB/BGR to HSV<a class="headerlink" href="#rgb-bgr-to-hsv" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">(rgb/bgr)2hsv</span></code> function converts a 3-channel RGB image to HSV
color space.</div>
<div class="line"><img alt="image42" class="image" src="_images/hmq1558524967044.svg" /></div>
<div class="line"><img alt="image43" class="image" src="_images/tob1558525028884.svg" /></div>
<div class="line"><img alt="image44" class="image" src="_images/kzg1558525075919.svg" /></div>
<div class="line"><img alt="image45" class="image" src="_images/tye1558525119805.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2hsv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">bgr2hsv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id173">
<caption><span class="caption-text">Table RGB/BGR2HSV Parameter Description</span><a class="headerlink" href="#id173" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB/BGR input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>HSV output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB/BGR2HSV
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>1582</p></td>
<td><p>1274</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGB/BGR2HSV for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgb-bgr-to-hls">
<span id="rgb-to-hls"></span><h3>RGB/BGR to HLS<a class="headerlink" href="#rgb-bgr-to-hls" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">(rgb/bgr)2hls</span></code> function converts a 3-channel RGB image to HLS
color space.</div>
<div class="line"><img alt="image46" class="image" src="_images/ajz1558525683240.svg" /></div>
<div class="line"><img alt="image47" class="image" src="_images/wef1558525738589.svg" /></div>
<div class="line"><img alt="image48" class="image" src="_images/aut1558525773829.svg" /></div>
<div class="line"><img alt="image49" class="image" src="_images/scm1558525834241.svg" /></div>
<div class="line"><img alt="image50" class="image" src="_images/gjh1558525869079.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2hls</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2hls</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id174">
<caption><span class="caption-text">Table RGB/BGR2HLS Parameter Description</span><a class="headerlink" href="#id174" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB/BGR input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>HLS output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB/BGR2HLS
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>4366</p></td>
<td><p>3096</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of RGB/BGR2HLS for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ycrcb-to-rgb-bgr">
<span id="ycrcb-to-rgb"></span><h3>YCrCb to RGB/BGR<a class="headerlink" href="#ycrcb-to-rgb-bgr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ycrcb2(rgb/bgr)</span></code> function converts YCrCb color space to 3-channel
RGB/BGR image.</p>
<p>Where,</p>
<ul class="simple">
<li><p>R= Y+1.403*(Cr-delta)</p></li>
<li><p>G= Y-0.714*(Cr-delta)-0.344*(cb-delta)</p></li>
<li><p>B= Y+1.773+(Cb-delta)</p></li>
</ul>
<p><img alt="image51" class="image" src="_images/nnt1558524820358.svg" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">ycrcb2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">ycrcb2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id175">
<caption><span class="caption-text">Table YCrCb2RGB/BGR Parameter Description</span><a class="headerlink" href="#id175" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be a
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>YCrCb input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB/BGR output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of YCrCb2RGB/BGR
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>4</p></td>
<td><p>538</p></td>
<td><p>575</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of YCrCb2RGB/BGR for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hsv-to-rgb-bgr">
<span id="hsv-to-rgb"></span><h3>HSV to RGB/BGR<a class="headerlink" href="#hsv-to-rgb-bgr" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">hsv2(rgb/bgr)</span></code> function converts HSV color space to 3-channel
RGB/BGR image.</div>
<div class="line"><img alt="image52" class="image" src="_images/nwd1558525233086.svg" /></div>
<div class="line"><img alt="image53" class="image" src="_images/buu1558525298988.svg" /></div>
<div class="line"><img alt="image54" class="image" src="_images/jxw1558525421508.svg" /></div>
<div class="line"><img alt="image55" class="image" src="_images/iyx1558525466557.svg" /></div>
<div class="line"><img alt="image56" class="image" src="_images/yst1558525525323.svg" /></div>
<div class="line"><img alt="image57" class="image" src="_images/meo1558525562310.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">hsv2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">hsv2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id176">
<caption><span class="caption-text">Table HSV2RGB/BGR Parameter Description</span><a class="headerlink" href="#id176" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>HSV input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB/BGR output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of HSV2RGB/BGRR
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>1543</p></td>
<td><p>1006</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of HSV2RGB/BGR for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="nv12-nv21-to-rgb-bgr">
<span id="nv21-to-rgb"></span><h3>NV12/NV21 to RGB/ BGR<a class="headerlink" href="#nv12-nv21-to-rgb-bgr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv122rgb/nv122bgr/nv212rgb/nv212bgr</span></code> converts NV12 image format
to a 3-channel RGB/BGR image. The inputs to the function are separate Y
and UV planes. NV12 holds sub sampled data, Y plane is sampled at unit
rate, and 1 U and 1 V value each for every 2x2 Y values. To generate the
RGB data, each U and V value is duplicated (2x2) times.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="nv122rgb">
<h4>NV122RGB:<a class="headerlink" href="#nv122rgb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv122rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv122bgr">
<h4>NV122BGR:<a class="headerlink" href="#nv122bgr" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv122bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv212rgb">
<h4>NV212RGB:<a class="headerlink" href="#nv212rgb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv212rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv212bgr">
<h4>NV212BGR:<a class="headerlink" href="#nv212bgr" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv212bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src_uv</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id177">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id177" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit,unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>UV_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of NPC for N pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of Y Pixels to be processed per cycle.
Possible options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and
XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV Pixels to be processed per cycle.
Possible options are XF_NPPC1,XF_NPPC2 and XF_NPPC4.</p></td>
</tr>
<tr class="row-even"><td><p>src_y</p></td>
<td><p>Y input image of size(ROWS, COLS)</p></td>
</tr>
<tr class="row-odd"><td><p>src_uv</p></td>
<td><p>UV output image of size (ROWS/2, COLS/2).</p></td>
</tr>
<tr class="row-even"><td><p>_dst0</p></td>
<td><p>Output UV image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">NV12/NV21</span></code>
to <code class="docutils literal notranslate"><span class="pre">RGB/</span> <span class="pre">BGR</span></code> function in Normal mode (1 pixel), as generated in the
Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to
process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>339</p></td>
<td><p>289</p></td>
<td><p>76</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2018.3 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="nv12-to-nv21-nv21-to-nv12">
<span id="nv12-to-nv21-to-nv12"></span><h3>NV12 to NV21/NV21 to NV12<a class="headerlink" href="#nv12-to-nv21-nv21-to-nv12" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nv122nv21/nv212nv12</span></code> function converts a NV12 (YUV4:2:0) to NV21
(YUV4:2:0) or vice versa, where 8-bit Y plane followed by an interleaved
U/V plane with 2x2 sub-sampling.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="nv122nv21">
<h4>NV122NV21:<a class="headerlink" href="#nv122nv21" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">nv122nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">out_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">out_uv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv212nv12">
<h4>NV212NV12:<a class="headerlink" href="#nv212nv12" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv212nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">out_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">out_uv</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id178">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id178" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_Y</p></td>
<td><p>Input Y pixel type. Only 8-bit, unsigned, 1-channel
is supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_UV</p></td>
<td><p>Input UV pixel type. Only 8-bit, unsigned, 2-channel
is supported (XF_8UC2)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_Y</p></td>
<td><p>Number of Y pixels to be processed per cycle.
Possible options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and
XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_UV</p></td>
<td><p>Number of UV Pixels to be processed per cycle.
Possible options are XF_NPPC1,XF_NPPC2 and XF_NPPC4.</p></td>
</tr>
<tr class="row-even"><td><p>_y</p></td>
<td><p>Y input image</p></td>
</tr>
<tr class="row-odd"><td><p>_uv</p></td>
<td><p>UV input image</p></td>
</tr>
<tr class="row-even"><td><p>out_y</p></td>
<td><p>Y output image</p></td>
</tr>
<tr class="row-odd"><td><p>out_uv</p></td>
<td><p>UV output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of
NV122NV21/NV212NV12 function in Normal mode (1-Pixel), as generated in
the Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA
to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>258</p></td>
<td><p>161</p></td>
<td><p>61</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="nv12-nv21-to-uyvy-yuyv">
<span id="nv12-uyvy"></span><h3>NV12/NV21 to UYVY/YUYV<a class="headerlink" href="#nv12-nv21-to-uyvy-yuyv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NV12/NV21</span> <span class="pre">to</span> <span class="pre">UYVY/YUYV</span></code> function converts a NV12/NV21 (YUV4:2:0)
image to a single-channel YUYV/UYVY (YUV 4:2:2) image format. YUYV is a
sub-sampled format. YUYV/UYVY is represented in 16-bit values whereas,
RGB is represented in 24-bit values.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="nv122uyvy">
<h4>NV122UYVY:<a class="headerlink" href="#nv122uyvy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv122uyvy</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv122yuyv">
<h4>NV122YUYV:<a class="headerlink" href="#nv122yuyv" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv122yuyv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv212uyvy">
<h4>NV212UYVY:<a class="headerlink" href="#nv212uyvy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv212uyvy</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nv212yuyv">
<h4>NV212YUYV:<a class="headerlink" href="#nv212yuyv" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_Y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_UV</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">nv212yuyv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_Y</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_UV</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id179">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id179" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_Y</p></td>
<td><p>Input Y image pixel type. Only 8-bit, unsigned,
1-channel is supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_UV</p></td>
<td><p>Input UV image pixel type. Only 8-bit, unsigned,
2-channel is supported (XF_8UC2).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, unsigned, 1-channel
is supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of NPC.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_UV</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2 and XF_NPPC4.</p></td>
</tr>
<tr class="row-odd"><td><p>_y</p></td>
<td><p>Y input image</p></td>
</tr>
<tr class="row-even"><td><p>_uv</p></td>
<td><p>UV input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>UYVY/YUYV output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of
<code class="docutils literal notranslate"><span class="pre">NV12/NV21</span> <span class="pre">to</span> <span class="pre">UYVY/YUYV</span></code> function in Normal mode(1-Pixel), as
generated in the Vivado HLS 2019.1 tool for the Xilinx
xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>337</p></td>
<td><p>201</p></td>
<td><p>64</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="uyvy-yuyv-to-rgb-bgr">
<span id="uyvy-yuyv-to-rgb"></span><h3>UYVY/YUYV to RGB/BGR<a class="headerlink" href="#uyvy-yuyv-to-rgb-bgr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">yuyv2rgb</span></code>/<code class="docutils literal notranslate"><span class="pre">yuyv2bgr</span></code>/<code class="docutils literal notranslate"><span class="pre">uyvy2rgb</span></code>/<code class="docutils literal notranslate"><span class="pre">uyvy2bgr</span></code> function
converts a single-channel YUYV/UYVY (YUV 4:2:2) image format to a 3-
channel RGB/BGR image. YUYV/UYVY is a sub-sampled format, a set of
YUYV/UYVY values gives 2 RGB pixel values. YUYV/UYVY is represented in
16-bit values whereas, RGB/BGR is represented in 24-bit values.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="yuyv2rgb">
<h4>YUYV2RGB:<a class="headerlink" href="#yuyv2rgb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">yuyv2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="yuyv2bgr">
<h4>YUYV2BGR:<a class="headerlink" href="#yuyv2bgr" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">yuyv2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="uyvy2rgb">
<h4>UYVY2RGB<a class="headerlink" href="#uyvy2rgb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">uyvy2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="uyvy2bgr">
<h4>UYVY2BGR:<a class="headerlink" href="#uyvy2bgr" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">uyvy2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id180">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id180" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned,1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of NPC for N pixel mode.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of Y pixels to be processed per cycle.
Possible options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and
XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image of size(ROWS, COLS)</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image of size (ROWS, COLS).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">UYVY/YUYV</span></code>
to <code class="docutils literal notranslate"><span class="pre">RGB/BGR</span></code> function in Normal mode(1-Pixel), as generated in the
Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to
process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>6</p></td>
<td><p>444</p></td>
<td><p>486</p></td>
<td><p>109</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="uyvy-to-yuyv-yuyv-to-uyvy">
<span id="uyvy-to-yuyv-to-uyvy"></span><h3>UYVY to YUYV/ YUYV to UYVY<a class="headerlink" href="#uyvy-to-yuyv-yuyv-to-uyvy" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">yuyv2uyvy/uyvy2yuyv</span></code> function converts a YUYV (YUV4:2:2) to UYVY
(YUV4:2:2) or vice versa, where 8-bit Y plane followed by an interleaved
U/V plane with 2x2 sub sampling.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="uyvy2yuyv">
<h4>UYVY2YUYV:<a class="headerlink" href="#uyvy2yuyv" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">uyvy2yuyv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">uyvy</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">yuyv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="yuyv2uyvy">
<h4>YUYV2UYVY:<a class="headerlink" href="#yuyv2uyvy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">yuyv2uyvy</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">yuyv</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">uyvy</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id181">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id181" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Y pixel type. Only 16-bit, unsigned, 1-channel
is supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>yuyv</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>uyvy</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">UYVY</span></code> to
<code class="docutils literal notranslate"><span class="pre">YUYV/</span> <span class="pre">YUYV</span></code> to <code class="docutils literal notranslate"><span class="pre">UYVY</span></code> function in Normal mode (1 pixel), as
generated in the Vivado HLS 2019.1 tool for the Xilinx
xczu9eg-ffvb1156-2-i-es2 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>368</p></td>
<td><p>176</p></td>
<td><p>109</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="uyvy-yuyv-to-nv21">
<span id="id37"></span><h3>UYVY/YUYV to NV21<a class="headerlink" href="#uyvy-yuyv-to-nv21" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">UYVY/YUYV2NV21</span></code> function converts a single-channel YUYV/UYVY (YUV
4:2:2) image format to NV21 (YUV 4:2:0) format. YUYV/UYVY is a
sub-sampled format, 1 set of YUYV/UYVY value gives 2 Y values and 1 U
and V value each.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="uyvy2nv21">
<h4>UYVY2NV21:<a class="headerlink" href="#uyvy2nv21" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">uyvy2nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="yuyv2nv21">
<h4>YUYV2NV21:<a class="headerlink" href="#yuyv2nv21" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">yuyv2nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y_image</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv_image</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id182">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id182" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, unsigned,1-channel is
supported (XF_16UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output Y image pixel type. Only 8-bit, unsigned,
1-channel is supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output UV image pixel type. Only 8-bit, unsigned,
2-channel is supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of NPC.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_UV</p></td>
<td><p>Number of U, V Pixels to be processed per cycle;
Possible options are XF_NPPC1,XF_NPPC2 and XF_NPPC4.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_y_image</p></td>
<td><p>Y Output image</p></td>
</tr>
<tr class="row-odd"><td><p>_uv_image</p></td>
<td><p>UV Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">UYVY/YUYV</span></code>
to <code class="docutils literal notranslate"><span class="pre">NV21</span></code> function in Normal mode (1 pixel), as generated in the
Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to
process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>215</p></td>
<td><p>73</p></td>
<td><p>42</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="rgb-bgr-to-nv12-nv21">
<span id="id38"></span><h3>RGB/ BGR to NV12/NV21<a class="headerlink" href="#rgb-bgr-to-nv12-nv21" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rgb2nv12</span></code>/<code class="docutils literal notranslate"><span class="pre">bgr2nv12</span></code>/<code class="docutils literal notranslate"><span class="pre">rgb2nv21</span></code>/<code class="docutils literal notranslate"><span class="pre">bgr2nv21</span></code> converts a
3-channel RGB/BGR image to NV12/NV21 (4:2:0) format. The function
outputs Y plane and interleaved UV/VU plane separately. NV12/NV21 holds
the subsampled data, Y is sampled for every RGB/BGR pixel and U, V are
sampled once for 2 rows and 2 columns (2x2) pixels. UV/VU plane is of
(rows/2)*(columns/2) size as U and V values are interleaved.</p>
<p class="rubric">API Syntax</p>
<div class="section" id="rgb2nv12">
<h4>RGB2NV12<a class="headerlink" href="#rgb2nv12" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bgr2nv12">
<h4>BGR2NV12<a class="headerlink" href="#bgr2nv12" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2nv12</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="rgb2nv21">
<h4>RGB2NV21<a class="headerlink" href="#rgb2nv21" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bgr2nv21">
<h4>BGR2NV21<a class="headerlink" href="#bgr2nv21" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">Y_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">UV_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC_UV</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2nv21</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">Y_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_y</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">UV_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">COLS</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">NPC_UV</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_uv</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id183">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id183" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>Y_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>UV_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 2-channel is
supported (XF_8UC2).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of NPC for N pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of Pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC_UV</p></td>
<td><p>Number of Pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2 and XF_NPPC4</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB input image of size(ROWS,COLS)</p></td>
</tr>
<tr class="row-even"><td><p>_y</p></td>
<td><p>Output Y image of size (ROWS, COLS).</p></td>
</tr>
<tr class="row-odd"><td><p>_uv</p></td>
<td><p>Output UV image of size (ROWS/2, COLS/2).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">RGB/BGR</span></code>
to <code class="docutils literal notranslate"><span class="pre">NV12/NV21</span></code> function in Normal mode (1-Pixel), as generated in the
Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to
process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>413</p></td>
<td><p>279</p></td>
<td><p>66</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="bgr-to-rgb-rgb-to-bgr">
<span id="bgr-to-rgb-to-bgr"></span><h3>BGR to RGB / RGB to BGR<a class="headerlink" href="#bgr-to-rgb-rgb-to-bgr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">bgr2rgb/rgb2bgr</span></code> function converts a 3-channel BGR to RGB format
or RGB to BGR format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id184">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id184" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of Pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>BGR/RGB input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB/BGR output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of RGB to BGR/
BGR to RGB function in Normal mode (1-Pixel), as generated in the Vivado
HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>317</p></td>
<td><p>118</p></td>
<td><p>98</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rgb-bgr-to-uyvy-yuyv">
<span id="id39"></span><h3>RGB/BGR to UYVY/YUYV<a class="headerlink" href="#rgb-bgr-to-uyvy-yuyv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">RGB/BGR</span> <span class="pre">to</span> <span class="pre">UYVY/YUYV</span></code> function converts a 3- channel RGB/BGR
image to a single-channel YUYV/UYVY (YUV 4:2:2) image format. YUYV is a
sub-sampled format, 2 RGBA pixel gives set of YUYV/UYVY values.
YUYV/UYVY is represented in 16-bit values whereas, RGB is represented in
24-bit values</p>
<p class="rubric">API Syntax</p>
<div class="section" id="rgb-to-uyvy">
<h4>RGB to UYVY:<a class="headerlink" href="#rgb-to-uyvy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2uyvy</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="rgb-to-yuyv">
<h4>RGB to YUYV:<a class="headerlink" href="#rgb-to-yuyv" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">rgb2yuyv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bgr-to-uyvy">
<h4>BGR to UYVY:<a class="headerlink" href="#bgr-to-uyvy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2uyvy</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bgr-to-yuyv">
<h4>BGR to YUYV:<a class="headerlink" href="#bgr-to-yuyv" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">bgr2yuyv</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id185">
<caption><span class="caption-text">Table Parameter Description</span><a class="headerlink" href="#id185" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, unsigned, 1-channel
is supported (XF_16UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of NPC.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1,XF_NPPC2,XF_NPPC4 and XF_NPPC8..</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>RGB/BGR input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>UYVY/YUYV output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of <code class="docutils literal notranslate"><span class="pre">RGB/BGR</span></code>
to <code class="docutils literal notranslate"><span class="pre">UYVY/YUYV</span></code> function in normal mode(1-Pixel), as generated in the
Vivado HLS 2019.1 tool for the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>249</p></td>
<td><p>203</p></td>
<td><p>55</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in single
pixel configuration as generated using Vivado HLS 2019.1 tool for the
Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA to process a HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="xyz-to-rgb-bgr">
<span id="id40"></span><h3>XYZ to RGB/BGR<a class="headerlink" href="#xyz-to-rgb-bgr" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">xyz2rgb</span></code> function converts XYZ color space to 3-channel RGB
image.</div>
<div class="line"><img alt="image58" class="image" src="_images/uqp1558524343595.svg" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">xyz2rgb</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">xyz2bgr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id186">
<caption><span class="caption-text">Table XYZ2RGB/BGR Parameter Description</span><a class="headerlink" href="#id186" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 3-channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>XYZ input image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>RGB/BGR output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of XYZ2RGB/BGR
for different configurations, as generated in the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 32%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>639</p></td>
<td><p>401</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of XYZ2RGB/BGR for
different configurations, as generated using the Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1, to process a HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="color-correction-matrix">
<span id="colorcorrectionmatrix"></span><h2>Color correction matrix<a class="headerlink" href="#color-correction-matrix" title="Permalink to this headline">¶</a></h2>
<p>Color correction matrix algorithm converts the input image color format to output image color format using the colorcorrection matrix provided by the user (CCM_TYPE).</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">CCM_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">colorcorrectionmatrix</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">_src_mat</span><span class="p">,</span>
                           <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes template parameters and arguments of the function.</p>
<table class="docutils align-default" id="id187">
<caption><span class="caption-text">Table colorcorrectionmatrix correction Parameter Description</span><a class="headerlink" href="#id187" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CCM_TYPE</p></td>
<td><p>colorcorrection matrix.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8/10/12/16-bit unsigned, 3 channel are
supported (XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8/10/12/16-bit unsigned, 3 channel are
supported (XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options is XF_NPPC1, XF_NPPC2 AND so on</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations, generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id188">
<caption><span class="caption-text">Table colorcorrectionmatrix correction Resource Utilization Summary</span><a class="headerlink" href="#id188" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel-8U</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>283</p></td>
<td><p>254</p></td>
<td><p>73</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel-16U</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>353</p></td>
<td><p>239</p></td>
<td><p>75</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id189">
<caption><span class="caption-text">Table colorcorrectionmatrix correction Function Performance Estimate Summary</span><a class="headerlink" href="#id189" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency Estimate
<strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>3.6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="color-thresholding">
<span id="color-tresholding"></span><h2>Color Thresholding<a class="headerlink" href="#color-thresholding" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">colorthresholding</span></code> function compares the color space values of
the source image with low and high threshold values, and returns either
255 or 0 as the output.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAXCOLORS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
          <span class="kt">void</span> <span class="n">colorthresholding</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">low_thresh</span><span class="p">[</span><span class="n">MAXCOLORS</span><span class="o">*</span><span class="mi">3</span><span class="p">],</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">high_thresh</span><span class="p">[</span><span class="n">MAXCOLORS</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 3 channel is
supported (XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>MAXCOLORS</p></td>
<td><p>Maximum number of color values</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be a
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Only
XF_NPPC1 supported.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Thresholded image</p></td>
</tr>
<tr class="row-even"><td><p>low_thresh</p></td>
<td><p>Lowest threshold values for the colors</p></td>
</tr>
<tr class="row-odd"><td><p>high_thresh</p></td>
<td><p>Highest threshold values for the colors</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="compare">
<span id="id41"></span><h2>Compare<a class="headerlink" href="#compare" title="Permalink to this headline">¶</a></h2>
<p>The Compare function performs the per element comparison of pixels in
two corresponding images src1, src2 and stores the result in dst.</p>
<p>dst(x,y)=src1(x,y) CMP_OP src2(x,y)</p>
<p>CMP_OP – a flag specifies correspondence between the pixels.</p>
<ul class="simple">
<li><p>XF_CMP_EQ : src1 is equal to src2</p></li>
<li><p>XF_CMP_GT : src1 is greater than src2</p></li>
<li><p>XF_CMP_GE : src1 is greater than or equal to src2</p></li>
<li><p>XF_CMP_LT : src1 is less than src2</p></li>
<li><p>XF_CMP_LE : src1 is less than or equal to src2</p></li>
<li><p>XF_CMP_NE : src1 is unequal to src2</p></li>
</ul>
<p>If the comparison result is true, then the corresponding element of dst
is set to 255; else it is set to 0.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">CMP_OP</span><span class="p">,</span>  <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">compare</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id190">
<caption><span class="caption-text">Table Compare Parameter Description</span><a class="headerlink" href="#id190" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CMP_OP</p></td>
<td><p>The flag that specify the relation between the
elements needs to be checked</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-even"><td><p>_src2</p></td>
<td><p>Second input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Compare
XF_CMP_NE configuration in Resource optimized (8 pixels) mode and normal
mode as generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>87</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>38</p></td>
<td><p>84</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>16</p></td>
<td><p>20</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="compares">
<span id="id42"></span><h2>CompareS<a class="headerlink" href="#compares" title="Permalink to this headline">¶</a></h2>
<p>The CompareS function performs the comparison of a pixel in the input
image (src1) and the given scalar value scl, and stores the result in
dst.</p>
<p>dst(x,y)=src1(x,y) CMP_OP scalar</p>
<p>CMP_OP – a flag specifies correspondence between the pixel and the
scalar.</p>
<ul class="simple">
<li><p>XF_CMP_EQ : src1 is equal to scl</p></li>
<li><p>XF_CMP_GT : src1 is greater than scl</p></li>
<li><p>XF_CMP_GE : src1 is greater than or equal to scl</p></li>
<li><p>XF_CMP_LT : src1 is less than scl</p></li>
<li><p>XF_CMP_LE : src1 is less than or equal to scl</p></li>
<li><p>XF_CMP_NE : src1 is unequal to scl</p></li>
</ul>
<p>If the comparison result is true, then the corresponding element of dst
is set to 255, else it is set to 0.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">CMP_OP</span><span class="p">,</span>  <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">compareS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id191">
<caption><span class="caption-text">Table CompareS Parameter Description</span><a class="headerlink" href="#id191" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CMP_OP</p></td>
<td><p>The flag that specifying the relation between the
elements to be checked</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, the width should be a multiple
of N</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixels operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-even"><td><p>_scl</p></td>
<td><p>Input scalar value, the size should be number of
channels</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the CompareS
function with XF_CMP_NE configuration in Resource optimized (8 pixels)
mode and normal mode as generated using Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1 FPGA</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>93</p></td>
<td><p>93</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>39</p></td>
<td><p>68</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>21</p></td>
<td><p>28</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="convertscaleabs">
<span id="id43"></span><h2>convertScaleAbs<a class="headerlink" href="#convertscaleabs" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">convertScaleAbs</span></code> function converts an input image src with
optional linear transformation, save the result as image dst.</p>
<p>dst(x,y)= src1(x,y)*scale+shift</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">,</span><span class="kt">float</span> <span class="n">scale</span><span class="p">,</span> <span class="kt">float</span> <span class="n">shift</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id192">
<caption><span class="caption-text">Table . convertScaleAbs Parameter Description</span><a class="headerlink" href="#id192" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit, unsigned, 1 channel
is supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>scale</p></td>
<td><p>Scale factor</p></td>
</tr>
<tr class="row-odd"><td><p>shift</p></td>
<td><p>Delta/shift added to scaled value.</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
convertScaleAbs function in Resource optimized (8 pixel) mode and normal
mode as generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>38</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>949</p></td>
<td><p>1971</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>1052</p></td>
<td><p>1522</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>218</p></td>
<td><p>382</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image…</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="crop">
<span id="id44"></span><h2>Crop<a class="headerlink" href="#crop" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Crop</span></code> function extracts the region of interest (ROI) from the
input image.</p>
<p>P(X,Y) ≤ P(xi, yi) ≤ P(X’,Y’)</p>
<ul class="simple">
<li><p>P(X,Y) - Top left corner of ROI</p></li>
<li><p>P(X’,Y’) - Bottom Right of ROI</p></li>
</ul>
<div class="image figure align-default" id="jru1540968767246-image-o2b-c3b-yfb">
<img alt="" src="_images/cso1554997041637.png" />
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">ARCH_TYPE</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">crop</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">_dst_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Rect_</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id193">
<caption><span class="caption-text">Table Crop Parameter Description</span><a class="headerlink" href="#id193" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8 for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>ARCH_TYPE</p></td>
<td><p>Architecture type. 0 resolves to stream
implementation and 1 resolves to memory mapped
implementation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. NPC
should be power of 2.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output ROI image</p></td>
</tr>
<tr class="row-odd"><td><p>roi</p></td>
<td><p>ROI is a <code class="docutils literal notranslate"><span class="pre">xf::cv::Rect</span></code> object that consists of
top left corner of the rectangle along with the
height and width of the rectangle.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of crop function
in normal mode (NPC=1) for 3 ROIs (480x640, 100x200, 300x300) in memory mapped mode as
generated in the Vivado HLS 2019.1 tool for the Xilinx
xczu9eg-ffvb1156-2-i-es2 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>1163</p></td>
<td><p>2358</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>909</p></td>
<td><p>3140</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image for 3 ROIs (480x640, 100x200, 300x300).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>0.6</p></td>
</tr>
</tbody>
</table>
<div class="section" id="multiple-roi-extraction">
<h3>Multiple ROI Extraction<a class="headerlink" href="#multiple-roi-extraction" title="Permalink to this headline">¶</a></h3>
<p>You can call the <code class="docutils literal notranslate"><span class="pre">xf::cv::crop</span></code> function multiple times in accel.cpp.</p>
</div>
<div class="section" id="multiple-roi-extraction-example">
<h3>Multiple ROI Extraction Example<a class="headerlink" href="#multiple-roi-extraction-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">crop_accel</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">NPIX</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">NPIX</span><span class="o">&gt;</span> <span class="n">_dst</span><span class="p">[</span><span class="n">NUM_ROI</span><span class="p">],</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Rect_</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">roi</span><span class="p">[</span><span class="n">NUM_ROI</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">crop</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">NPIX</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_src</span><span class="p">,</span> <span class="n">_dst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">roi</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">crop</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">NPIX</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_src</span><span class="p">,</span> <span class="n">_dst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">roi</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">crop</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">NPIX</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_src</span><span class="p">,</span> <span class="n">_dst</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">roi</span><span class="p">[</span><span class="mi">2</span><span class="p">]);}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="custom-convolution">
<span id="id45"></span><h2>Custom Convolution<a class="headerlink" href="#custom-convolution" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">filter2D</span></code> function performs convolution over an image using a
user-defined kernel.</p>
<p>Convolution is a mathematical operation on two functions <em>f</em> and <em>g</em>,
producing a third function, The third function is typically viewed as a
modified version of one of the original functions, that gives the area
overlap between the two functions to an extent that one of the original
functions is translated.</p>
<p>The filter can be unity gain filter or a non-unity gain filter. The
filter must be of type XF_16SP. If the co-efficients are floating point,
it must be converted into the Qm.n and provided as the input as well as
the shift parameter has to be set with the ‘n’ value. Else, if the input
is not of floating point, the filter is provided directly and the shift
parameter is set to zero.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_WIDTH</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">filter2D</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">short</span> <span class="kt">int</span> <span class="n">filter</span><span class="p">[</span><span class="n">FILTER_HEIGHT</span><span class="o">*</span><span class="n">FILTER_WIDTH</span><span class="p">],</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_shift</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id194">
<caption><span class="caption-text">Table filter2D Parameter Description</span><a class="headerlink" href="#id194" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>FILTER_HEIGHT</p></td>
<td><p>Number of rows in the input filter</p></td>
</tr>
<tr class="row-even"><td><p>FILTER_WIDTH</p></td>
<td><p>Number of columns in the input filter</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit unsigned single and 3
channels (XF_8UC1, XF_8UC3) and 16-bit signed
single and 3 channels (XF_16SC1, XF_16SC3)
supported.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>filter</p></td>
<td><p>The input filter of any size, provided the
dimensions should be an odd number. The filter
co-efficients either a 16-bit value or a 16-bit
fixed point equivalent value.</p></td>
</tr>
<tr class="row-odd"><td><p>_shift</p></td>
<td><p>The filter must be of type XF_16SP. If the
co-efficients are floating point, it must be
converted into the Qm.n and provided as the input
as well as the shift parameter has to be set with
the ‘n’ value. Else, if the input is not of
floating point, the filter is provided directly
and the shift parameter is set to zero.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>1701</p></td>
<td><p>1161</p></td>
<td><p>269</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>25</p></td>
<td><p>3115</p></td>
<td><p>2144</p></td>
<td><p>524</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>8 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>6</p></td>
<td><p>72</p></td>
<td><p>2783</p></td>
<td><p>2768</p></td>
<td><p>638</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>10</p></td>
<td><p>216</p></td>
<td><p>3020</p></td>
<td><p>4443</p></td>
<td><p>1007</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3 Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 15%" />
<col style="width: 27%" />
<col style="width: 22%" />
<col style="width: 11%" />
<col style="width: 4%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>18</p></td>
<td><p>27</p></td>
<td><p>886</p></td>
<td><p>801</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>30</p></td>
<td><p>75</p></td>
<td><p>1793</p></td>
<td><p>1445</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating
Frequency
(MHz)</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>3x3</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>5x5</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>3x3</p></td>
<td><p>1.86</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>5x5</p></td>
<td><p>1.86</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="delay">
<span id="id46"></span><h2>Delay<a class="headerlink" href="#delay" title="Permalink to this headline">¶</a></h2>
<p>In image processing pipelines, it is possible that the inputs to a
function with FIFO interfaces are not synchronized. That is, the first
data packet for first input might arrive a finite number of clock cycles
after the first data packet of the second input. If the function has
FIFOs at its interface with insufficient depth, this causes the whole
design to stall on hardware. To synchronize the inputs, we provide this
function to delay the input packet that arrives early, by a finite
number of clock cycles.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">MAXDELAY</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span> <span class="o">&gt;</span>
          <span class="kt">void</span> <span class="n">delayMat</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8 pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>MAXDELAY</p></td>
<td><p>Maximum delay that the function is to be instantiated
for.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="demosaicing">
<span id="id47"></span><h2>Demosaicing<a class="headerlink" href="#demosaicing" title="Permalink to this headline">¶</a></h2>
<p>The Demosaicing function converts a single plane Bayer pattern output,
from the digital camera sensors to a color image. This function
implements an improved bi-linear interpolation technique proposed by
Malvar, He, and Cutler.</p>
<div class="image figure align-default" id="wrr1540968923467-image-xg3-zjb-yfb">
<img alt="" src="_images/rco1554997039974.png" />
</div>
<p>The above figure shows the Bayer mosaic for color image capture in
single-CCD digital cameras.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BFORMAT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">demosaicing</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id195">
<caption><span class="caption-text">Table Demosaicing Parameter Description</span><a class="headerlink" href="#id195" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BFORMAT</p></td>
<td><p>Input Bayer pattern. XF_BAYER_BG, XF_BAYER_GB,
XF_BAYER_GR, and XF_BAYER_RG are the supported
values.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned,1 channel
(XF_8UC1) and 16-bit, unsigned, 1
channel (XF_16UC1) are supported.</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit, unsigned, 4 channel
(XF_8UC4) and 16-bit, unsigned, 4 channel (XF_16UC4)
are supported.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed. Must
be multiple of 8, in case of 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; single
pixel parallelism (XF_NPPC1), two-pixel parallelism
(XF_NPPC2) and four-pixel parallelism (XF_NPPC4) are
supported. XF_NPPC4 is not supported with XF_16UC1
pixel type.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p>. rubric:: Resource Utilization</p>
<p>The following table below shows the resource utilization of the
Demosaicing function, generated using Vivado HLS 2019.1 version tool for
the Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>8</p></td>
<td><p>0</p></td>
<td><p>1906</p></td>
<td><p>1915</p></td>
<td><p>412</p></td>
</tr>
<tr class="row-even"><td><p>2 Pixel</p></td>
<td><p>300</p></td>
<td><p>8</p></td>
<td><p>0</p></td>
<td><p>2876</p></td>
<td><p>3209</p></td>
<td><p>627</p></td>
</tr>
<tr class="row-odd"><td><p>4 Pixel</p></td>
<td><p>300</p></td>
<td><p>8</p></td>
<td><p>0</p></td>
<td><p>2950</p></td>
<td><p>3222</p></td>
<td><p>660</p></td>
</tr>
</tbody>
</table>
<p>The following table shows the resource utilization of the Demosaicing
function, generated using Vivado HLS 2019.1 version tool for the
xczu7ev-ffvc1156-2-e FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="6"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>URAM</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1366</p></td>
<td><p>1399</p></td>
<td><p>412</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table shows the performance in different configurations,
generated using Vivado HLS 2019.1 tool for Xczu9eg-ffvb1156-1-i-es1 to
process a 4K (3840x2160) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>27.82</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel operation (300 MHz)</p></td>
<td><p>13.9</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>4 pixel operation</p>
<p>(300 MHz, 8-bit image only)</p>
</td>
<td rowspan="2"><p>6.95</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="section" id="dilate">
<span id="id48"></span><h2>Dilate<a class="headerlink" href="#dilate" title="Permalink to this headline">¶</a></h2>
<p>During a dilation operation, the current pixel intensity is replaced by
the maximum value of the intensity in a nxn neighborhood of the current
pixel.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image59" class="image" src="_images/cfh1554997085905.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_SHAPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ITERATIONS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">dilate</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_kernel</span><span class="p">[</span><span class="n">K_ROWS</span><span class="o">*</span><span class="n">K_COLS</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id196">
<caption><span class="caption-text">Table dilate Parameter Description</span><a class="headerlink" href="#id196" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>K_SHAPE</p></td>
<td><p>Shape of the kernel . The supported kernel shapes
are RECT, CROSS, and ELLIPSE.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>K_ROWS</p></td>
<td><p>Height of the kernel.</p></td>
</tr>
<tr class="row-odd"><td><p>K_COLS</p></td>
<td><p>Width of the kernel.</p></td>
</tr>
<tr class="row-even"><td><p>ITERATIONS</p></td>
<td><p>Number of times the dilation is applied. Currently
supporting for Rectangular shape kernel element.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>_kernel</p></td>
<td><p>Dilation kernel of size K_ROWS * K_COLS.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Dilation
function with rectangle shape structuring element in 1 pixel operation
and 8 pixel operation, generated using Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1 FPGA for HD (1080X1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>411</p></td>
<td><p>657</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>392</p></td>
<td><p>1249</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>96</p></td>
<td><p>255</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the resource utilization of the Dilation
function with rectangle shape structuring element in 1 pixel operation,
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA for 4K 3channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>983</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>745</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>186</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes a performance estimate of the Dilation
function for Normal Operation (1 pixel) and Resource Optimized (8 pixel)
configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 28%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min Latency (ms)</p></th>
<th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>7.0</p></td>
<td><p>7.0</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.87</p></td>
<td><p>1.87</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="distance-transform-feature-matcher">
<span id="distance-transform"></span><h2>Distance Transform Feature Matcher<a class="headerlink" href="#distance-transform-feature-matcher" title="Permalink to this headline">¶</a></h2>
<p>The distance transform is an operator normally only applied to binary
images, where in this case the image must be coded as zero and non-zero
pixels as a grayscale image. The result of the transform is a graylevel
image that looks similar to the input image, except that the graylevel
intensities of points inside foreground regions are changed to show the
distance to the closest boundary from each point.</p>
<p>This Xilinx implementation applies 3x3 mask, of distance type DIST_L2
(Euclidean distance), with horizontal/vertical shift cost, a = 0.955, and
diagonal shift cost b = 1.3693.</p>
<p>Computing the distance takes two passes, forward and backward. During the
forward pass, forward mask is applied, and while the backward pass the
backward mask is applied over the forward pass data.
In this implementation, it is required to pass a cache memory for the
kernel to interact (write while forward pass, read while backward pass).
The cache memory must be of image dimensions and of type ap_uint&lt;32&gt;.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">IN_PTR</span><span class="p">,</span> <span class="kt">int</span> <span class="n">FW_PTR</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">USE_URAM</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">distanceTransform</span><span class="p">(</span><span class="n">ap_uint</span><span class="o">&lt;</span><span class="n">IN_PTR</span><span class="o">&gt;*</span> <span class="n">_src</span><span class="p">,</span>
                       <span class="kt">float</span><span class="o">*</span> <span class="n">_dst</span><span class="p">,</span> <span class="n">ap_uint</span><span class="o">&lt;</span><span class="n">FW_PTR</span><span class="o">&gt;*</span> <span class="n">_fw_pass</span><span class="p">,</span>
                       <span class="kt">int</span> <span class="n">rows</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes template paramters and arguments of the function.</p>
<table class="docutils align-default" id="id197">
<caption><span class="caption-text">Table distance-transform Parameter Description</span><a class="headerlink" href="#id197" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IN_PTR</p></td>
<td><p>Input pointer width must be ‘8’.</p></td>
</tr>
<tr class="row-odd"><td><p>FW_PTR</p></td>
<td><p>Forward pass data pointer width must be ‘32’.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum number of rows of the input image that the
hardware kernel must be built for.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum number of columns of the input image that
the hardware kernel must be built for.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Default is ‘0’. Can be set to ‘1’, if the device has
URAM support.</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Grayscale input image pointer, of ap_uint&lt;8&gt;* type.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>The distance image pointer,of type float*.</p></td>
</tr>
<tr class="row-odd"><td><p>_fw_pass</p></td>
<td><p>Forward pass pointer, of type ap_uint&lt;32&gt;. This is
used as an intermediary cache, between forward and
backward passes.</p></td>
</tr>
<tr class="row-even"><td><p>rows</p></td>
<td><p>Number of rows in the input image, must be less than
ROWS.</p></td>
</tr>
<tr class="row-odd"><td><p>cols</p></td>
<td><p>Number of cols in the input image, must be less than
COLS.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using Vitis 2020.2 tool, to process a 4K image.</p>
<table class="docutils align-default" id="id198">
<caption><span class="caption-text">Table distance-transform Resource Utilization Summary</span><a class="headerlink" href="#id198" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>default</p></td>
<td><p>300</p></td>
<td><p>22</p></td>
<td><p>0</p></td>
<td><p>5129</p></td>
<td><p>7444</p></td>
<td><p>1757</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vitis 2020.2 tool, to process a 4K image.</p>
<table class="docutils align-default" id="id199">
<caption><span class="caption-text">Table distance-transform Function Performance Estimate Summary</span><a class="headerlink" href="#id199" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency Estimate
<strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>default</p></td>
<td><p>200</p></td>
<td><p>86.249</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="duplicate">
<span id="id49"></span><h2>Duplicate<a class="headerlink" href="#duplicate" title="Permalink to this headline">¶</a></h2>
<p>When various functions in a pipeline are implemented by a programmable
logic, FIFOs are instantiated between two functions for dataflow
processing. When the output from one function is consumed by two
functions in a pipeline, the FIFOs need to be duplicated. This function
facilitates the duplication process of the FIFOs.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
          <span class="kt">void</span> <span class="n">duplicateMat</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst1</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Paramete
r</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8 pixel
operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst1</p></td>
<td><p>Duplicate output for _src</p></td>
</tr>
<tr class="row-even"><td><p>_dst2</p></td>
<td><p>Duplicate output for _src</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="erode">
<span id="id50"></span><h2>Erode<a class="headerlink" href="#erode" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">erode</span></code> function finds the minimum pixel intensity in the NXN
neighborhood of a pixel and replaces the pixel intensity with the
minimum value.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image60" class="image" src="_images/qzf1554997363793.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_SHAPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">K_COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ITERATIONS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">erode</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_kernel</span><span class="p">[</span><span class="n">K_ROWS</span><span class="o">*</span><span class="n">K_COLS</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id200">
<caption><span class="caption-text">Table erode Parameter Description</span><a class="headerlink" href="#id200" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>Border type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned,
1 and 3 channels are supported (XF_8UC1 and
XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>K_SHAPE</p></td>
<td><p>Shape of the kernel . The supported kernel shapes
are RECT,CROSS and ELLIPSE.</p></td>
</tr>
<tr class="row-odd"><td><p>K_ROWS</p></td>
<td><p>Height of the kernel.</p></td>
</tr>
<tr class="row-even"><td><p>K_COLS</p></td>
<td><p>Width of the kernel.</p></td>
</tr>
<tr class="row-odd"><td><p>ITERATIONS</p></td>
<td><p>Number of times the erosion is applied.Currently
supporting for Rectangular shape kernel element.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>_kernel</p></td>
<td><p>Erosion kernel of size K_ROWS * K_COLS.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Erosion
function with rectangular shape structuring element generated using
Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA,for
FullHD image(1080x1920).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>411</p></td>
<td><p>657</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>392</p></td>
<td><p>1249</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>96</p></td>
<td><p>255</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the Erosion
function with rectangular shape structuring element generated using
Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA,for
4K image with 3channels.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>983</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>3745</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>186</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the Erosion
function for Normal Operation (1 pixel) and Resource Optimized (8 pixel)
configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 28%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min Latency (ms)</p></th>
<th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>7.0</p></td>
<td><p>7.0</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.85</p></td>
<td><p>1.85</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fast-corner-detection">
<span id="id51"></span><h2>FAST Corner Detection<a class="headerlink" href="#fast-corner-detection" title="Permalink to this headline">¶</a></h2>
<p>Features from accelerated segment test (FAST) is a corner detection
algorithm, that is faster than most of the other feature detectors.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fast</span></code> function picks up a pixel in the image and compares the
intensity of 16 pixels in its neighborhood on a circle, called the
Bresenham’s circle. If the intensity of 9 contiguous pixels is found to
be either more than or less than that of the candidate pixel by a given
threshold, then the pixel is declared as a corner. Once the corners are
detected, the non-maximal suppression is applied to remove the weaker
corners.</p>
<p>This function can be used for both still images and videos. The corners
are marked in the image. If the corner is found in a particular
location, that location is marked with 255, otherwise it is zero.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">NMS</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">fast</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_threshold</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id201">
<caption><span class="caption-text">Table fast Parameter Description</span><a class="headerlink" href="#id201" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NMS</p></td>
<td><p>If NMS == 1, non-maximum suppression is applied to
detected corners (keypoints). The value should be 0 or
1.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input image (must be a multiple of 8,
for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image. The corners are marked in the image.</p></td>
</tr>
<tr class="row-odd"><td><p>_threshol
d</p></td>
<td><p>Threshold on the intensity difference between the
center pixel and its neighbors. Usually it is taken
around 20.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel
for different configurations, generated using Vivado HLS 2019.1 for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image with NMS.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>10</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>2695</p></td>
<td><p>7310</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>3792</p></td>
<td><p>20956</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>769</p></td>
<td><p>3519</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of kernel for different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image
with non-maximum suppression (NMS).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating
Frequency
(MHz)</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>3x3</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>3x3</p></td>
<td><p>1.86</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gaincontrol">
<span id="id52"></span><h2>Gaincontrol<a class="headerlink" href="#gaincontrol" title="Permalink to this headline">¶</a></h2>
<p>The gain control modules improve the overall brightness of the input image. In this module, applying a multiplicative gain (weight) for red and blue channel of the input bayerized image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">BFORMAT</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">gaincontrol</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BFORMAT</p></td>
<td><p>Input Bayer pattern.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input and Output Pixel Type.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image (Must be multiple of NPC)</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (Must be multiple of NPC)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of Pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>Src1</p></td>
<td><p>Input Bayer image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output Bayer image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 24%" />
<col style="width: 26%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Utilization Estimate</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>SLICE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>233</p></td>
<td><p>95</p></td>
<td><p>59</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>235</p></td>
<td><p>95</p></td>
<td><p>59</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1, to process a 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>27.7</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>14.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gammacorrection">
<span id="id53"></span><h2>Gammacorrection<a class="headerlink" href="#gammacorrection" title="Permalink to this headline">¶</a></h2>
<p>The gamma correction modules improves the overall brightness of image. The gamma loouptable is generated using the gamma value and with following equation.</p>
<p><img alt="image162" class="image" src="_images/gammaeq1.png" /></p>
<p><img alt="image163" class="image" src="_images/gammaeq2.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span><span class="kt">void</span> <span class="n">gammacorrection</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">dst</span><span class="p">,</span><span class="kt">float</span> <span class="n">gammaval</span><span class="p">)</span>
</pre></div>
</div>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type.</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output Pixel Type.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image (Must be multiple of NPC)</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (Must be multiple of NPC)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of Pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>Gammaval</p></td>
<td><p>Input gamma value for brightness increase.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in different configurations, generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process a 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 25%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Utilization Estimate</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>13</p></td>
<td><p>31</p></td>
<td><p>4261</p></td>
<td><p>3213</p></td>
<td><p>1295</p></td>
</tr>
<tr class="row-even"><td><p>4 pixel</p></td>
<td><p>300</p></td>
<td><p>22</p></td>
<td><p>32</p></td>
<td><p>4297</p></td>
<td><p>3232</p></td>
<td><p>1261</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vivado HLS 2019.2 tool for the Xilinx xc7vx485t-ffg1157-1 FPGA, to process a 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>27.9</p></td>
</tr>
<tr class="row-even"><td><p>4 pixel</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gaussian-filter">
<span id="id54"></span><h2>Gaussian Filter<a class="headerlink" href="#gaussian-filter" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">GaussianBlur</span></code> function applies Gaussian blur on the input image.
Gaussian filtering is done by convolving each point in the input image
with a Gaussian kernel.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image61" class="image" src="_images/exd1554997000495.png" /></div>
</div>
<p>Where <img alt="image62" class="image" src="_images/rmc1554997017054.png" />,<img alt="image63" class="image" src="_images/ccf1554997333232.png" /> are the mean values and <img alt="image64" class="image" src="_images/bix1554997001180.png" />, <img alt="image65" class="image" src="_images/veg1554997336651.png" />
are the variances in x and y directions respectively. In the
GaussianBlur function, values of <img alt="image66" class="image" src="_images/rmc1554997017054.png" />, <img alt="image67" class="image" src="_images/ccf1554997333232.png" /> are considered as
zeroes and the values of <img alt="image68" class="image" src="_images/bix1554997001180.png" />, <img alt="image69" class="image" src="_images/veg1554997336651.png" /> are equal.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTER_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span>  <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">GaussianBlur</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">,</span> <span class="kt">float</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id202">
<caption><span class="caption-text">Table . GaussianBlur Parameter Description</span><a class="headerlink" href="#id202" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_SIZE</p></td>
<td><p>Filter size. Filter size of 3 (XF_FILTER_3X3), 5
(XF_FILTER_5X5) and 7 (XF_FILTER_7X7) are
supported.</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>Border type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned,
1 and 3 channels are supported (XF_8UC1 and
XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible values are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>Standard deviation of Gaussian filter</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Gaussian
Filter in different configurations, generated using Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to progress a
grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>3</p></td>
<td><p>17</p></td>
<td><p>3641</p></td>
<td><p>2791</p></td>
<td><p>610</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>27</p></td>
<td><p>4461</p></td>
<td><p>3544</p></td>
<td><p>764</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>250</p></td>
<td><p>7</p></td>
<td><p>35</p></td>
<td><p>4770</p></td>
<td><p>4201</p></td>
<td><p>894</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>8 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>6</p></td>
<td><p>52</p></td>
<td><p>3939</p></td>
<td><p>3784</p></td>
<td><p>814</p></td>
</tr>
<tr class="row-odd"><td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>10</p></td>
<td><p>111</p></td>
<td><p>5688</p></td>
<td><p>5639</p></td>
<td><p>1133</p></td>
</tr>
<tr class="row-even"><td><p>7x7</p></td>
<td><p>150</p></td>
<td><p>14</p></td>
<td><p>175</p></td>
<td><p>7594</p></td>
<td><p>7278</p></td>
<td><p>1518</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the Gaussian
Filter in different configurations, generated using Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to progress a 4K 3
Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 28%" />
<col style="width: 23%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>18</p></td>
<td><p>33</p></td>
<td><p>4835</p></td>
<td><p>3742</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>30</p></td>
<td><p>51</p></td>
<td><p>5755</p></td>
<td><p>3994</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>42</p></td>
<td><p>135</p></td>
<td><p>8086</p></td>
<td><p>5422</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the Gaussian
Filter in different configurations, as generated using Vivado HLS 2019.1
tool for Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 28%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p>1 pixel operation (300 MHz)</p></td>
<td><p>3x3</p></td>
<td><p>7.01</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>7.03</p></td>
</tr>
<tr class="row-odd"><td><p>7x7</p></td>
<td><p>7.06</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>8 pixel operation (150 MHz)</p></td>
<td><p>3x3</p></td>
<td><p>1.6</p></td>
</tr>
<tr class="row-odd"><td><p>5x5</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-even"><td><p>7x7</p></td>
<td><p>1.74</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gradient-magnitude">
<span id="id55"></span><h2>Gradient Magnitude<a class="headerlink" href="#gradient-magnitude" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">magnitude</span></code> function computes the magnitude for the images. The
input images are x-gradient and y-gradient images of type 16S. The
output image is of same type as the input image.</p>
<p>For L1NORM normalization, the magnitude computed image is the pixel-wise
added image of absolute of x-gradient and y-gradient, as shown below:.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image70" class="image" src="_images/uvl1554997087752.png" /></div>
</div>
<p>For L2NORM normalization, the magnitude computed image is as follows:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image71" class="image" src="_images/uap1554997234868.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">NORM_TYPE</span> <span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_matx</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_maty</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id203">
<caption><span class="caption-text">Table . magnitude Parameter Description</span><a class="headerlink" href="#id203" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NORM_TYPE</p></td>
<td><p>Normalization type can be either L1 or L2 norm. Values
are XF_L1NORM or XF_L2NORM</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, signed, 1 channel is
supported (XF_16SC1)</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, signed,1 channel is
supported (XF_16SC1)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
values are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_matx</p></td>
<td><p>First input, x-gradient image.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_maty</p></td>
<td><p>Second input, y-gradient image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output, magnitude computed image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image and for L2 normalization.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>2</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>707</p></td>
<td><p>2002</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>774</p></td>
<td><p>3666</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>172</p></td>
<td><p>737</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image and for L2 normalization.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gradient-phase">
<span id="id56"></span><h2>Gradient Phase<a class="headerlink" href="#gradient-phase" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">phase</span></code> function computes the polar angles of two images. The
input images are x-gradient and y-gradient images of type 16S. The
output image is of same type as the input image.</p>
<p>For radians:</p>
<p><img alt="image72" class="image" src="_images/qrq1554997298036.png" /></p>
<p>For degrees:</p>
<p><img alt="image73" class="image" src="_images/tnl1554997117556.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">RET_TYPE</span> <span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span> <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">phase</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_matx</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_maty</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id204">
<caption><span class="caption-text">Table . phase Parameter Description</span><a class="headerlink" href="#id204" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RET_TYPE</p></td>
<td><p>Output format can be either in radians or degrees.
Options are XF_RADIANS or XF_DEGREES.</p>
<ul class="simple">
<li><p>If the XF_RADIANS option is selected, phase API
will return result in Q4.12 format. The output
range is (0, 2 pi).</p></li>
<li><p>If the XF_DEGREES option is selected, xFphaseAPI
will return result in Q10.6 degrees and output
range is (0, 360).</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 16-bit, signed, 1 channel is
supported (XF_16SC1).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 16-bit, signed, 1 channel is
supported (XF_16SC1)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_matx</p></td>
<td><p>First input, x-gradient image.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_maty</p></td>
<td><p>Second input, y-gradient image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output, phase computed image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>6</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>6</p></td>
<td><p>19</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>873</p></td>
<td><p>2396</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>753</p></td>
<td><p>3895</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>187</p></td>
<td><p>832</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default" id="id205">
<caption><span class="caption-text">Table . phase Function Performance Estimate Summary</span><a class="headerlink" href="#id205" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 24%" />
<col style="width: 41%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency (MHz)</p></th>
<th class="head"><p>Latency Estimate (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>In phase implementation, the output is returned in a fixed point format.
If XF_RADIANS option is selected, phase API will return result in Q4.12
format. The output range is (0, 2 pi). If XF_DEGREES option is selected,
phase API will return result in Q10.6 degrees and output range is (0,
360).</p>
</div>
<div class="section" id="harris-corner-detection">
<span id="id57"></span><h2>Harris Corner Detection<a class="headerlink" href="#harris-corner-detection" title="Permalink to this headline">¶</a></h2>
<p>In order to understand Harris Corner Detection, let us consider a
grayscale image. Sweep a window <code class="docutils literal notranslate"><span class="pre">w(x,y)</span></code> (with displacements <code class="docutils literal notranslate"><span class="pre">u</span></code> in
the x-direction and <code class="docutils literal notranslate"><span class="pre">v</span></code> in the y-direction), <code class="docutils literal notranslate"><span class="pre">I</span></code> calculates the
variation of intensity <code class="docutils literal notranslate"><span class="pre">w(x,y)</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image74" class="image" src="_images/ipf1554996967154.png" /></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">w(x,y)</span></code> is the window position at (x,y)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">I(x,y)</span></code> is the intensity at (x,y)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">I(x+u,y+v)</span></code> is the intensity at the moved window <code class="docutils literal notranslate"><span class="pre">(x+u,y+v)</span></code>.</p></li>
</ul>
<p>Since we are looking for windows with corners, we are looking for
windows with a large variation in intensity. Hence, we have to maximize
the equation above, specifically the term:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image75" class="image" src="_images/exk1554997318317.png" /></div>
</div>
<p>Using Taylor expansion:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image76" class="image" src="_images/bhh1554996965563.png" /></div>
</div>
<p>Expanding the equation and cancelling <code class="docutils literal notranslate"><span class="pre">I(x,y)</span></code> with <code class="docutils literal notranslate"><span class="pre">-I(x,y)</span></code>:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image77" class="image" src="_images/boq1554997339376.png" /></div>
</div>
<p>The above equation can be expressed in a matrix form as:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image78" class="image" src="_images/ndd1554997350908.png" /></div>
</div>
<p>So, our equation is now:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image79" class="image" src="_images/ovs1554997046797.png" /></div>
</div>
<p>A score is calculated for each window, to determine if it can possibly
contain a corner:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image80" class="image" src="_images/xhm1554997049905.png" /></div>
<div class="line">Where,</div>
</div>
<ul class="simple">
<li><p><img alt="image81" class="image" src="_images/lcq1554996986702.png" /></p></li>
<li><p><img alt="image82" class="image" src="_images/evu1554997253027.png" /></p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="section" id="non-maximum-suppression">
<h3>Non-Maximum Suppression:<a class="headerlink" href="#non-maximum-suppression" title="Permalink to this headline">¶</a></h3>
<p>In non-maximum suppression (NMS) if radius = 1, then the bounding box is
2*r+1 = 3.</p>
<p>In this case, consider a 3x3 neighborhood across the center pixel. If
the center pixel is greater than the surrounding pixel, then it is
considered a corner. The comparison is made with the surrounding pixels,
which are within the radius.</p>
<p>Radius = 1</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>x-1, y-1</p></td>
<td><p>x-1, y</p></td>
<td><p>x-1, y+1</p></td>
</tr>
<tr class="row-even"><td><p>x, y-1</p></td>
<td><p>x, y</p></td>
<td><p>x, y+1</p></td>
</tr>
<tr class="row-odd"><td><p>x+1, y-1</p></td>
<td><p>x+1, y</p></td>
<td><p>x+1, y+1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="threshold">
<h3>Threshold:<a class="headerlink" href="#threshold" title="Permalink to this headline">¶</a></h3>
<p>A threshold=442, 3109 and 566 is used for 3x3, 5x5, and 7x7 filters
respectively. This threshold is verified over 40 sets of images. The
threshold can be varied, based on the application. The corners are
marked in the output image. If the corner is found in a particular
location, that location is marked with 255, otherwise it is zero.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTERSIZE</span><span class="p">,</span><span class="kt">int</span> <span class="n">BLOCKWIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NMSRADIUS</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">cornerHarris</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">,</span><span class="kt">uint16_t</span> <span class="n">threshold</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id206">
<caption><span class="caption-text">Table . cornerHarris Parameter Description</span><a class="headerlink" href="#id206" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTERSIZE</p></td>
<td><p>Size of the Sobel filter. 3, 5, and 7 supported.</p></td>
</tr>
<tr class="row-odd"><td><p>BLOCKWIDTH</p></td>
<td><p>Size of the box filter. 3, 5, and 7 supported.</p></td>
</tr>
<tr class="row-even"><td><p>NMSRADIUS</p></td>
<td><p>Radius considered for non-maximum suppression. Values
supported are 1 and 2.</p></td>
</tr>
<tr class="row-odd"><td><p>TYPE</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input image (must be multiple of 8,
for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>USE_URAM</p></td>
<td><p>Enable to map some storage structures to URAM</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image.</p></td>
</tr>
<tr class="row-even"><td><p>threshold</p></td>
<td><p>Threshold applied to the corner measure.</p></td>
</tr>
<tr class="row-odd"><td><p>k</p></td>
<td><p>Harris detector parameter</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Harris
corner detection in different configurations, generated using Vivado HLS
2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a
grayscale HD (1080x1920) image.</p>
<p>The following table summarizes the resource utilization for Sobel Filter
= 3, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>33</p></td>
<td><p>66</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>3254</p></td>
<td><p>9330</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>3522</p></td>
<td><p>13222</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>731</p></td>
<td><p>2568</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>45</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>5455</p></td>
<td><p>12459</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>5695</p></td>
<td><p>24594</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1132</p></td>
<td><p>4498</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>57</p></td>
<td><p>114</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>8783</p></td>
<td><p>16593</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>9157</p></td>
<td><p>39813</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1757</p></td>
<td><p>6809</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>35</p></td>
<td><p>70</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>4656</p></td>
<td><p>11659</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>4681</p></td>
<td><p>17394</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1005</p></td>
<td><p>3277</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>47</p></td>
<td><p>94</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>6019</p></td>
<td><p>14776</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>6337</p></td>
<td><p>28795</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1353</p></td>
<td><p>5102</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>59</p></td>
<td><p>118</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>9388</p></td>
<td><p>18913</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>9414</p></td>
<td><p>43070</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1947</p></td>
<td><p>7508</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>37</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>6002</p></td>
<td><p>13880</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>6337</p></td>
<td><p>25573</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1327</p></td>
<td><p>4868</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>49</p></td>
<td><p>98</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>7410</p></td>
<td><p>17049</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>8076</p></td>
<td><p>36509</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1627</p></td>
<td><p>6518</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>61</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>10714</p></td>
<td><p>21137</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>11500</p></td>
<td><p>51331</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>2261</p></td>
<td><p>8863</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>41</p></td>
<td><p>82</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>5519</p></td>
<td><p>10714</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>5094</p></td>
<td><p>16930</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1076</p></td>
<td><p>3127</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>53</p></td>
<td><p>106</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>6798</p></td>
<td><p>13844</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>6866</p></td>
<td><p>28286</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1383</p></td>
<td><p>4965</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>65</p></td>
<td><p>130</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>10137</p></td>
<td><p>17977</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>10366</p></td>
<td><p>43589</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1940</p></td>
<td><p>7440</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>43</p></td>
<td><p>86</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>5957</p></td>
<td><p>12930</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>5987</p></td>
<td><p>21187</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1244</p></td>
<td><p>3922</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>55</p></td>
<td><p>110</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>5442</p></td>
<td><p>16053</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>6561</p></td>
<td><p>32377</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1374</p></td>
<td><p>5871</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>67</p></td>
<td><p>134</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>10673</p></td>
<td><p>20190</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>10793</p></td>
<td><p>46785</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>2260</p></td>
<td><p>8013</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>45</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>7341</p></td>
<td><p>15161</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>7631</p></td>
<td><p>29185</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1557</p></td>
<td><p>5425</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>57</p></td>
<td><p>114</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>8763</p></td>
<td><p>18330</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>9368</p></td>
<td><p>40116</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>1857</p></td>
<td><p>7362</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>69</p></td>
<td><p>138</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>12078</p></td>
<td><p>22414</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>12831</p></td>
<td><p>54652</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>2499</p></td>
<td><p>9628</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization with URAM enable</p>
<p>This section summarizes the resource utilization of the Harris corner detection in different configurations, generated using Vivado HLS 2019.1 version tool for the xczu7ev-ffvc1156-2-e FPGA, to process a grayscale 4K (3840X2160) image.</p>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>5306</p></td>
<td><p>11846</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>3696</p></td>
<td><p>13846</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>7625</p></td>
<td><p>13899</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>5596</p></td>
<td><p>27136</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>12563</p></td>
<td><p>19919</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>8816</p></td>
<td><p>39087</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>6689</p></td>
<td><p>15022</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>4506</p></td>
<td><p>18719</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>9050</p></td>
<td><p>17063</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>6405</p></td>
<td><p>31992</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>44</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>13946</p></td>
<td><p>23116</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>9626</p></td>
<td><p>44738</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=3 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>8338</p></td>
<td><p>17378</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>6151</p></td>
<td><p>24844</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=5 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>34</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>10497</p></td>
<td><p>19457</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>7858</p></td>
<td><p>39762</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=7 and NMS_RADIUS =1.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>12</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>46</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>15393</p></td>
<td><p>25450</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>11080</p></td>
<td><p>50662</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>6286</p></td>
<td><p>13441</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>4704</p></td>
<td><p>18072</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>8626</p></td>
<td><p>15498</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>6606</p></td>
<td><p>31371</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 3, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>13543</p></td>
<td><p>21522</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>9853</p></td>
<td><p>43301</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>7670</p></td>
<td><p>16750</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>5513</p></td>
<td><p>22854</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>9712</p></td>
<td><p>18793</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>7338</p></td>
<td><p>36136</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 5, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>44</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>14650</p></td>
<td><p>24846</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>10558</p></td>
<td><p>48866</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=3 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>4</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>9562</p></td>
<td><p>19101</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>7405</p></td>
<td><p>29986</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=5 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>34</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>11751</p></td>
<td><p>21180</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>9254</p></td>
<td><p>44024</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization for Sobel Filter = 7, Box filter=7 and NMS_RADIUS =2.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 54%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel</p></th>
<th class="head"><p>8 pixel</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>20</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>7</p></td>
<td><p>46</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>11</p></td>
<td><p>88</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>16723</p></td>
<td><p>27156</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>12474</p></td>
<td><p>54858</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the Harris corner detection in different configurations, as generated using Vivado HLS 2019.1 tool for Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 21%" />
<col style="width: 15%" />
<col style="width: 18%" />
<col style="width: 12%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="3"><p>Configuration</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head"><p>Sobel</p></th>
<th class="head"><p>Box</p></th>
<th class="head"><p>NMS Radius</p></th>
<th class="head"><p>Latency(In ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>1.71</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>1.71</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>1.71</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>3</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>7.21</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>7.21</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>7.21</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300 MHz</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>7.22</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>3</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>1.8</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1.81</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>1.81</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>1.81</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1.9</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p>1.91</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150 MHz</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>1.92</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviation from OpenCV</p>
<p>In Vitis Vision, thresholding and NMS are included, but in OpenCV they are not included. In Vitis Vision, all the blocks are implemented in fixed point. Whereas, in OpenCV, all the blocks are implemented in floating point.</p>
</div>
</div>
<div class="section" id="histogram-computation">
<span id="id58"></span><h2>Histogram Computation<a class="headerlink" href="#histogram-computation" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">calcHist</span></code> function computes the histogram of given input image.</div>
<div class="line"><img alt="image83" class="image" src="_images/xhk1554997030546.png" /></div>
<div class="line">Where, H is the array of 256 elements.</div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">calcHist</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">histogram</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id207">
<caption><span class="caption-text">Table . calcHist Parameter Description</span><a class="headerlink" href="#id207" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3 channels
are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>histogram</p></td>
<td><p>Output array of 256 elements</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the calcHist
function for Normal Operation (1 pixel) and Resource Optimized (8 pixel)
configurations, generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz for 1 pixel case and at 150 MHz
for 8 pixel mode.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 41%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Normal Operation (1 pixel)</p></th>
<th class="head"><p>Resource Optimized (8 pixel)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>BRAM_18K</p></td>
<td><p>2</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>196</p></td>
<td><p>274</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>240</p></td>
<td><p>912</p></td>
</tr>
<tr class="row-odd"><td><p>CLB</p></td>
<td><p>57</p></td>
<td><p>231</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the calcHist function for Normal Operation (1 pixel), generated using Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz for 1 pixel case for 4K image 3 channel.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Normal Operation (1 pixel)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>BRAM_18K</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>381</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>614</p></td>
</tr>
<tr class="row-odd"><td><p>CLB</p></td>
<td><p>134</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the calcHist
function for Normal Operation (1 pixel) and Resource Optimized (8 pixel)
configurations, generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz for 1 pixel and 150 MHz for 8
pixel mode.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="histogram-equalization">
<span id="id59"></span><h2>Histogram Equalization<a class="headerlink" href="#histogram-equalization" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">equalizeHist</span></code> function performs histogram equalization on input
image or video. It improves the contrast in the image, to stretch out
the intensity range. This function maps one distribution (histogram) to
another distribution (a wider and more uniform distribution of intensity
values), so the intensities are spread over the whole range.</p>
<p>For histogram H[i], the cumulative distribution H’[i] is given as:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image84" class="image" src="_images/ihw1554997002639.png" /></div>
</div>
<p>The intensities in the equalized image are computed as:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image85" class="image" src="_images/vhw1554997072665.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">equalizeHist</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id208">
<caption><span class="caption-text">Table . equalizeHist Parameter Description</span><a class="headerlink" href="#id208" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and output pixel type. Only 8-bit, unsigned, 1
channel is supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p id="resource-utilization-71">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
equalizeHist function for Normal Operation (1 pixel) and Resource
Optimized (8 pixel) configurations, generated using Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz for 1
pixel and 150 MHz for 8 pixel mode.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 29%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
<td><p>3492</p></td>
<td><p>1807</p></td>
<td><p>666</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>25</p></td>
<td><p>5</p></td>
<td><p>3526</p></td>
<td><p>2645</p></td>
<td><p>835</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the
equalizeHist function for Normal Operation (1 pixel) and Resource
Optimized (8 pixel) configurations, generated using Vivado HLS
2019.1version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz for
1 pixel and 150 MHz for 8 pixel mode.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel per clock operation</p></td>
<td><p>13.8</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel per clock operation</p></td>
<td><p>3.4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hog">
<span id="id60"></span><h2>HOG<a class="headerlink" href="#hog" title="Permalink to this headline">¶</a></h2>
<p>The histogram of oriented gradients (HOG) is a feature descriptor used
in computer vision for the purpose of object detection. The feature
descriptors produced from this approach is widely used in the pedestrian
detection.</p>
<p>The technique counts the occurrences of gradient orientation in
localized portions of an image. HOG is computed over a dense grid of
uniformly spaced cells and normalized over overlapping blocks, for
improved accuracy. The concept behind HOG is that the object appearance
and shape within an image can be described by the distribution of
intensity gradients or edge direction.</p>
<p>Both RGB and gray inputs are accepted to the function. In the RGB mode,
gradients are computed for each plane separately, but the one with the
higher magnitude is selected. With the configurations provided, the
window dimensions are 64x128, block dimensions are 16x16.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">WIN_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WIN_WIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WIN_STRIDE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BLOCK_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BLOCK_WIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">CELL_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">CELL_WIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NOB</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DESC_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">IMG_COLOR</span><span class="p">,</span> <span class="kt">int</span> <span class="n">OUTPUT_VARIANT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="n">XF_NPPC1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">HOGDescriptor</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_in_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DESC_SIZE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_desc_mat</span><span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template parameters.</p>
<table class="docutils align-default" id="id209">
<caption><span class="caption-text">Table . HOGDescriptor Template .. rubric:: Parameter Descriptions</span><a class="headerlink" href="#id209" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WIN_HEIGHT</p></td>
<td><p>The number of pixel rows in the window. This must be
a multiple of 8 and should not exceed the number of
image rows.</p></td>
</tr>
<tr class="row-odd"><td><p>WIN_WIDTH</p></td>
<td><p>The number of pixel cols in the window. This must be
a multiple of 8 and should not exceed the number of
image columns.</p></td>
</tr>
<tr class="row-even"><td><p>WIN_STRIDE</p></td>
<td><p>The pixel stride between two adjacent windows. It is
fixed at 8.</p></td>
</tr>
<tr class="row-odd"><td><p>BLOCK_HEIGHT</p></td>
<td><p>Height of the block. It is fixed at 16.</p></td>
</tr>
<tr class="row-even"><td><p>BLOCK_WIDTH</p></td>
<td><p>Width of the block. It is fixed at 16.</p></td>
</tr>
<tr class="row-odd"><td><p>CELL_HEIGHT</p></td>
<td><p>Number of rows in a cell. It is fixed at 8.</p></td>
</tr>
<tr class="row-even"><td><p>CELL_WIDTH</p></td>
<td><p>Number of cols in a cell. It is fixed at 8.</p></td>
</tr>
<tr class="row-odd"><td><p>NOB</p></td>
<td><p>Number of histogram bins for a cell. It is fixed at 9</p></td>
</tr>
<tr class="row-even"><td><p>DESC_SIZE</p></td>
<td><p>The size of the output descriptor.</p></td>
</tr>
<tr class="row-odd"><td><p>IMG_COLOR</p></td>
<td><p>The type of the image, set as either XF_GRAY or
XF_RGB</p></td>
</tr>
<tr class="row-even"><td><p>OUTPUT_VARIE
NT</p></td>
<td><p>Must be either XF_HOG_RB or XF_HOG_NRB</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Must be either XF_8UC1 or XF_8UC4,
for gray and color respectively.</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output descriptor type. Must be XF_32UC1.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; this
function supports only XF_NPPC1 or 1 pixel per cycle
operations.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map UltraRAM instead of BRAM for some
storage structures.</p></td>
</tr>
</tbody>
</table>
<p>The following table describes the function parameters.</p>
<p>Where,</p>
<ul class="simple">
<li><p>NO is normal operation (single pixel processing)</p></li>
<li><p>RB is repetitive blocks (descriptor data are written window wise)</p></li>
<li><p>NRB is non-repetitive blocks (descriptor data are written block wise,
in order to reduce the number of writes).</p></li>
</ul>
<p>Note: In the RB mode, the block data is written to the memory taking the
overlap windows into consideration. In the NRB mode, the block data is
written directly to the output stream without consideration of the
window overlap. In the host side, the overlap must be taken care.</p>
<p class="rubric">Resource Utilization</p>
<p>The following table shows the resource utilization of <code class="docutils literal notranslate"><span class="pre">HOGDescriptor</span></code>
function for normal operation (1 pixel) mode as generated in Vivado HLS
2019.1 version tool for the part Xczu9eg-ffvb1156-1-i-es1 at 300 MHz to
process an image of 1920x1080 resolution.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 60%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Resource</p></th>
<th class="head" colspan="4"><p>Utilization (at 300 MHz) of 1 pixel operation</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="2"><p>NRB</p></th>
<th class="head" colspan="2"><p>RB</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>Gray</p></th>
<th class="head"><p>RGB</p></th>
<th class="head"><p>Gray</p></th>
<th class="head"><p>RGB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>43</p></td>
<td><p>49</p></td>
<td><p>171</p></td>
<td><p>177</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>34</p></td>
<td><p>46</p></td>
<td><p>36</p></td>
<td><p>48</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>15365</p></td>
<td><p>15823</p></td>
<td><p>15205</p></td>
<td><p>15663</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>12868</p></td>
<td><p>13267</p></td>
<td><p>13443</p></td>
<td><p>13848</p></td>
</tr>
</tbody>
</table>
<p>The following table shows the resource utilization of <code class="docutils literal notranslate"><span class="pre">HOGDescriptor</span></code>
function for normal operation (1 pixel) mode as generated in Vivado HLS 2019.1
version tool for the part xczu7ev-ffvc1156-2-e at 300 MHz to process an
image of 1920x1080 resolution with UltraRAM enabled.</p>
<p>UltraRAM enabled</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 60%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Resource</p></th>
<th class="head" colspan="4"><p>Utilization (at 300 MHz) of 1 pixel operation</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="2"><p>NRB</p></th>
<th class="head" colspan="2"><p>RB</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>Gray</p></th>
<th class="head"><p>RGB</p></th>
<th class="head"><p>Gray</p></th>
<th class="head"><p>RGB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>10</p></td>
<td><p>12</p></td>
<td><p>18</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>URAM</p></td>
<td><p>15</p></td>
<td><p>15</p></td>
<td><p>15</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>34</p></td>
<td><p>46</p></td>
<td><p>36</p></td>
<td><p>48</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>17285</p></td>
<td><p>17917</p></td>
<td><p>18270</p></td>
<td><p>18871</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>12409</p></td>
<td><p>12861</p></td>
<td><p>12793</p></td>
<td><p>13961</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table shows the performance estimates of HOGDescriptor()
function for different configurations as generated in Vivado HLS 2019.1
version tool for the part Xczu9eg-ffvb1156-1-i-es1 to process an image
of 1920x1080p resolution.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 38%" />
<col style="width: 25%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min (ms)</p></th>
<th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>NRB-Gray</p></td>
<td><p>300</p></td>
<td><p>6.98</p></td>
<td><p>8.83</p></td>
</tr>
<tr class="row-even"><td><p>NRB-RGBA</p></td>
<td><p>300</p></td>
<td><p>6.98</p></td>
<td><p>8.83</p></td>
</tr>
<tr class="row-odd"><td><p>RB-Gray</p></td>
<td><p>300</p></td>
<td><p>176.81</p></td>
<td><p>177</p></td>
</tr>
<tr class="row-even"><td><p>RB-RGBA</p></td>
<td><p>300</p></td>
<td><p>176.81</p></td>
<td><p>177</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Deviations from OpenCV</p>
<p>Listed below are the deviations from the OpenCV:</p>
<ol class="arabic">
<li><p>Border care</p>
<p>The border care that OpenCV has taken in the gradient computation is
BORDER_REFLECT_101, in which the border padding will be the
neighboring pixels’ reflection. Whereas, in the Xilinx
implementation, BORDER_CONSTANT (zero padding) was used for the
border care.</p>
</li>
<li><p>Gaussian weighing</p>
<p>The Gaussian weights are multiplied on the pixels over the block,
that is a block has 256 pixels, and each position of the block are
multiplied with its corresponding Gaussian weights. Whereas, in the
HLS implementation, gaussian weighing was not performed.</p>
</li>
<li><p>Cell-wise interpolation
The magnitude values of the pixels are distributed across different
cells in the blocks but on the corresponding bins.
<img alt="image86" class="image" src="_images/gfi1554997307018.png" />
Pixels in the region 1 belong only to its corresponding cells, but
the pixels in region 2 and 3 are interpolated to the adjacent 2 cells
and 4 cells respectively. This operation was not performed in the HLS
implementation.</p></li>
<li><p>Output handling</p>
<p>The output of the OpenCV will be in the column major form. In the HLS
implementation, output will be in the row major form. Also, the
feature vector will be in the fixed point type Q0.16 in the HLS
implementation, while in the OpenCV it will be in floating point.</p>
</li>
</ol>
<p class="rubric">Limitations</p>
<ol class="arabic simple">
<li><p>The configurations are limited to <a class="reference external" href="https://lear.inrialpes.fr/people/triggs/pubs/Dalal-cvpr05.pdf">Dalal’s
implementation</a></p></li>
<li><p>Image height and image width must be a multiple of cell height and
cell width respectively.</p></li>
</ol>
</div>
<div class="section" id="houghlines">
<span id="id61"></span><h2>HoughLines<a class="headerlink" href="#houghlines" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">HoughLines</span></code> function here is equivalent to HoughLines Standard in
OpenCV. The <code class="docutils literal notranslate"><span class="pre">HoughLines</span></code> function is used to detect straight lines in
a binary image. To apply the Hough transform, edge detection
preprocessing is required. The input to the Hough transform is an edge
detected binary image. For each point (xi,yi) in a binary image, we
define a family of lines that go through the point as:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="o">=</span> <span class="n">xi</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">yi</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Each pair of (rho,theta) represents a line that passes through the point
(xi,yi). These (rho,theta) pairs of this family of lines passing through
the point form a sinusoidal curve in (rho,theta) plane. If the sinusoids
of N different points intersect in the (rho,theta) plane, then that
intersection (rho1, theta1) represents the line that passes through
these N points. In the <code class="docutils literal notranslate"><span class="pre">HoughLines</span></code> function, an accumulator is used
to keep the count (also called voting) of all the intersection points in
the (rho,theta) plane. After voting, the function filters spurious lines
by performing thinning, that is, checking if the center vote value is
greater than the neighborhood votes and threshold, then making that
center vote as valid and other wise making it zero. Finally, the
function returns the desired maximum number of lines (LINESMAX) in
(rho,theta) form as output.</p>
<p>The design assumes the origin at the center of the image i.e at
(Floor(COLS/2), Floor(ROWS/2)). The ranges of rho and theta are:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">DIAG</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">DIAG</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">where</span> <span class="n">DIAG</span> <span class="o">=</span> <span class="n">cvRound</span><span class="p">{</span><span class="n">SquareRoot</span><span class="p">(</span> <span class="p">(</span><span class="n">COLS</span><span class="o">*</span><span class="n">COLS</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ROWS</span><span class="o">*</span><span class="n">ROWS</span><span class="p">))}</span>
</pre></div>
</div>
<p>For ease of use, the input angles THETA, MINTHETA and MAXTHETA are taken
in degrees, while the output theta is in radians. The angle resolution
THETA is declared as an integer, but treated as a value in Q6.1 format
(that is, THETA=3 signifies that the resolution used in the function is
1.5 degrees). When the output (rho, ? theta) is used for drawing lines,
you should be aware of the fact that origin is at the center of the
image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">RHO</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">THETA</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAXLINES</span><span class="p">,</span><span class="kt">int</span> <span class="n">DIAG</span><span class="p">,</span><span class="kt">int</span> <span class="n">MINTHETA</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAXTHETA</span><span class="p">,</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">HoughLines</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="kt">float</span> <span class="n">outputrho</span><span class="p">[</span><span class="n">MAXLINES</span><span class="p">],</span><span class="kt">float</span> <span class="n">outputtheta</span><span class="p">[</span><span class="n">MAXLINES</span><span class="p">],</span><span class="kt">short</span> <span class="n">threshold</span><span class="p">,</span><span class="kt">short</span> <span class="n">linesmax</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id210">
<caption><span class="caption-text">Table . HoughLines Parameter Description</span><a class="headerlink" href="#id210" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RHO</p></td>
<td><p>Distance resolution of the accumulator in pixels.</p></td>
</tr>
<tr class="row-odd"><td><p>THETA</p></td>
<td><p>Angle resolution of the accumulator in degrees and Q6.1
format.</p></td>
</tr>
<tr class="row-even"><td><p>MAXLINES</p></td>
<td><p>Maximum number of lines to be detected</p></td>
</tr>
<tr class="row-odd"><td><p>MINTHETA</p></td>
<td><p>Minimum angle in degrees to check lines.</p></td>
</tr>
<tr class="row-even"><td><p>MAXTHETA</p></td>
<td><p>Maximum angle in degrees to check lines</p></td>
</tr>
<tr class="row-odd"><td><p>DIAG</p></td>
<td><p>Diagonal of the image. It should be
cvRound(sqrt(rows*rows + cols*cols)/RHO).</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. Only 8-bit, unsigned, 1-channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input image</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of Pixels to be processed per cycle; Only single
pixel supported XF_NPPC1.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image should be 8-bit, single-channel binary
image.</p></td>
</tr>
<tr class="row-odd"><td><p>outputrho</p></td>
<td><p>Output array of rho values. rho is the distance from the
coordinate origin (center of the image).</p></td>
</tr>
<tr class="row-even"><td><p>outputthe
ta</p></td>
<td><p>Output array of theta values. Theta is the line rotation
angle in radians.</p></td>
</tr>
<tr class="row-odd"><td><p>threshold</p></td>
<td><p>Accumulator threshold parameter. Only those lines are
returned that get enough votes (&gt;threshold).</p></td>
</tr>
<tr class="row-even"><td><p>linesmax</p></td>
<td><p>Maximum number of lines.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The table below shows the resource utilization of the kernel for
different configurations, generated using Vivado HLS 2019.1 version tool
for the Xczu9eg-ffvb1156-1-i-es1 to process a grayscale HD (1080x1920)
image for 512 lines.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>THETA=1, RHO=1</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>BRAM_18K</p></td>
<td><p>542</p></td>
</tr>
<tr class="row-even"><td><p>DSP48E</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>60648</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>56131</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table shows the performance of kernel for different
configurations, generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 to process a grayscale HD (1080x1920) image for
512 lines.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 44%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>THETA=1, RHO=1</p></td>
<td><p>300</p></td>
<td><p>12.5</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="preprocessing-for-deep-neural-networks">
<span id="preprocessing-deep-neural-networks"></span><h2>Preprocessing for Deep Neural Networks<a class="headerlink" href="#preprocessing-for-deep-neural-networks" title="Permalink to this headline">¶</a></h2>
<p>The input image are typically pre-processed before being fed for inference of different deep neural networks (DNNs). The preProcess function provides various modes to perform various preprocessing operations. The preprocessing function<span class="math notranslate nohighlight">\(\ f(x\)</span>) can be described using below equations.</p>
<p><img alt="image164" class="image" src="_images/eq1DNN.png" /></p>
<p>The preProcess function supports operating modes presented in the below table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 52%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Op Code</p></th>
<th class="head"><p>Operation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p><img alt="image165" class="image" src="_images/eq2DNN.png" /></p></td>
<td><p>Mean subtraction</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><img alt="image166" class="image" src="_images/eq3DNN.png" /></p></td>
<td><p>Scale and clip</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p><img alt="image167" class="image" src="_images/eq7DNN.png" /></p></td>
<td><p>Clipping</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p><img alt="image168" class="image" src="_images/eq4DNN.png" /></p></td>
<td><p>Scale and bias</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p><img alt="image169" class="image" src="_images/eq5DNN.png" /></p></td>
<td><p>Scale and bias with mean subtraction</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p><img alt="image170" class="image" src="_images/eq6DNN.png" /></p></td>
<td><p>Complete operation</p></td>
</tr>
</tbody>
</table>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>template &lt;int INPUT_PTR_WIDTH_T,int OUTPUT_PTR_WIDTH_T, int T_CHANNELS_T, int CPW_T, int ROWS_T, int COLS_T, int NPC_T, bool PACK_MODE_T, int WX_T, int WA_T, int WB_T, int WY_T, int WO_T, int FX_T, int FA_T, int FB_T, int FY_T,int FO_T, bool SIGNED_IN_T, int OPMODE_T&gt;

void preProcess(hls::stream&lt;ap_uint&lt;INPUT_PTR_WIDTH_T&gt; &gt; &amp;srcStrm, ap_uint&lt;OUTPUT_PTR_WIDTH_T&gt; \*out, float params[3*T_CHANNELS_T], int rows, int cols, int th1, int th2)
</pre></div>
</div>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>srcStrm</p></td>
<td><p>Input image stream</p></td>
</tr>
<tr class="row-odd"><td><p>out</p></td>
<td><p>Output pointer</p></td>
</tr>
<tr class="row-even"><td><p>params</p></td>
<td><p>Array containing α, β and γ values</p></td>
</tr>
<tr class="row-odd"><td><p>rows</p></td>
<td><p>Input image height</p></td>
</tr>
<tr class="row-even"><td><p>cols</p></td>
<td><p>Input image width</p></td>
</tr>
<tr class="row-odd"><td><p>th1</p></td>
<td><p>Upper threshold</p></td>
</tr>
<tr class="row-even"><td><p>th2</p></td>
<td><p>Lower threshold</p></td>
</tr>
<tr class="row-odd"><td><p>INPUT_PTR_WIDTH_T</p></td>
<td><p>Width of input pointer</p></td>
</tr>
<tr class="row-even"><td><p>OUTPUT_PTR_WIDTH_T</p></td>
<td><p>Width of output pointer</p></td>
</tr>
<tr class="row-odd"><td><p>T_CHANNELS_T</p></td>
<td><p>Total Channels</p></td>
</tr>
<tr class="row-even"><td><p>CPW_T</p></td>
<td><p>Channels Packed per DDR Word</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS_T</p></td>
<td><p>Max Height of Image</p></td>
</tr>
<tr class="row-even"><td><p>COLS_T</p></td>
<td><p>Max Width of Image</p></td>
</tr>
<tr class="row-odd"><td><p>NPC_T</p></td>
<td><p>Number of pixels processed per clock</p></td>
</tr>
<tr class="row-even"><td><p>PACK_MODE_T</p></td>
<td><p>data format (pixel packed or channel packed)</p></td>
</tr>
<tr class="row-odd"><td><p>WX_T</p></td>
<td><p>x bit width</p></td>
</tr>
<tr class="row-even"><td><p>WA_T</p></td>
<td><p>alpha bit width</p></td>
</tr>
<tr class="row-odd"><td><p>WB_T</p></td>
<td><p>beta bit width</p></td>
</tr>
<tr class="row-even"><td><p>WY_T</p></td>
<td><p>Gamma bit width</p></td>
</tr>
<tr class="row-odd"><td><p>WO_T</p></td>
<td><p>Output bit width</p></td>
</tr>
<tr class="row-even"><td><p>FX_T</p></td>
<td><p>Number of integer bits for x</p></td>
</tr>
<tr class="row-odd"><td><p>FA_T</p></td>
<td><p>Number of integer bits for alpha</p></td>
</tr>
<tr class="row-even"><td><p>FB_T</p></td>
<td><p>Number of integer bits for beta</p></td>
</tr>
<tr class="row-odd"><td><p>FY_T</p></td>
<td><p>Number of integer bits for gamma</p></td>
</tr>
<tr class="row-even"><td><p>FO_T</p></td>
<td><p>Number of integer bits for output</p></td>
</tr>
<tr class="row-odd"><td><p>SIGNED_IN_T</p></td>
<td><p>Signed input flag</p></td>
</tr>
<tr class="row-even"><td><p>OPMODE_T</p></td>
<td><p>Operating mode</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of preProcess for NPC_T =8, CPW_T=3 and OPMODE=0, for a maximum input image size of 1280x720 pixels. The results are after synthesis in Vitis 2019.2 for the Xilinx xcu200-fsgd2104-2-e FPGA at 300 MHz. Latency for this configuration is 0.7 ms.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 25%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Utilization Estimate</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>SLICE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>7554</p></td>
<td><p>11127</p></td>
<td><p>2155</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pyramid-up">
<span id="id62"></span><h2>Pyramid Up<a class="headerlink" href="#pyramid-up" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">pyrUp</span></code> function is an image up-sampling algorithm. It first
inserts zero rows and zero columns after every input row and column
making up to the size of the output image. The output image size is
always <img alt="image87" class="image" src="_images/qll1554996981264.png" />. The zero padded image is then smoothened using
Gaussian image filter. Gaussian filter for the pyramid-up function
uses a fixed filter kernel as given below:</div>
<div class="line"><img alt="image88" class="image" src="_images/qrr1554997134520.png" /></div>
</div>
<p>However, to make up for the pixel intensity that is reduced due to zero
padding, each output pixel is multiplied by 4.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">pyrUp</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id211">
<caption><span class="caption-text">Table . pyrUp Parameter Description</span><a class="headerlink" href="#id211" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum Height or number of output rows to build the
hardware for this kernel</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum Width or number of output columns to build
the hardware for this kernel</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to process per cycle. Currently, the
kernel supports only 1 pixel per cycle processing
(XF_NPPC1).</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image stream</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image stream</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of pyrUp for 1
pixel per cycle implementation, for a maximum input image size of
1920x1080 pixels. The results are after synthesis in Vivado HLS 2019.1
for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 27%" />
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>1124</p></td>
<td><p>1199</p></td>
<td><p>0</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of pyrUp for 1
pixel per cycle implementation, for a maximum input image size of 4K
with BGR. The results are after synthesis in Vivado HLS 2019.1 for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 27%" />
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2074</p></td>
<td><p>2176</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of pyrUp function
on Vivado HLS 2019.1 for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 29%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" rowspan="2"><p>Input Image Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>27.82</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pyramid-down">
<span id="id63"></span><h2>Pyramid Down<a class="headerlink" href="#pyramid-down" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">pyrDown</span></code> function is an image down-sampling algorithm which
smoothens the image before down-scaling it. The image is smoothened
using a Gaussian filter with the following kernel:</div>
<div class="line"><img alt="image89" class="image" src="_images/trm1554997022711.png" /></div>
</div>
<p>Down-scaling is performed by dropping pixels in the even rows and the
even columns. The resulting image size is <img alt="image90" class="image" src="_images/ocr1554996968618.png" />.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">pyrDown</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id212">
<caption><span class="caption-text">Table . pyrDown Parameter Description</span><a class="headerlink" href="#id212" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum Height or number of input rows to build the
hardware for this kernel</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum Width or number of input columns to build the
hardware for this kernel</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to process per cycle. Currently, the
kernel supports only 1 pixel per cycle processing
(XF_NPPC1).</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM</p></td>
</tr>
<tr class="row-odd"><td><p>_src</p></td>
<td><p>Input image stream</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image stream</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of pyrDown for 1
pixel per cycle implementation, for a maximum input image size of
1920x1080 pixels. The results are after synthesis in Vivado HLS 2019.1
for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 27%" />
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>1171</p></td>
<td><p>1238</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of pyrDown for 1
pixel per cycle implementation, for a maximum input image size of 4K
with BGR image. The results are after synthesis in Vivado HLS 2019.1 for
the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA at 300 MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 27%" />
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>2158</p></td>
<td><p>1983</p></td>
<td><p>2</p></td>
<td><p>30</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of pyrDown for 1
pixel per cycle implementation, for a maximum input image size of
3840x2160 pixels. The results are after synthesis in Vivado HLS 2019.1 for the
Xilinx xczu7eg-ffvb1156-1 FPGA at 300 MHz with UltraRAM enabled.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 26%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
<th class="head"><p>URAM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>1171</p></td>
<td><p>1243</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of pyrDown function
in Vivado HLS 2019.1 for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 29%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" rowspan="2"><p>Input Image Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>6.99</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="initundistortrectifymapinverse">
<span id="id64"></span><h2>InitUndistortRectifyMapInverse<a class="headerlink" href="#initundistortrectifymapinverse" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">InitUndistortRectifyMapInverse</span></code> function generates mapx and mapy,
based on a set of camera parameters, where mapx and mapy are inputs for
the xf::cv::remap function. That is, for each pixel in the location (u, v)
in the destination (corrected and rectified) image, the function
computes the corresponding coordinates in the source image (the original
image from camera). The InitUndistortRectifyMapInverse module is
optimized for hardware, so the inverse of rotation matrix is computed
outside the synthesizable logic. Note that the inputs are fixed point,
so the floating point camera parameters must be type casted to Q12.20
format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">CM_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DC_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAP_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">InitUndistortRectifyMapInverse</span> <span class="p">(</span> <span class="n">ap_fixed</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">cameraMatrix</span><span class="p">,</span> <span class="n">ap_fixed</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">distCoeffs</span><span class="p">,</span> <span class="n">ap_fixed</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">,</span><span class="mi">12</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">ir</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">MAP_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_mapx_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">MAP_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_mapy_mat</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_cm_size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_dc_size</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<p>Descriptions</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CM_SIZE</p></td>
<td><p>It must be set at the compile time, 9 for 3x3 matrix</p></td>
</tr>
<tr class="row-odd"><td><p>DC_SIZE</p></td>
<td><p>It must be set at the compile time, must be 4,5 or 8</p></td>
</tr>
<tr class="row-even"><td><p>MAP_T</p></td>
<td><p>It is the type of output maps, and must be XF_32FC1</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum image height, necessary to generate the
output maps</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum image width, necessary to generate the output
maps</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels per cycle. This function supports
only one pixel per cycle, so set to XF_NPPC1</p></td>
</tr>
<tr class="row-even"><td><p>cameraMatrix</p></td>
<td><p>The input matrix representing the camera in the old
coordinate system</p></td>
</tr>
<tr class="row-odd"><td><p>distCoeffs</p></td>
<td><p>The input distortion coefficients
(k1,k2,p1,p2[,k3[,k4,k5,k6]])</p></td>
</tr>
<tr class="row-even"><td><p>ir</p></td>
<td><p>The input transformation matrix is equal to
Invert(newCameraMatrix*R), where newCameraMatrix
represents the camera in the new coordinate system
and R is the rotation matrix.. This processing will
be done outside the synthesizable block</p></td>
</tr>
<tr class="row-odd"><td><p>_mapx_mat</p></td>
<td><p>Output mat objects containing the mapx</p></td>
</tr>
<tr class="row-even"><td><p>_mapy_mat</p></td>
<td><p>Output mat objects containing the mapy</p></td>
</tr>
<tr class="row-odd"><td><p>_cm_size</p></td>
<td><p>9 for 3x3 matrix</p></td>
</tr>
<tr class="row-even"><td><p>_dc_size</p></td>
<td><p>4, 5 or 8. If this is 0, then it means there is no
distortion</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="inrange">
<span id="id65"></span><h2>InRange<a class="headerlink" href="#inrange" title="Permalink to this headline">¶</a></h2>
<p>The InRange function checks if pixels in the image src lie between the
given boundaries. dst(x,y) is set to 255, if src(x,y) is within the
specified thresholds and otherwise 0.</p>
<p>Dst(I)= lowerb ≤ src(I) ≤ upperb</p>
<p>Where (x,y) is the spatial coordinate of the pixel.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">inRange</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">lower_thresh</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">upper_thresh</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id213">
<caption><span class="caption-text">Table . InRange Parameter Description</span><a class="headerlink" href="#id213" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 and 3 channels
are supported (XF_8UC1 and XF_8UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>lower_thresh</p></td>
<td><p>Lower threshold value</p></td>
</tr>
<tr class="row-odd"><td><p>upper_thresh</p></td>
<td><p>Upper threshold value</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the InRange
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>86</p></td>
<td><p>154</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>60</p></td>
<td><p>148</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>15</p></td>
<td><p>37</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="integral-image">
<span id="id66"></span><h2>Integral Image<a class="headerlink" href="#integral-image" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">integral</span></code> function computes an integral image of the input.
Each output pixel is the sum of all pixels above and to the left of
itself.</div>
<div class="line"><img alt="image91" class="image" src="_images/nmb1554997115083.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">integral</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id214">
<caption><span class="caption-text">Table . integral Parameter Description</span><a class="headerlink" href="#id214" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_TYPE</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_TYPE</p></td>
<td><p>Output pixel type. Only 32-bit,unsigned,1 channel is
supported(XF_32UC1)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; this
function supports only XF_NPPC1 or 1 pixel per cycle
operations.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>613</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>378</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>102</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>7.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dense-pyramidal-lk-optical">
<span id="id67"></span><h2>Dense Pyramidal LK Optical Flow<a class="headerlink" href="#dense-pyramidal-lk-optical" title="Permalink to this headline">¶</a></h2>
<p>Optical flow is the pattern of apparent motion of image objects between
two consecutive frames, caused by the movement of object or camera. It
is a 2D vector field, where each vector is a displacement vector showing
the movement of points from first frame to second.</p>
<p>Optical Flow works on the following assumptions:</p>
<ul class="simple">
<li><p>Pixel intensities of an object do not have too many variations in
consecutive frames</p></li>
<li><p>Neighboring pixels have similar motion</p></li>
</ul>
<div class="line-block">
<div class="line">Consider a pixel I(x, y, t) in first frame. (Note that a new
dimension, time, is added here. When working with images only, there
is no need of time). The pixel moves by distance (dx, dy) in the next
frame taken after time dt. Thus, since those pixels are the same and
the intensity does not change, the following is true:</div>
<div class="line"><img alt="image92" class="image" src="_images/stn1554997270724.png" /></div>
</div>
<p>Taking the Taylor series approximation on the right-hand side, removing
common terms, and dividing by dt gives the following equation:</p>
<p><img alt="image93" class="image" src="_images/llf1554997331936.png" /></p>
<p>Where <img alt="image94" class="image" src="_images/xmb1554997311620.png" />, <img alt="image95" class="image" src="_images/isg1554997279739.png" />, <img alt="image96" class="image" src="_images/iat1554997285872.png" /> and <img alt="image97" class="image" src="_images/cht1554996987363.png" />.</p>
<p>The above equation is called the Optical Flow equation, where, <code class="docutils literal notranslate"><span class="pre">fx</span></code>
and <code class="docutils literal notranslate"><span class="pre">fy</span></code> are the image gradientsand <code class="docutils literal notranslate"><span class="pre">ft</span></code> is the gradient along time.
However, (u, v) is unknown. It is not possible to solve this equation
with two unknown variables. Thus, several methods are provided to solve
this problem. One method is Lucas-Kanade. Previously it was assumed that
all neighboring pixels have similar motion. The Lucas-Kanade method
takes a patch around the point, whose size can be defined through the
‘WINDOW_SIZE’ template parameter. Thus, all the points in that patch
have the same motion. It is possible to find (<code class="docutils literal notranslate"><span class="pre">fx</span></code>, <code class="docutils literal notranslate"><span class="pre">fy</span></code>, <code class="docutils literal notranslate"><span class="pre">ft</span></code> )
for these points. Thus, the problem now becomes solving ‘WINDOW_SIZE *
WINDOW_SIZE’ equations with two unknown variables,which is
over-determined. A better solution is obtained with the “least square
fit” method. Below is the final solution, which is a problem with two
equations and two unknowns:</p>
<p><img alt="image98" class="image" src="_images/tms1554997253713.png" /></p>
<blockquote>
<div><p>This solution fails when a large motion is involved and so pyramids are</p>
</div></blockquote>
<p>used. Going up in the pyramid, small motions are removed and large
motions become small motions and so by applying Lucas-Kanade, the
optical flow along with the scale is obtained.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">NUM_PYR_LEVELS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NUM_LINES</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WINSIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">FLOW_WIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">FLOW_INT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">densePyrOpticalFlow</span><span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_current_img</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_next_image</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">XF_32UC1</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_streamFlowin</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">XF_32UC1</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_streamFlowout</span><span class="p">,</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">level</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">scale_up_flag</span><span class="p">,</span> <span class="kt">float</span> <span class="n">scale_in</span><span class="p">,</span> <span class="n">ap_uint</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span> <span class="n">init_flag</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<p>Descriptions</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NUM_PYR_LEVE
LS</p></td>
<td><p>Number of Image Pyramid levels used for the optical
flow computation</p></td>
</tr>
<tr class="row-odd"><td><p>NUM_LINES</p></td>
<td><p>Number of lines to buffer for the remap algorithm –
used to find the temporal gradient</p></td>
</tr>
<tr class="row-even"><td><p>WINSIZE</p></td>
<td><p>Window Size over which Optical Flow is computed</p></td>
</tr>
<tr class="row-odd"><td><p>FLOW_WIDTH,
FLOW_INT</p></td>
<td><p>Data width and number of integer bits to define the
signed flow vector data type. Integer bit includes
the signed bit.</p>
<p>The default type is 16-bit signed word with 10
integer bits and 6 decimal bits.</p>
</td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Pixel type of the input image. XF_8UC1 is only the
supported value.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height or number of rows to build the
hardware for this kernel</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width or number of columns to build the
hardware for this kernel</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels the hardware kernel must process per
clock cycle. Only XF_NPPC1, 1 pixel per cycle, is
supported.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map some storage structures to UltraRAM</p></td>
</tr>
<tr class="row-odd"><td><p>_curr_img</p></td>
<td><p>First input image stream</p></td>
</tr>
<tr class="row-even"><td><p>_next_img</p></td>
<td><p>Second input image to which the optical flow is
computed with respect to the first image</p></td>
</tr>
<tr class="row-odd"><td><p>_streamFlow
in</p></td>
<td><p>32-bit Packed U and V flow vectors input for optical
flow. The bits from 31-16 represent the flow vector U
while the bits from 15-0 represent the flow vector V.</p></td>
</tr>
<tr class="row-even"><td><p>_streamFlow
out</p></td>
<td><p>32-bit Packed U and V flow vectors output after
optical flow computation. The bits from 31-16
represent the flow vector U while the bits from 15-0
represent the flow vector V.</p></td>
</tr>
<tr class="row-odd"><td><p>level</p></td>
<td><p>Image pyramid level at which the algorithm is
currently computing the optical flow.</p></td>
</tr>
<tr class="row-even"><td><p>scale_up_fla
g</p></td>
<td><p>Flag to enable the scaling-up of the flow vectors.
This flag is set at the host when switching from one
image pyramid level to the other.</p></td>
</tr>
<tr class="row-odd"><td><p>scale_in</p></td>
<td><p>Floating point scale up factor for the scaling-up the
flow vectors.
The value is (previous_rows-1)/(current_rows-1). This
is not 1 when switching from one image pyramid level
to the other.</p></td>
</tr>
<tr class="row-even"><td><p>init_flag</p></td>
<td><p>Flag to initialize flow vectors to 0 in the first
iteration of the highest pyramid level. This flag
must be set in the first iteration of the highest
pyramid level (smallest image in the pyramid). The
flag must be unset for all the other iterations.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of
densePyrOpticalFlow for 1 pixel per cycle implementation, with the
optical flow computed for a window size of 11 over an image size of
1920x1080 pixels. The results are after implementation in Vivado HLS
2019.1 for the Xilinx xczu9eg-ffvb1156-2L-e FPGA at 300 MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 27%" />
<col style="width: 28%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>32231</p></td>
<td><p>16596</p></td>
<td><p>52</p></td>
<td><p>215</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization with UltraRAM Enable</p>
<p>The following table summarizes the resource utilization of
densePyrOpticalFlow for 1 pixel per cycle implementation, with the
optical flow computed for a window size of 11 over an image size of
3840X2160 pixels. The results are after implementation in Vivado HLS 2019.1 for
the Xilinx xczu7ev-ffvc1156-2 FPGA at 300 MHz with UltraRAM enabled.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 26%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
<th class="head"><p>URAM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>300</p></td>
<td><p>31164</p></td>
<td><p>42320</p></td>
<td><p>81</p></td>
<td><p>34</p></td>
<td><p>23</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance figures on hardware for the
densePyrOpticalFlow function for 5 iterations over 5 pyramid levels
scaled down by a factor of two at each level. This has been tested on
the zcu102 evaluation board.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 31%" />
<col style="width: 18%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" rowspan="2"><p>Image Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>49.7</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1280x720</p></td>
<td><p>22.9</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1226x370</p></td>
<td><p>12.02</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dense-non-pyramidal-lk-optical">
<span id="id68"></span><h2>Dense Non-Pyramidal LK Optical Flow<a class="headerlink" href="#dense-non-pyramidal-lk-optical" title="Permalink to this headline">¶</a></h2>
<p>Optical flow is the pattern of apparent motion of image objects between
two consecutive frames, caused by the movement of object or camera. It
is a 2D vector field, where each vector is a displacement vector showing
the movement of points from first frame to second.</p>
<p>Optical Flow works on the following assumptions:</p>
<ul class="simple">
<li><p>Pixel intensities of an object do not have too many variations in
consecutive frames</p></li>
<li><p>Neighboring pixels have similar motion</p></li>
</ul>
<div class="line-block">
<div class="line">Consider a pixel I(x, y, t) in first frame. (Note that a new
dimension, time, is added here. When working with images only, there
is no need of time). The pixel moves by distance (dx, dy) in the next
frame taken after time dt. Thus, since those pixels are the same and
the intensity does not change, the following is true:</div>
<div class="line"><img alt="image99" class="image" src="_images/stn1554997270724.png" /></div>
</div>
<p>Taking the Taylor series approximation on the right-hand side, removing
common terms, and dividing by dt gives the following equation:</p>
<p><img alt="image100" class="image" src="_images/llf1554997331936.png" /></p>
<p>Where <img alt="image101" class="image" src="_images/xmb1554997311620.png" />, <img alt="image102" class="image" src="_images/isg1554997279739.png" />, <img alt="image103" class="image" src="_images/iat1554997285872.png" /> and <img alt="image104" class="image" src="_images/cht1554996987363.png" />.</p>
<p>The above equation is called the Optical Flow equation, where, <code class="docutils literal notranslate"><span class="pre">fx</span></code>
and <code class="docutils literal notranslate"><span class="pre">fy</span></code> are the image gradientsand <code class="docutils literal notranslate"><span class="pre">ft</span></code> is the gradient along time.
However, (u, v) is unknown. It is not possible to solve this equation
with two unknown variables. Thus, several methods are provided to solve
this problem. One method is Lucas-Kanade. Previously it was assumed that
all neighboring pixels have similar motion. The Lucas-Kanade method
takes a patch around the point, whose size can be defined through the
‘WINDOW_SIZE’ template parameter. Thus, all the points in that patch
have the same motion. It is possible to find (<code class="docutils literal notranslate"><span class="pre">fx</span></code>, <code class="docutils literal notranslate"><span class="pre">fy</span></code>, <code class="docutils literal notranslate"><span class="pre">ft</span></code> )
for these points. Thus, the problem now becomes solving ‘WINDOW_SIZE *
WINDOW_SIZE’ equations with two unknown variables,which is
over-determined. A better solution is obtained with the “least square
fit” method. Below is the final solution, which is a problem with two
equations and two unknowns:</p>
<p><img alt="image105" class="image" src="_images/tms1554997253713.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WINDOW_SIZE</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">DenseNonPyrLKOpticalFlow</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">frame0</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">frame1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">XF_32FC1</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">flowx</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">XF_32FC1</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">flowy</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<p>Descriptions</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Type</p></td>
<td><p>pixel type. The current supported pixel value is
XF_8UC1, unsigned 8 bit.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum number of rows of the input image that the
hardware kernel must be built for.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum number of columns of the input image that the
hardware kernel must be built for.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to process per cycle. Supported
values are XF_NPPC1 (=1) and XF_NPPC2(=2).</p></td>
</tr>
<tr class="row-even"><td><p>WINDOW_SIZE</p></td>
<td><p>Window size over which optical flow will be computed.
This can be any odd positive integer.</p></td>
</tr>
<tr class="row-odd"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM.</p></td>
</tr>
<tr class="row-even"><td><p>frame0</p></td>
<td><p>First input images.</p></td>
</tr>
<tr class="row-odd"><td><p>frame1</p></td>
<td><p>Second input image. Optical flow is computed between
frame0 and frame1.</p></td>
</tr>
<tr class="row-even"><td><p>flowx</p></td>
<td><p>Horizontal component of the flow vectors. The format
of the flow vectors is XF_32FC1 or single precision.</p></td>
</tr>
<tr class="row-odd"><td><p>flowy</p></td>
<td><p>Vertical component of the flow vectors. The format of
the flow vectors is XF_32FC1 or single precision.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of
DenseNonPyrLKOpticalFlow for a 4K image, as generated in the Vivado HLS
2019.1 version tool for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA at 300
MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUTs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>178</p></td>
<td><p>42</p></td>
<td><p>11984</p></td>
<td><p>7730</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>258</p></td>
<td><p>82</p></td>
<td><p>22747</p></td>
<td><p>15126</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of
DenseNonPyrLKOpticalFlow for a 4K image, as generated in the Vivado HLS version
tool for the Xilinx Xczu7eg-ffvb1156-1 FPGA at 300 MHz with UltraRAM
enabled.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 25%" />
<col style="width: 7%" />
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>URAM</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUTs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>12</p></td>
<td><p>42</p></td>
<td><p>11803</p></td>
<td><p>7469</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>23</p></td>
<td><p>80</p></td>
<td><p>22124</p></td>
<td><p>13800</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of the
DenseNonPyrLKOpticalFlow function for a 4K image, generated using Vivado
HLS 2019.1 version tool for the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>28.01</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>14.01</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="kalman-filter">
<span id="id69"></span><h2>Kalman Filter<a class="headerlink" href="#kalman-filter" title="Permalink to this headline">¶</a></h2>
<p>The classic Kalman Filter is proposed for linear system. The state-space
description of a linear system assumed to be:</p>
<div class="image figure align-default" id="dfn1543222970064-image-p1k-j41-yfb">
<img alt="" src="_images/nlt1554997093946.png" />
</div>
<div class="image figure align-default" id="dfn1543222970064-image-ybk-q43-yfb">
<img alt="" src="_images/ogm1554997066754.png" />
</div>
<p>where x<sub>k</sub> is the state vector at k<sup>th</sup> time instant,
constant (known) <code class="docutils literal notranslate"><span class="pre">Ak</span></code> is an nxn state transition matrix, constant
(known) B<sub>k</sub> is an nxm control input matrix, constant (known)
Γ<sub>k</sub> is an nxp system noise input matrix, constant (known)
H<sub>k</sub> is a qxn measurement matrix, constant (known) with 1≤ m, p,
q ≤ n, {u:sub:<cite>k</cite>} a (known) sequence of m vectors (called a
deterministic input sequence), and <img alt="image106" class="image" src="_images/ose1554996999042.png" /> and <img alt="image107" class="image" src="_images/ztb1554997245160.png" /> are
respectively, (unknown) system and observation noise sequences, with
known statistical information such as mean, variance, and covariance.</p>
<p>The Kalman filter assumes the following:</p>
<ol class="arabic simple">
<li><p><img alt="image108" class="image" src="_images/ose1554996999042.png" /> and <img alt="image109" class="image" src="_images/ztb1554997245160.png" /> are assumed to be sequences of zero-mean
Gaussian (or normal) white noise. That is, <img alt="image110" class="image" src="_images/bqk1554997337972.png" /> and <img alt="image111" class="image" src="_images/aoy1554997290519.png" />,
where δ<sub>kl</sub> is a Kronecker Delta function, and Q<sub>k</sub> and
R<sub>k</sub> are positive definite matrices, E(u) is an expectation of
random variable u.</p></li>
<li><p><img alt="image112" class="image" src="_images/vbo1554997325598.png" /></p></li>
<li><p>The initial state x<sub>0</sub> is also assumed to be independent of
<img alt="image113" class="image" src="_images/ose1554996999042.png" /> and <img alt="image114" class="image" src="_images/ztb1554997245160.png" />, that is <img alt="image115" class="image" src="_images/kik1554997032466.png" />.</p></li>
</ol>
<p>The representation <img alt="image116" class="image" src="_images/aba1554997005370.png" /> means the estimate of x at time instant k
using all the data measured till the time instant j.</p>
<p>The Kalman filter algorithm can be summarized as shown in the below
equations:</p>
<p>Initialization</p>
<div class="image figure align-default" id="dfn1543222970064-image-ypc-hq1-yfb">
<img alt="" src="_images/zba1554997110082.png" />
</div>
<p>Time Update / Predict</p>
<div class="image figure align-default" id="dfn1543222970064-image-tlm-dr1-yfb">
<img alt="" src="_images/bhn1554997235555.png" />
</div>
<p>Measurement Update/Correction</p>
<div class="image figure align-default" id="dfn1543222970064-image-w4w-kp3-yfb">
<img alt="" src="_images/mff1554997293984.png" />
</div>
<p>Where P<sub>k,j</sub> is an estimate error covariance nxn matrix,
G<sub>k</sub> is Kalman gain nxq matrix, and k=1, 2,..</p>
<p class="rubric">Computation Strategy</p>
<p>The numerical accuracy of the Kalman filter covariance measurement
update is a concern for implementation, since it differentiates two
positive definite arrays. This is a potential problem if finite
precision is used for computation. This design uses UDU factorization of
P to address the numerical accuracy/stability problems.</p>
<p><img alt="image117" class="image" src="_images/dwh1554997051814.png" /></p>
<div class="image imagecenter figure align-default" id="dfn1543222970064-image-d24-wrz-whb">
<img alt="" src="_images/aov1559042986742.svg" /></div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image118" class="image imagecenter" src="_images/zxo1559043147066.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image119" class="image imagecenter" src="_images/qmc1559043175425.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p class="rubric">Example for Kalman Filter</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Control Flag</span>
    <span class="n">INIT_EN</span>      <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">TIMEUPDATE_EN</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">MEASUPDATE_EN</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">XOUT_EN_TU</span>  <span class="o">=</span> <span class="mi">8</span><span class="p">;</span> <span class="n">UDOUT_EN_TU</span>    <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="n">XOUT_EN_MU</span>    <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
    <span class="n">UDOUT_EN_MU</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span> <span class="n">EKF_MEM_OPT</span>   <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
    <span class="c1">//Load A_mat,B_mat,Uq_mat,Dq_mat,H_mat,X0_mat,U0_mat,D0_mat,R_mat</span>
    <span class="c1">//Initialization</span>
<span class="n">KalmanFilter</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span>  <span class="n">H_mat</span><span class="p">,</span> <span class="n">X0_mat</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">u_mat</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">INIT_EN</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">iteration</span><span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">iteration</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//Load u_mat (control input)</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span><span class="n">C_CTRL</span><span class="p">;</span> <span class="n">index</span> <span class="o">++</span><span class="p">)</span>
        <span class="n">u_mat</span><span class="p">.</span><span class="n">write_float</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">control_input</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>

<span class="c1">//Time Update</span>
<span class="n">KalmanFilter</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span>  <span class="n">H_mat</span><span class="p">,</span> <span class="n">X0_mat</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">u_mat</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">TIMEUPDATE_EN</span> <span class="o">+</span> <span class="n">XOUT_EN_TU</span> <span class="o">+</span> <span class="n">UDOUT_EN_TU</span><span class="p">);</span>

<span class="c1">//Load y_mat (measurement vector)</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span><span class="n">M_MEAS</span><span class="p">;</span> <span class="n">index</span> <span class="o">++</span><span class="p">)</span>
        <span class="n">y_mat</span><span class="p">.</span><span class="n">write_float</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">control_input</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>

<span class="c1">//Measurement Update</span>
<span class="n">KalmanFilter</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span>  <span class="n">H_mat</span><span class="p">,</span> <span class="n">X0_mat</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">u_mat</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">MEASUPDATE_EN</span> <span class="o">+</span> <span class="n">XOUT_EN_MU</span> <span class="o">+</span> <span class="n">UDOUT_EN_MU</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">M_MEAS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">C_CTRL</span><span class="p">,</span> <span class="n">Int</span>  <span class="n">MTU</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MMU</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">EKF_EN</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">KalmanFilter</span> <span class="p">(</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">A_mat</span><span class="p">,</span>
<span class="cp">#if KF_C!=0</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">C_CTRL</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>   <span class="o">&amp;</span><span class="n">B_mat</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">Uq_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>        <span class="o">&amp;</span><span class="n">Dq_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">M_MEAS</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>   <span class="o">&amp;</span><span class="n">H_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>        <span class="o">&amp;</span><span class="n">X0_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">U0_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>        <span class="o">&amp;</span><span class="n">D0_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">M_MEAS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>         <span class="o">&amp;</span><span class="n">R_mat</span><span class="p">,</span>
<span class="cp">#if KF_C!=0</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">C_CTRL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>         <span class="o">&amp;</span><span class="n">u_mat</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">M_MEAS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>         <span class="o">&amp;</span><span class="n">y_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>        <span class="o">&amp;</span><span class="n">Xout_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">Uout_mat</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">N_STATE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span>        <span class="o">&amp;</span><span class="n">Dout_mat</span><span class="p">,</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">flag</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>Table . Kalman Filter Parameter Description</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 6%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Parameter</p></th>
<th class="head" colspan="3"><p>Used (?) or Unused (X)</p></th>
<th class="head" rowspan="2"><p>Description</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Initialization</p></th>
<th class="head"><p>Time Update</p></th>
<th class="head"><p>Measurement Update</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>N_STATE</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of state variable; possible options are 1 to 128</p></td>
</tr>
<tr class="row-even"><td><p>M_MEAS</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of measurement variable; possible options are 1 to 128; M_MEAS must be less than or equal to N_STATE. In case of Extended Kalman Filter(EKF), M_MEAS should be 1.</p></td>
</tr>
<tr class="row-odd"><td><p>C_CTRL</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of control variable; possible options are 0 to 128; C_CTRL must be less than or equal to N_STATE. In case of EKF, C_CTRL should be 1.</p></td>
</tr>
<tr class="row-even"><td><p>MTU</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of multipliers used in time update; possible options are 1 to 128; MTU must be less than or equal to N_STATE</p></td>
</tr>
<tr class="row-odd"><td><p>MMU</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of multipliers used in Measurement update; possible options are 1 to 128; MMU must be less than or equal to N_STATE</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>URAM enable; possible options are 0 and 1</p></td>
</tr>
<tr class="row-odd"><td><p>EKF_EN</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Extended Kalman Filter Enable; possible options are 0 and 1</p></td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Type of input pixel. Currently, only XF_32FC1 is supported.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Number of pixels to be processed per cycle; possible option is XF_NPPC1 (NOT relevant for this function)</p></td>
</tr>
<tr class="row-even"><td><p>A_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>Transition matrix A. In case of EKF, Jacobian Matrix F is mapped to A_mat.</p></td>
</tr>
<tr class="row-odd"><td><p>B_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>Control matrix B. In case of KF, B_mat argument is not required when C_CTRL=0. And in case of EKF, Dummy matrix with size (N_STATE x 1) is mapped to B_mat.</p></td>
</tr>
<tr class="row-even"><td><p>Uq_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>U matrix for Process noise covariance matrix Q</p></td>
</tr>
<tr class="row-odd"><td><p>Dq_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>D matrix for Process noise covariance matrix Q(only diagonal elements)</p></td>
</tr>
<tr class="row-even"><td><p>H_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>Measurement Matrix H. In case of EKF, Jacobian Matrix H is mapped to H_mat.</p></td>
</tr>
<tr class="row-odd"><td><p>X0_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>Initial state matrix. In case of EKF, state transition function f is mapped to X0_mat.</p></td>
</tr>
<tr class="row-even"><td><p>U0_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>U matrix for initial error estimate covariance matrix P</p></td>
</tr>
<tr class="row-odd"><td><p>D0_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>D matrix for initial error estimate covariance matrix P(only diagonal elements)</p></td>
</tr>
<tr class="row-even"><td><p>R_mat</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>Measurement noise covariance matrix R(only diagonal elements). In case of EKF, input only one value of R since M_MEAS=1.</p></td>
</tr>
<tr class="row-odd"><td><p>u_mat</p></td>
<td><p>X</p></td>
<td><p>?</p></td>
<td><p>X</p></td>
<td><p>Control input vector. In case of KF, u_mat argument is not required when C_CTRL=0. And in case of EKF, observation function h is mapped to u_mat.</p></td>
</tr>
<tr class="row-even"><td><p>y_mat</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>?</p></td>
<td><p>Measurement vector. In case of EKF, input only one measurement since M_MEAS=1.</p></td>
</tr>
<tr class="row-odd"><td><p>Xout_mat</p></td>
<td><p>X</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Output state matrix</p></td>
</tr>
<tr class="row-even"><td><p>Uout_mat</p></td>
<td><p>X</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>U matrix for output error estimate covariance matrix P</p></td>
</tr>
<tr class="row-odd"><td><p>Dout_mat</p></td>
<td><p>X</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>D matrix for output error estimate covariance matrix P(only diagonal elements)</p></td>
</tr>
<tr class="row-even"><td><p>flag</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>Control flag register</p></td>
</tr>
<tr class="row-odd"><td colspan="5"><p>All U, D counterparts of all initialized matrices (Q and P) are obtained using U-D factorization</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id215">
<caption><span class="caption-text">Table . Control Flag Registers</span><a class="headerlink" href="#id215" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Flag bit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Initialization enable</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Time update enable</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Measurement update enable</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>X<sub>out</sub> enable for time
update</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>U<sub>out</sub>/D:sub:<cite>out</cite> enable
for time update</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>X<sub>out</sub> enables for
measurement update</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>U<sub>out</sub>/D:sub:<cite>out</cite> enable
for measurement update</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>Read optimization (Uq_mat,
Dq_mat, U0_mat, D0_mat and R_mat)
for Extended Kalman Filter</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 34%" />
<col style="width: 31%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="3"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>N_STATE=128; C_CTRL=128; M_MEAS=128; MTU=24; MMU=24</p></th>
<th class="head"><p>N_STATE=64; C_CTRL=64; M_MEAS=12;MTU=16;MMU=16</p></th>
<th class="head"><p>N_STATE=5; C_CTRL=1; M_MEAS=3;MTU=2;MMU=2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>300 MHz</p></td>
<td><p>300 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>387</p></td>
<td><p>142</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>896</p></td>
<td><p>548</p></td>
<td><p>87</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>208084</p></td>
<td><p>128262</p></td>
<td><p>34887</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>113556</p></td>
<td><p>70942</p></td>
<td><p>18141</p></td>
</tr>
</tbody>
</table>
<p>The following table shows the resource utilization of the kernel for a
configuration with USE_URAM enable, generated using Vivado HLS 2019.1 for the
Xilinx xczu7ev-ffvc1156-2-e FPGA.</p>
<table class="docutils align-default" id="id216">
<caption><span class="caption-text">Table . Resource Utilization with UltraRAM Enabled</span><a class="headerlink" href="#id216" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Resource</p></th>
<th class="head"><p>Resource Utilization (N_STATE=64;
C_CTRL=64; M_MEAS=12; MTU=4;
MMU=4) (300 MHz) (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>284</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>99210</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>53939</p></td>
</tr>
<tr class="row-even"><td><p>URAM</p></td>
<td><p>11</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table shows the performance of kernel for different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx®
Xczu9eg-ffvb1156-1, for one iteration. Latency estimate is calculated by
taking average latency of 100 iteration.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 29%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Operating Frequency (MHz)</p></th>
<th class="head"><p>Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>N_STATE=128; C_CTRL=128; M_MEAS=128; MTU=24; MMU=24</p></td>
<td><p>300</p></td>
<td><p>0.7</p></td>
</tr>
<tr class="row-even"><td><p>N_STATE=64; C_CTRL=64; M_MEAS=12; MTU=16; MMU=16</p></td>
<td><p>300</p></td>
<td><p>0.12</p></td>
</tr>
<tr class="row-odd"><td><p>N_STATE=5; C_CTRL=1; M_MEAS=3; MTU=2; MMU=2</p></td>
<td><p>300</p></td>
<td><p>0.04</p></td>
</tr>
</tbody>
</table>
<p>The following table shows the performance of kernel for a configuration
with UltraRAM enable, as generated using Vivado HLS 2019.1 tool for the Xilinx
xczu7ev-ffvc1156-2-e, for one iteration. Latency estimate is calculated
by taking average latency of 100 iteration.</p>
<table class="docutils align-default" id="id217">
<caption><span class="caption-text">Table . Performance Estimate with UltraRAM</span><a class="headerlink" href="#id217" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>N_STATE=64;
C_CTRL=64;
M_MEAS=12;MTU=4;MMU=
4</p></td>
<td><p>300</p></td>
<td><p>0.25</p></td>
</tr>
</tbody>
</table>
<div class="section" id="extended-kalman-filter">
<span id="id70"></span><h3>Extended Kalman Filter<a class="headerlink" href="#extended-kalman-filter" title="Permalink to this headline">¶</a></h3>
<p>The Kalman filter estimates the state vector in a linear model. If the
model is nonlinear, then a linearization procedure is performed to
obtain the filtering equations. The Kalman filter so obtained will be
called the Extended Kalman filter. A state-space description of
non-linear system can have a non-linear model of the form:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image120" class="image imagecenter" src="_images/bul1559043590548.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image121" class="image imagecenter" src="_images/pum1559043643924.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Where f<sub>k</sub> and h<sub>k</sub> are valued functions with ranges in
R<sup>n</sup> and R<sup>q</sup>, respectively. 1≤q≤n, and T<sub>k</sub> a
matrix-valued function with range in R<sup>n</sup>xR<sup>q</sup> such that
for each k the first order partial derivatives of f<sub>k</sub>
(x:sub:<cite>k</cite>) and h<sub>k</sub> (x:sub:<cite>k</cite>) with respect to all the
components of x<sub>k</sub> are continuous. We consider zero-mean Gaussian
white noise sequences <img alt="image122" class="image" src="_images/ose1554996999042.png" /> and <img alt="image123" class="image" src="_images/ztb1554997245160.png" /> with ranges in
R<sup>p</sup> and R<sup>q</sup> respectively, 1≤p, q≤n.</p>
<div class="line-block">
<div class="line">The real-time linearization process is carried out as shown in the
following equations. In the lines of the linear model, the initial
estimate and predicted position are chosen to be:</div>
<div class="line"><br /></div>
</div>
<p><img alt="image124" class="image imagecenter" src="_images/esk1559043764293.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Then, <img alt="image125" class="image" src="_images/kne1559043826810.svg" />, consecutively, for k=1,2,…, use the predicted
positions.</div>
<div class="line"><br /></div>
</div>
<p><img alt="image126" class="image imagecenter" src="_images/vsn1559043927693.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple">
<li><p><img alt="image127" class="image" src="_images/yei1559108493186.svg" />, where <img alt="image128" class="image" src="_images/wip1559108542187.svg" />, k is a time index and superscript is
row index and <img alt="image129" class="image" src="_images/ooa1559108606429.svg" /></p></li>
<li><p><img alt="image130" class="image" src="_images/hwd1559108701545.svg" /> is a space of column vectors <img alt="image131" class="image" src="_images/gua1559108773758.svg" /></p></li>
</ol>
<div class="line-block">
<div class="line">The equation for time update computations is as follows:</div>
<div class="line"><br /></div>
</div>
<p><img alt="image132" class="image imagecenter" src="_images/fpc1559108827886.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image133" class="image" src="_images/dna1559109031228.svg" /></div>
</div>
<div class="line-block">
<div class="line">The equation for measurement update computations is as follows:</div>
<div class="line"><br /></div>
</div>
<p><img alt="image134" class="image imagecenter" src="_images/ykm1559109115292.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image135" class="image imagecenter" src="_images/ghx1559109180151.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><img alt="image136" class="image imagecenter" src="_images/esm1559109211624.svg" /></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="example-for-extended-kalman-filter">
<h4>Example for Extended Kalman Filter<a class="headerlink" href="#example-for-extended-kalman-filter" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Load F/B_mat/Uq_mat/Dq_mat/X0_mat/U0_mat/D0_mat</span>

<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">iteration</span><span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">iteration</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">iteration</span> <span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">model_fx</span><span class="p">(</span><span class="n">X0_mat</span><span class="p">,</span> <span class="n">fx</span><span class="p">);</span><span class="c1">// update fx using X0_mat</span>
    <span class="k">else</span>
<span class="nf">model_fx</span><span class="p">(</span><span class="n">Xout_mat</span><span class="p">,</span> <span class="n">fx</span><span class="p">);</span> <span class="c1">// update fx using Xout_mat</span>

        <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">initFlag</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">iteration</span> <span class="o">==</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">initFlag</span> <span class="o">=</span> <span class="n">INIT_EN</span><span class="p">;</span>
        <span class="k">else</span>
            <span class="n">initFlag</span> <span class="o">=</span> <span class="n">EKF_MEM_OPT</span><span class="o">+</span><span class="n">INIT_EN</span><span class="p">;</span>

        <span class="c1">//Initialization</span>
<span class="n">KalmanFilter</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">initFlag</span><span class="p">);</span>

        <span class="c1">//Time Update</span>
<span class="n">KalmanFilter</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">TIMEUPDATE_EN</span> <span class="o">+</span> <span class="n">XOUT_EN_TU</span> <span class="o">+</span> <span class="n">UDOUT_EN_TU</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">index</span><span class="o">&lt;</span> <span class="n">M_MEAS</span><span class="p">;</span> <span class="n">index</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="n">iteration</span> <span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">// update hx/H using X0_mat for one measurement at a time</span>
            <span class="n">model_hxH</span><span class="p">(</span><span class="n">X0_mat</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">index</span><span class="p">);</span>
        <span class="k">else</span>
        <span class="c1">//update hx/H using Xout_mat for one measurement at a time</span>
<span class="n">model_hxH</span><span class="p">(</span><span class="n">Xout_mat</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">index</span><span class="p">);</span>

<span class="c1">//Load R_mat</span>
            <span class="n">R_mat</span><span class="p">.</span><span class="n">write_float</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">R_matrix</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">index</span><span class="p">]);</span>

            <span class="c1">//Load y_mat</span>
            <span class="n">Y_mat</span><span class="p">.</span><span class="n">write_float</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">measurement_vector</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>

<span class="c1">//Measurement Update</span>
<span class="n">KalmanFilter</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">B_mat</span><span class="p">,</span> <span class="n">Uq_mat</span><span class="p">,</span> <span class="n">Dq_mat</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">U0_mat</span><span class="p">,</span> <span class="n">D0_mat</span><span class="p">,</span> <span class="n">R_mat</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="n">y_mat</span><span class="p">,</span> <span class="n">Xout_mat</span><span class="p">,</span> <span class="n">Uout_mat</span><span class="p">,</span> <span class="n">Dout_mat</span><span class="p">,</span> <span class="n">MEASUPDATE_EN</span> <span class="o">+</span> <span class="n">XOUT_EN_MU</span> <span class="o">+</span> <span class="n">UDOUT_EN_MU</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="laplacian-operator">
<h2>Laplacian Operator<a class="headerlink" href="#laplacian-operator" title="Permalink to this headline">¶</a></h2>
<p>This function calculates the Laplacian of the input image. This function internally uses the filter2D kernel to compute the Laplacian.
The filter coefficients are calculated using cv::getDerivKernels OpenCV function on the host side.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_WIDTH</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">filter2D</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">short</span> <span class="kt">int</span> <span class="n">filter</span><span class="p">[</span><span class="n">FILTER_HEIGHT</span><span class="o">*</span><span class="n">FILTER_WIDTH</span><span class="p">],</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_shift</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id218">
<caption><span class="caption-text">Table filter2D Parameter Description</span><a class="headerlink" href="#id218" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>FILTER_HEIGHT</p></td>
<td><p>Number of rows in the input filter</p></td>
</tr>
<tr class="row-even"><td><p>FILTER_WIDTH</p></td>
<td><p>Number of columns in the input filter</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit unsigned single and 3
channels (XF_8UC1, XF_8UC3) and 16-bit signed
single and 3 channels (XF_16SC1, XF_16SC3)
supported.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8 pixel mode.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle;
possible options are XF_NPPC1 and XF_NPPC8 for 1
pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>filter</p></td>
<td><p>The input filter of any size, provided the
dimensions should be an odd number. The filter
co-efficients either a 16-bit value or a 16-bit
fixed point equivalent value.</p></td>
</tr>
<tr class="row-odd"><td><p>_shift</p></td>
<td><p>The filter must be of type XF_16SP. If the
co-efficients are floating point, it must be
converted into the Qm.n and provided as the input
as well as the shift parameter has to be set with
the ‘n’ value. Else, if the input is not of
floating point, the filter is provided directly
and the shift parameter is set to zero.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>1701</p></td>
<td><p>1161</p></td>
<td><p>269</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>25</p></td>
<td><p>3115</p></td>
<td><p>2144</p></td>
<td><p>524</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>8 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>6</p></td>
<td><p>72</p></td>
<td><p>2783</p></td>
<td><p>2768</p></td>
<td><p>638</p></td>
</tr>
<tr class="row-even"><td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>10</p></td>
<td><p>216</p></td>
<td><p>3020</p></td>
<td><p>4443</p></td>
<td><p>1007</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3 Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 15%" />
<col style="width: 27%" />
<col style="width: 22%" />
<col style="width: 11%" />
<col style="width: 4%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>18</p></td>
<td><p>27</p></td>
<td><p>886</p></td>
<td><p>801</p></td>
</tr>
<tr class="row-even"><td><p>8 Pixel</p></td>
<td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>30</p></td>
<td><p>75</p></td>
<td><p>1793</p></td>
<td><p>1445</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating
Frequency
(MHz)</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>3x3</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>5x5</p></td>
<td><p>7.1</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>3x3</p></td>
<td><p>1.86</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>5x5</p></td>
<td><p>1.86</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="lens-shading-correction">
<span id="lensshadingcorrection"></span><h2>Lens shading correction<a class="headerlink" href="#lens-shading-correction" title="Permalink to this headline">¶</a></h2>
<p>Vignetting/Lensshading refers to the fall-off pixel intensity from the centre towards the edges of the image.
In this algorithm, vignette is corrected by considering the distance between the centre pixel and actual image pixel position. This distance is used to calculate intensity gain per pixel per channel which is used for the correction.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Lscdistancebased</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">dst</span><span class="p">)</span> <span class="p">{</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes template parameters and arguments to the function.</p>
<table class="docutils align-default" id="id219">
<caption><span class="caption-text">Table Lensshading correction Parameter Description</span><a class="headerlink" href="#id219" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8/10/12/16-bit, unsigned, 3 channel is
supported (XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3).</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8/10/12/16-bit, unsigned, 3 channel is
supported (XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1, XF_NPPC2 AND so on</p></td>
</tr>
<tr class="row-odd"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations, generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id220">
<caption><span class="caption-text">Table Lensshading correction Resource Utilization Summary</span><a class="headerlink" href="#id220" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel-8U</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>26</p></td>
<td><p>4198</p></td>
<td><p>3628</p></td>
<td><p>889</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel-16U</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>26</p></td>
<td><p>4253</p></td>
<td><p>3602</p></td>
<td><p>770</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vitis HLS 2020.2 tool, to process a FULL HD image.</p>
<table class="docutils align-default" id="id221">
<caption><span class="caption-text">Table Lensshading correction Function Performance Estimate Summary</span><a class="headerlink" href="#id221" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 28%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Latency Estimate
<strong>Max (ms)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>3.6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="local-tone-mapping">
<span id="id71"></span><h2>Local Tone Mapping<a class="headerlink" href="#local-tone-mapping" title="Permalink to this headline">¶</a></h2>
<p>Most of the display devices have limited dynamic range. Hence images with wide dynamic range cannot be seen natively on such devices. To see wide dynamic range images on devices with low dynamic range, we need to compress the wide dynamic range of image to a low dynamic range. This process is called as tone-mapping.</p>
<p>Local tone mapping takes pixel neighbor statistics into account, and produces images with more contrast and brightness.</p>
<p>This implementaion is based on the algorithm proposed by J. Yang, A. Hore and O. Yadid-Pecht.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">LTM</span> <span class="n">Class</span> <span class="nl">API</span><span class="p">:</span>

<span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">IN_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">OUT_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BLOCK_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BLOCK_WIDTH</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="n">class</span> <span class="n">LTM</span> <span class="p">{}</span>

<span class="n">Processing</span> <span class="n">member</span> <span class="nl">function</span><span class="p">:</span>

<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">LTM</span><span class="o">&lt;</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">OUT_TYPE</span><span class="p">,</span> <span class="n">BLOCK_HEIGHT</span><span class="p">,</span> <span class="n">BLOCK_WIDTH</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;::</span><span class="n">process</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">in</span><span class="p">,</span>
                     <span class="kt">int</span> <span class="n">block_rows</span><span class="p">,</span>
                     <span class="kt">int</span> <span class="n">block_cols</span><span class="p">,</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omin_r</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omax_r</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omin_w</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omax_w</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">OUT_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">out</span><span class="p">)</span>

<span class="n">Overlaoded</span> <span class="n">processing</span> <span class="n">member</span> <span class="nl">function</span><span class="p">:</span>

<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">LTM</span><span class="o">&lt;</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">OUT_TYPE</span><span class="p">,</span> <span class="n">BLOCK_HEIGHT</span><span class="p">,</span> <span class="n">BLOCK_WIDTH</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;::</span><span class="n">process</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">in</span><span class="p">,</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omin_r</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omax_r</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omin_w</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">XF_CTUNAME</span><span class="p">(</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">NPC</span><span class="p">)</span> <span class="n">omax_w</span><span class="p">[</span><span class="n">MinMaxVArrSize</span><span class="p">][</span><span class="n">MinMaxHArrSize</span><span class="p">],</span>
                     <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">OUT_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<p>Descriptions</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IN_TYPE</p></td>
<td><p>Input pixel type. The current supported pixel value is
XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3, XF_32FC3</p></td>
</tr>
<tr class="row-odd"><td><p>OUT_TYPE</p></td>
<td><p>Input pixel type. The current supported pixel value is
XF_8UC3, XF_10UC3, XF_12UC3, XF_16UC3</p></td>
</tr>
<tr class="row-even"><td><p>BLOCK_WIDTH</p></td>
<td><p>Max block width the image is divided into.
This can be any positive integer greater than or
equal to 32 and less than input image width.</p></td>
</tr>
<tr class="row-odd"><td><p>BLOCK_HEIGHT</p></td>
<td><p>Max block height the image is divided into.
This can be any positive integer greater than or
equal to 32 and less than input image height.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum number of rows of the input image that the
hardware kernel must be built for.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum number of columns of the input image that the
hardware kernel must be built for.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to process per cycle. Supported
values are XF_NPPC1, XF_NPPC2, XF_NPPC4, XF_NPPC8.</p></td>
</tr>
<tr class="row-odd"><td><p>in</p></td>
<td><p>Input HDR image</p></td>
</tr>
<tr class="row-even"><td><p>block_rows</p></td>
<td><p>Actual block height</p></td>
</tr>
<tr class="row-odd"><td><p>block_cols</p></td>
<td><p>Actual block width</p></td>
</tr>
<tr class="row-even"><td><p>omin_r</p></td>
<td><p>Array of min values to be read by the next frame.</p></td>
</tr>
<tr class="row-odd"><td><p>omax_r</p></td>
<td><p>Array of max values to be read by the next frame.</p></td>
</tr>
<tr class="row-even"><td><p>omin_w</p></td>
<td><p>Array of min values computed in the current frame.</p></td>
</tr>
<tr class="row-odd"><td><p>omax_w</p></td>
<td><p>Array of max values computed in the current frame.</p></td>
</tr>
<tr class="row-even"><td><p>out</p></td>
<td><p>Output HDR image</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of
LocalToneMapping for a 4K image, as generated in the Vitis HLS
2020.2 version tool for the Xilinx xcu200-fsgd2104-2-e FPGA at 300MHz.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUTs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>123</p></td>
<td><p>35216</p></td>
<td><p>20246</p></td>
</tr>
<tr class="row-even"><td><p>4 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>330</p></td>
<td><p>67457</p></td>
<td><p>40391</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of the
LocalToneMapping function for a 4K image, generated using Vitis
HLS 2020.2 version tool for the Xilinx xcu200-fsgd2104-2-e FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-even"><td><p>4 pixel</p></td>
<td><p>300</p></td>
<td><p>1.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="look-up-table">
<span id="id72"></span><h2>Look Up Table<a class="headerlink" href="#look-up-table" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">LUT</span></code> function performs the table lookup operation. Transforms the
source image into the destination image using the given look-up table.
The input image must be of depth XF_8UP and the output image of same
type as input image.</p>
<p>I<sub>out</sub>(x, y) = LUT [I:sub:<cite>in1</cite>(x, y)]</p>
<p>Where:</p>
<ul class="simple">
<li><p>I<sub>out</sub>(x, y) is the intensity of output image at (x, y)
position</p></li>
<li><p>I<sub>in</sub>(x, y) is the intensity of first input image at (x, y)
position</p></li>
<li><p>LUT is the lookup table of size 256 and type unsigned char.</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">LUT</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">_lut</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id222">
<caption><span class="caption-text">Table . LUT Parameter Description</span><a class="headerlink" href="#id222" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1 and
3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed. Must be
a multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed in parallel. Possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image of size (ROWS, COLS) and type 8U.</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image of size (ROWS, COLS) and same type as
input.</p></td>
</tr>
<tr class="row-even"><td><p>_lut</p></td>
<td><p>Input lookup Table of size 256 and type unsigned char.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the LUT
function, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>937</p></td>
<td><p>565</p></td>
<td><p>137</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>9</p></td>
<td><p>0</p></td>
<td><p>1109</p></td>
<td><p>679</p></td>
<td><p>162</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the LUT
function, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process 4K 3Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>4</p></td>
<td><p>0</p></td>
<td><p>1160</p></td>
<td><p>648</p></td>
<td><p>175</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.92</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.66</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mean-and-standard-deviation">
<span id="ariaid-title95"></span><h2>Mean and Standard Deviation<a class="headerlink" href="#mean-and-standard-deviation" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">meanStdDev</span></code> function computes the mean and standard deviation of
input image. The output Mean value is in fixed point Q8.8 format, and
the Standard Deviation value is in Q8.8 format. Mean and standard
deviation are calculated as follows:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image137" class="image" src="_images/hib1554997370155.png" /></div>
<div class="line"><img alt="image138" class="image" src="_images/twe1554997326248.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">meanStdDev</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="o">*</span> <span class="n">_mean</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="o">*</span> <span class="n">_stddev</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id223">
<caption><span class="caption-text">Table . meanStdDev Parameter Description</span><a class="headerlink" href="#id223" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed. Must be
a multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_mean</p></td>
<td><p>16-bit data pointer through which the computed mean of
the image is returned.</p></td>
</tr>
<tr class="row-even"><td><p>_stddev</p></td>
<td><p>16-bit data pointer through which the computed standard
deviation of the image is returned.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
meanStdDev function, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>6</p></td>
<td><p>896</p></td>
<td><p>461</p></td>
<td><p>121</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>13</p></td>
<td><p>1180</p></td>
<td><p>985</p></td>
<td><p>208</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the
meanStdDev function, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 29%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
<td><p>5075</p></td>
<td><p>3324</p></td>
<td><p>725</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9 ms</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.69 ms</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="max">
<span id="id73"></span><h2>Max<a class="headerlink" href="#max" title="Permalink to this headline">¶</a></h2>
<p>The Max function calculates the per-element maximum of two corresponding
images src1, src2 and stores the result in dst.</p>
<p>dst(x,y)=max( src1(x,y) ,src2(x,y) )</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">max</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id224">
<caption><span class="caption-text">Table . Max Parameter Description</span><a class="headerlink" href="#id224" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-odd"><td><p>_src2</p></td>
<td><p>Second input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Max
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>150 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>103</p></td>
<td><p>153</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>44</p></td>
<td><p>102</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>21</p></td>
<td><p>38</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="maxs">
<span id="id74"></span><h2>MaxS<a class="headerlink" href="#maxs" title="Permalink to this headline">¶</a></h2>
<p>The MaxS function calculates the maximum elements between src and given
scalar value scl and stores the result in dst.</p>
<p>dst(I)=maxS( src(I) ,scl )</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">maxS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id225">
<caption><span class="caption-text">Table . MaxS Parameter Description</span><a class="headerlink" href="#id225" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Input scalar value, the size should be number of
channels</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the MaxS
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>150 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>162</p></td>
<td><p>43</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>103</p></td>
<td><p>104</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>32</p></td>
<td><p>20</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="median-blur-filter">
<span id="id75"></span><h2>Median Blur Filter<a class="headerlink" href="#median-blur-filter" title="Permalink to this headline">¶</a></h2>
<p>The function medianBlur performs a median filter operation on the input
image. The median filter acts as a non-linear digital filter which
improves noise reduction. A filter size of N would output the median
value of the NxN neighborhood pixel values, for each pixel.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTER_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">medianBlur</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id226">
<caption><span class="caption-text">Table . medianBlur Parameter Description</span><a class="headerlink" href="#id226" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_SIZE</p></td>
<td><p>Window size of the hardware filter for which the
hardware kernel will be built. This can be any odd
positive integer greater than 1.</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>The way in which borders will be processed in the
hardware kernel. Currently, only XF_BORDER_REPLICATE
is supported.</p></td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed. Must
be a multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed in parallel. Options
are XF_NPPC1 (for 1 pixel processing per clock),
XF_NPPC8 (for 8 pixel processing per clock</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image.</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
medianBlur function for XF_NPPC1 and XF_NPPC8 configurations, generated
using Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1
FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 14%" />
<col style="width: 23%" />
<col style="width: 24%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>FILTER_SIZE</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3</p></td>
<td><p>300</p></td>
<td><p>1197</p></td>
<td><p>771</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>3</p></td>
<td><p>150</p></td>
<td><p>6559</p></td>
<td><p>1595</p></td>
<td><p>0</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>5</p></td>
<td><p>300</p></td>
<td><p>5860</p></td>
<td><p>1886</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the
medianBlur function for XF_NPPC1 with 3channel image as input, generated
using Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1
FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 14%" />
<col style="width: 23%" />
<col style="width: 24%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>FILTER_SIZE</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3</p></td>
<td><p>300</p></td>
<td><p>2100</p></td>
<td><p>1971</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>5</p></td>
<td><p>300</p></td>
<td><p>13541</p></td>
<td><p>9720</p></td>
<td><p>0</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of medianBlur
function on Vivado HLS 2019.1 version tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 15%" />
<col style="width: 24%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>FILTER_SIZE</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" rowspan="2"><p>Input Image Size</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>6.99</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>3</p></td>
<td><p>150</p></td>
<td><p>1920x1080</p></td>
<td><p>1.75</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>5</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>7.00</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="min">
<span id="id76"></span><h2>Min<a class="headerlink" href="#min" title="Permalink to this headline">¶</a></h2>
<p>The Min function calculates the per element minimum of two corresponding
images src1, src2 and stores the result in dst.</p>
<p>dst(I)=min( src1(I) ,src2(I) )</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">min</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src2</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id227">
<caption><span class="caption-text">Table . Min Parameter Description</span><a class="headerlink" href="#id227" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle, possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-odd"><td><p>_src2</p></td>
<td><p>Second input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Min
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>150 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>103</p></td>
<td><p>153</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>44</p></td>
<td><p>102</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>23</p></td>
<td><p>34</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mins">
<span id="id77"></span><h2>MinS<a class="headerlink" href="#mins" title="Permalink to this headline">¶</a></h2>
<p>The MinS function calculates the minimum elements between src and given
scalar value scl and stores the result in dst.</p>
<p>dst(x,y)=minS( src(x,y) ,scl )</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">minS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id228">
<caption><span class="caption-text">Table . MinS Parameter Description</span><a class="headerlink" href="#id228" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Input scalar value, the size should be the number of
channels.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the MinS
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>150 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>104</p></td>
<td><p>159</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>43</p></td>
<td><p>103</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>23</p></td>
<td><p>36</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="minmax-location">
<span id="id78"></span><h2>MinMax Location<a class="headerlink" href="#minmax-location" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">minMaxLoc</span></code> function finds the minimum and maximum values in an
image and location of those values.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><img alt="image139" class="image" src="_images/iaw1554997366517.png" /></div>
<div class="line"><img alt="image140" class="image" src="_images/dxr1554997112819.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">minMaxLoc</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span><span class="kt">int32_t</span> <span class="o">*</span><span class="n">max_value</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="o">*</span><span class="n">min_value</span><span class="p">,</span><span class="kt">uint16_t</span> <span class="o">*</span><span class="n">_minlocx</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="o">*</span><span class="n">_minlocy</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="o">*</span><span class="n">_maxlocx</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="o">*</span><span class="n">_maxlocy</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id229">
<caption><span class="caption-text">Table . minMaxLoc Parameter Description</span><a class="headerlink" href="#id229" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel
(XF_8UC1), 16-bit, unsigned, 1 channel (XF_16UC1),
16-bit, signed, 1 channel (XF_16SC1), 32-bit, signed,
1 channel (XF_32SC1) are supported.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>max_val</p></td>
<td><p>Maximum value in the image, of type int.</p></td>
</tr>
<tr class="row-even"><td><p>min_val</p></td>
<td><p>Minimum value in the image, of type int.</p></td>
</tr>
<tr class="row-odd"><td><p>_minlocx</p></td>
<td><p>x-coordinate location of the first minimum value.</p></td>
</tr>
<tr class="row-even"><td><p>_minlocy</p></td>
<td><p>y-coordinate location of the first minimum value.</p></td>
</tr>
<tr class="row-odd"><td><p>_maxlocx</p></td>
<td><p>x-coordinate location of the first maximum value.</p></td>
</tr>
<tr class="row-even"><td><p>_maxlocy</p></td>
<td><p>y-coordinate location of the first maximum value.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the minMaxLoc
function, generated using Vivado HLS 2019.1 tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 29%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>451</p></td>
<td><p>398</p></td>
<td><p>86</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>1049</p></td>
<td><p>1025</p></td>
<td><p>220</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.69</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mean-shift-tracking">
<span id="id79"></span><h2>Mean Shift Tracking<a class="headerlink" href="#mean-shift-tracking" title="Permalink to this headline">¶</a></h2>
<p>Mean shift tracking is one of the basic object tracking algorithms.
Mean-shift tracking tries to find the area of a video frame that is
locally most similar to a previously initialized model. The object to be
tracked is represented by a histogram. In object tracking algorithms
target representation is mainly rectangular or elliptical region. It
contains target model and target candidate. Color histogram is used to
characterize the object. Target model is generally represented by its
probability density function (pdf). Weighted RGB histogram is used to
give more importance to object pixels.</p>
<p>Mean-shift algorithm is an iterative technique for locating the maxima
of a density function. For object tracking, the density function used is
the weight image formed using color histograms of the object to be
tracked and the frame to be tested. By using the weighted histogram we
are taking spatial position into consideration unlike the normal
histogram calculation. This function will take input image pointer, top
left and bottom right coordinates of the rectangular object, frame
number and tracking status as inputs and returns the centroid using
recursive mean shift approach.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">MAXOBJ</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAXITERS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">OBJ_ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">OBJ_COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">MeanShift</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_in_mat</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">x1</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">y1</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">obj_height</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">obj_width</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">dy</span><span class="p">,</span> <span class="kt">uint16_t</span><span class="o">*</span> <span class="n">status</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">frame_status</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">no_objects</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">no_iters</span> <span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Template  Parameter Descriptions</p>
<p>The following table describes the template parameters.</p>
<p class="rubric">Function Parameter Description</p>
<p>The following table describes the function parameters.</p>
<table class="docutils align-default" id="id230">
<caption><span class="caption-text">Table . MeanShift Function Parameters</span><a class="headerlink" href="#id230" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>_in_mat</p></td>
<td><p>Input xF Mat</p></td>
</tr>
<tr class="row-odd"><td><p>x1</p></td>
<td><p>Top Left corner x-coordinate of all the objects</p></td>
</tr>
<tr class="row-even"><td><p>y1</p></td>
<td><p>Top Left corner y-coordinate of all the objects</p></td>
</tr>
<tr class="row-odd"><td><p>obj_height</p></td>
<td><p>Height of all the objects</p></td>
</tr>
<tr class="row-even"><td><p>obj_width</p></td>
<td><p>Width of all the objects</p></td>
</tr>
<tr class="row-odd"><td><p>dx</p></td>
<td><p>Centers x-coordinate of all the objects returned by
the kernel function</p></td>
</tr>
<tr class="row-even"><td><p>dy</p></td>
<td><p>Centers y-coordinate of all the objects returned by
the kernel function</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>Track the object only if the status of the object is
true, that is if the object goes out of the frame,
status is made zero</p></td>
</tr>
<tr class="row-even"><td><p>frame_status</p></td>
<td><p>Set as zero for the first frame and one for other
frames</p></td>
</tr>
<tr class="row-odd"><td><p>no_objects</p></td>
<td><p>Number of objects racked</p></td>
</tr>
<tr class="row-even"><td><p>no_iters</p></td>
<td><p>Number of iterations for convergence</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization and Performance Estimate</p>
<p>The following table summarizes the resource utilization of the MeanShift
function for normal (1 pixel) configuration as generated in Vivado HLS
2019.1 release tool for the part xczu9eg-ffvb1156-i-es1 at 300 MHz to
process a RGB image of resolution,1920x1080, and for 10 objects of size
of 250x250 and 4 iterations.</p>
<p>Performance Estimate Summary</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration</p></th>
<th class="head"><p>Max. Latency (ms)</p></th>
<th class="head"><p>BRAMs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>LUTs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>19.28</p></td>
<td><p>76</p></td>
<td><p>14</p></td>
<td><p>13198</p></td>
<td><p>10064</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="rubric">Limitations</p>
<p>The maximum number of objects that can be tracked is 10.</p>
</div>
<div class="section" id="mode-filter">
<span id="id80"></span><h2>Mode filter<a class="headerlink" href="#mode-filter" title="Permalink to this headline">¶</a></h2>
<p>Mode filter is a non-linear digital filter which improves noise reduction. This implements filter operation with given size of N by computing <strong>mode</strong> for all the pixels in an NxN window.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">FILTER_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">modefilter</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id231">
<caption><span class="caption-text">Table Mode filter Parameter Description</span><a class="headerlink" href="#id231" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_SIZE</p></td>
<td><p>Window size of the hardware filter for which the
hardware kernel will be built. This can be any odd
positive integer greater than 1.</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>The way in which borders will be processed in the
hardware kernel. Currently, only XF_BORDER_REPLICATE
is supported.</p></td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
or 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Number of rows in the image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Number of columns in the image being processed. Must
be a multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed in parallel. Options
are XF_NPPC1 (for 1 pixel processing per clock),
XF_NPPC8 (for 8 pixel processing per clock</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input image.</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
Mode filter function for XF_NPPC1 configurations, generated
using Vitis HLS 2020.2 version tool.</p>
<table class="docutils align-default" id="id232">
<caption><span class="caption-text">Table Mode filter Function Resource Utilization Summary</span><a class="headerlink" href="#id232" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 23%" />
<col style="width: 24%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>FILTER_SIZE</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3</p></td>
<td><p>300</p></td>
<td><p>628</p></td>
<td><p>900</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>5</p></td>
<td><p>300</p></td>
<td><p>2579</p></td>
<td><p>4070</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>7</p></td>
<td><p>300</p></td>
<td><p>7852</p></td>
<td><p>14065</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes performance estimates of Mode filter
function on Vitis HLS 2020.2 version tool.</p>
<table class="docutils align-default" id="id233">
<caption><span class="caption-text">Table Mode filter Function Performance Estimate Summary</span><a class="headerlink" href="#id233" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 15%" />
<col style="width: 24%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>FILTER_SIZE</p></th>
<th class="head"><p>Operating Frequency
(MHz)</p></th>
<th class="head"><p>Input Image Size</p></th>
<th class="head"><p>Latency Estimate
Max (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>3</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>6.99</p></td>
</tr>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>5</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>7.00</p></td>
</tr>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>7</p></td>
<td><p>300</p></td>
<td><p>1920x1080</p></td>
<td><p>7.15</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="otsu-threshold">
<span id="id81"></span><h2>Otsu Threshold<a class="headerlink" href="#otsu-threshold" title="Permalink to this headline">¶</a></h2>
<p>Otsu threshold is used to automatically perform clustering-based image
thresholding or the reduction of a gray-level image to a binary image.
The algorithm assumes that the image contains two classes of pixels
following bi-modal histogram (foreground pixels and background pixels),
it then calculates the optimum threshold separating the two classes.</p>
<p>Otsu method is used to find the threshold which can minimize the intra
class variance which separates two classes defined by weighted sum of
variances of two classes.</p>
<p><img alt="image141" class="image" src="_images/dgv1554997236233.png" /></p>
<p>Where, w_1is the class probability computed from the histogram.</p>
<p><img alt="image142" class="image" src="_images/mtz1554997245975.png" /></p>
<p>Otsu shows that minimizing the intra-class variance is the same as
maximizing inter-class variance</p>
<p><img alt="image143" class="image" src="_images/fvq1554997234186.png" />
<img alt="image144" class="image" src="_images/jwp1554997173866.png" /></p>
<p>Where,<img alt="image145" class="image" src="_images/lrg1554996994739.png" /> is the class mean.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">OtsuThreshold</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">&amp;</span><span class="n">_thresh</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id234">
<caption><span class="caption-text">Table . OtsuThreshold Parameter Description</span><a class="headerlink" href="#id234" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Paramete
r</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8 pixel
operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_ma
t</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_thresh</p></td>
<td><p>Output threshold value after the computation</p></td>
</tr>
</tbody>
</table>
<p>Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
OtsuThreshold function, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 29%" />
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>8</p></td>
<td><p>49</p></td>
<td><p>2239</p></td>
<td><p>3353</p></td>
<td><p>653</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>22</p></td>
<td><p>49</p></td>
<td><p>1106</p></td>
<td><p>3615</p></td>
<td><p>704</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.92</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.76</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="paintmask">
<span id="id82"></span><h2>Paintmask<a class="headerlink" href="#paintmask" title="Permalink to this headline">¶</a></h2>
<p>The Paintmask function replace the pixel intensity value with given
color value when mask is not zero or the corresponding pixel from the
input image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">MASK_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">paintmask</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">MASK_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">in_mask</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_color</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id235">
<caption><span class="caption-text">Table . Paintmask Parameter Description</span><a class="headerlink" href="#id235" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>MASK_T</p></td>
<td><p>Mask value type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_in_mask</p></td>
<td><p>Input mask image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>_color</p></td>
<td><p>Color value to be filled when mask is not zero</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Paintmask
Resource optimized (8 pixel) mode and normal mode as generated using
Vivado HLS 2019.1 version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td></td>
<td><p>300 MHz</p></td>
<td><p>150 MHz</p></td>
</tr>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>95</p></td>
<td><p>163</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>57</p></td>
<td><p>121</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>14</p></td>
<td><p>33</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 47%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Operating Frequency (MHz)</p></th>
<th class="head"><p>Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pixel-wise-addition">
<span id="id83"></span><h2>Pixel-Wise Addition<a class="headerlink" href="#pixel-wise-addition" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">add</span></code> function performs the pixel-wise addition between two input
images and returns the output image.</p>
<p><em>Iout(x, y) = Iin1(x, y) + Iin2(x, y)</em></p>
<p>Where:</p>
<ul class="simple">
<li><p><em>Iout(x, y)</em> is the intensity of the output image at (x, y)
position</p></li>
<li><p><em>Iin1(x, y)</em> is the intensity of the first input image at (x, y)
position</p></li>
<li><p><em>Iin2(x, y)</em> is the intensity of the second input image at (x, y)
position.</p></li>
</ul>
<p>XF_CONVERT_POLICY_TRUNCATE: Results are the least significant bits of
the output operand, as if stored in two’s complement binary format in
the size of its bit-depth.</p>
<p>XF_CONVERT_POLICY_SATURATE: Results are saturated to the bit depth of
the output operand.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">add</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id236">
<caption><span class="caption-text">Table . add Parameter Description</span><a class="headerlink" href="#id236" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>POLICY_TY
PE</p></td>
<td><p>Type of overflow handling. It can be either,
XF_CONVERT_POLICY_SATURATE or
XF_CONVERT_POLICY_TRUNCATE.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Pixel type. Options are XF_8UC1, XF_8UC3, XF_16SC3, and
XF_16SC1.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>55</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>65</p></td>
<td><p>138</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process 4K image with 3 channels.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 26%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>113</p></td>
<td><p>77</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pixel-wise-multiplication">
<span id="pixel-wise-multi"></span><h2>Pixel-Wise Multiplication<a class="headerlink" href="#pixel-wise-multiplication" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">multiply</span></code> function performs the pixel-wise multiplication between
two input images and returns the output image.</p>
<p>I<sub>out</sub>(x, y) = I<sub>in1</sub>(x, y) * I<sub>in2</sub>(x, y)
* scale_val</p>
<p>Where:</p>
<ul class="simple">
<li><p>I<sub>out</sub>(x, y) is the intensity of the output image at (x, y)
position</p></li>
<li><p>I<sub>in1</sub>(x, y) is the intensity of the first input image at
(x, y) position</p></li>
<li><p>I<sub>in2</sub>(x, y) is the intensity of the second input image at
(x, y) position</p></li>
<li><p>scale_val is the scale value.</p></li>
</ul>
<p>XF_CONVERT_POLICY_TRUNCATE: Results are the least significant bits of
the output operand, as if stored in two’s complement binary format in
the size of its bit-depth.</p>
<p>XF_CONVERT_POLICY_SATURATE: Results are saturated to the bit depth of
the output operand.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">multiply</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span><span class="p">,</span>
<span class="kt">float</span> <span class="n">scale</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id237">
<caption><span class="caption-text">Table . multiply Parameter Description</span><a class="headerlink" href="#id237" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>POLICY_TY
PE</p></td>
<td><p>Type of overflow handling. It can be either,
XF_CONVERT_POLICY_SATURATE or
XF_CONVERT_POLICY_TRUNCATE.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>pixel type. Options are XF_8UC1,XF_8UC3,XF_16SC1 and
XF_16SC3.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-even"><td><p>scale_val</p></td>
<td><p>Weighing factor within the range of 0 and 1</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 26%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>124</p></td>
<td><p>59</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>16</p></td>
<td><p>285</p></td>
<td><p>108</p></td>
<td><p>43</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K image with 3 channels.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 26%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>9</p></td>
<td><p>312</p></td>
<td><p>211</p></td>
<td><p>62</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pixel-wise-subtraction">
<span id="pixel-wise-sub"></span><h2>Pixel-Wise Subtraction<a class="headerlink" href="#pixel-wise-subtraction" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">subtract</span></code> function performs the pixel-wise subtraction between
two input images and returns the output image.</p>
<p>I<sub>out</sub>(x, y) = I<sub>in1</sub>(x, y) - I<sub>in2</sub>(x, y)</p>
<p>Where:</p>
<ul class="simple">
<li><p>I<sub>out</sub>(x, y) is the intensity of the output image at (x, y)
position</p></li>
<li><p>I<sub>in1</sub>(x, y) is the intensity of the first input image at
(x, y) position</p></li>
<li><p>I<sub>in2</sub>(x, y) is the intensity of the second input image at
(x, y) position.</p></li>
</ul>
<p>XF_CONVERT_POLICY_TRUNCATE: Results are the least significant bits of
the output operand, as if stored in two’s complement binary format in
the size of its bit-depth.</p>
<p>XF_CONVERT_POLICY_SATURATE: Results are saturated to the bit depth of
the output operand.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">subtract</span> <span class="p">(</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">,</span>
<span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="n">dst</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id238">
<caption><span class="caption-text">Table . subtract Parameter Description</span><a class="headerlink" href="#id238" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>POLICY_TYPE</p></td>
<td><p>Type of overflow handling. It can be either,
XF_CONVERT_POLICY_SATURATE or
XF_CONVERT_POLICY_TRUNCATE.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>pixel type. Options are XF_8UC1,XF_8UC3,XF_16SC3
and_16SC1.</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be a
multiple of 8, for 8-pixel operation)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>src2</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>62</p></td>
<td><p>53</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
<td><p>13</p></td>
<td><p>21</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization in different
configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K image with 3 channels.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>110</p></td>
<td><p>64</p></td>
<td><p>28</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="quantization-dithering">
<span id="quantizationdithering"></span><h2>Quantization &amp; Dithering<a class="headerlink" href="#quantization-dithering" title="Permalink to this headline">¶</a></h2>
<p>This algorithm dithers input image using Floyd-Steinberg dithering method. It is commonly used by image manipulation software, for example when an image is converted into GIF format each pixel intensity value is quantized to 8 bit i.e. 256 colors.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">IN_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">OUT_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SCALE_FACTOR</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAX_REPRESENTED_VALUE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">xf_QuatizationDithering</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">IN_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">stream_in</span><span class="p">,</span>
                             <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">OUT_TYPE</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;&amp;</span> <span class="n">stream_out</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id239">
<caption><span class="caption-text">Table Quantization &amp; Dithering Parameter Description</span><a class="headerlink" href="#id239" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IN_TYPE</p></td>
<td><p>Input pixel type. It should be XF_8UC1, XF_8UC3,
XF_10UC1, XF_10UC3, XF_12UC1,  XF_12UC3,  XF_16UC1,
or XF_16UC3. Note XF_&lt;PIXEL_BITWIDTH&gt;UC&lt;NUM_CHANNELS&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>OUT_TYPE</p></td>
<td><p>Output pixel type. It should be XF_8UC1, XF_8UC3,
XF_10UC1, XF_10UC3, XF_12UC1,  XF_12UC3,  XF_16UC1,
or XF_16UC3. Output PIXEL_WIDTH should less than or
equal to input PIXEL_BITWIDTH</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-even"><td><p>SCALE_FACTOR</p></td>
<td><p>The SCALE_FACTOR must be power of 2 &amp; less than or
equal to 2^(output PIXEL_BITWIDTH)</p></td>
</tr>
<tr class="row-odd"><td><p>MAX_REPRESENTED_VALUE</p></td>
<td><p>The MAX_REPRESENTED_VALUE must be equal to
equal to 2^(input PIXEL_BITWIDTH)</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options is XF_NPPC1 or XF_NPPC2</p></td>
</tr>
<tr class="row-odd"><td><p>stream_in</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>stream_out</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization  of the kernel in different configurations, generated using Vitis HLS 2020.2 tool for the Xilinx xcu200-fsgd2104-2-e FPGA, to process a RGB image with a resolution of 1024x676 &amp; pixel width 16 bit and quantized it to 8 bit pixel width.</p>
<table class="docutils align-default" id="id240">
<caption><span class="caption-text">Table Quantization &amp; Dithering Resource Utilization Summary</span><a class="headerlink" href="#id240" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency
(MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>11</p></td>
<td><p>10</p></td>
<td><p>7592</p></td>
<td><p>5765</p></td>
<td><p>1582</p></td>
</tr>
<tr class="row-even"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>14</p></td>
<td><p>12</p></td>
<td><p>8150</p></td>
<td><p>6945</p></td>
<td><p>1749</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in different configurations, as generated using Vitis HLS 2020.2 tool for the Xilinx xcu200-fsgd2104-2-e FPGA,  to process a RGB image with a resolution of 1024x676 &amp; pixel width 16 bit and quantized it to 8 bit pixel width.</p>
<table class="docutils align-default" id="id241">
<caption><span class="caption-text">Table Quantization &amp; Dithering Function Performance Estimate Summary</span><a class="headerlink" href="#id241" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p>
<p><strong>Max (ms)</strong></p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>2.8</p></td>
</tr>
<tr class="row-odd"><td><p>2 pixel</p></td>
<td><p>300</p></td>
<td><p>1.58</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="reduce">
<span id="id84"></span><h2>Reduce<a class="headerlink" href="#reduce" title="Permalink to this headline">¶</a></h2>
<p>The Reduce function reduces the matrix to a vector by treating rows/cols
as set of 1-D vectors and performing specified operation on vectors
until a single row/col is obtained.</p>
<p>Reduction operation could be one of the following:</p>
<ul class="simple">
<li><p>REDUCE_SUM : The output is the sum of all of the matrix’s
rows/columns.</p></li>
<li><p>REDUCE_AVG : The output is the mean vector of all of the matrix’s
rows/columns.</p></li>
<li><p>REDUCE_MAX : The output is the maximum (column/row-wise) of all of
the matrix’s rows/columns.</p></li>
<li><p>REDUCE_MIN : The output is the minimum (column/row-wise) of all of
the matrix’s rows/columns.</p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">REDUCE_OP</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span>  <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ONE_D_HEIGHT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ONE_D_WIDTH</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">reduce</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ONE_D_HEIGHT</span><span class="p">,</span> <span class="n">ONE_D_WIDTH</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">dim</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id242">
<caption><span class="caption-text">Table . Reduce Parameter Description</span><a class="headerlink" href="#id242" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>REDUCE_OP</p></td>
<td><p>The flag specifies the type of reduction operation
to be applied.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>ONE_D_HEIGHT</p></td>
<td><p>Height of output 1-D vector or reduced matrix</p></td>
</tr>
<tr class="row-even"><td><p>ONE_D_WIDTH</p></td>
<td><p>Width of output 1-D vector or reduced matrix</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
option is XF_NPPC1 (1 pixel per cycle).</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_mat</p></td>
<td><p>1-D vector</p></td>
</tr>
<tr class="row-even"><td><p>dim</p></td>
<td><p>Dimension index along which the matrix is reduced. 0
means that the matrix is reduced to a single row. 1
means that the matrix is reduced to a single column.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Reduce
function Normal mode(1 pixel) as generated using Vivado HLS 2019.1
version tool for the Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>288</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>172</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>54</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="remap">
<span id="id85"></span><h2>Remap<a class="headerlink" href="#remap" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">remap</span></code> function takes pixels from one place in the image and
relocates them to another position in another image. Two types of
interpolation methods are used here for mapping the image from source
to destination image.</div>
<div class="line"><img alt="image146" class="image" src="_images/nrr1554997329905.png" /></div>
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">WIN_ROWS</span><span class="p">,</span><span class="kt">int</span> <span class="n">INTERPOLATION_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">MAP_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>

<span class="kt">void</span> <span class="n">remap</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_src_mat</span><span class="p">,</span>
         <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_remapped_mat</span><span class="p">,</span>
         <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">MAP_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_mapx_mat</span><span class="p">,</span>
         <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">MAP_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_mapy_mat</span><span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template parameters.</p>
<table class="docutils align-default" id="id243">
<caption><span class="caption-text">Table . remap template .. rubric:: Parameter Descriptions</span><a class="headerlink" href="#id243" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WIN_ROWS</p></td>
<td><p>Number of input image rows to be buffered inside.
Must be set based on the map data. For instance, for
left right flip, 2 rows are sufficient.</p></td>
</tr>
<tr class="row-odd"><td><p>INTERPOLATIO
N_TYPE</p></td>
<td><p>Type of interpolation, either XF_INTERPOLATION_NN
(nearest neighbor) or XF_INTERPOLATION_BILINEAR
(linear interpolation)</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>MAP_T</p></td>
<td><p>Map type. Single channel float type. XF_32FC1.</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output image type. Grayscale image of type 8-bits and
single channel. XF_8UC1.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Height of input and output images</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Width of input and output images</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; this
function supports only XF_NPPC1 or 1 pixel per cycle
operations.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map some structures to UltraRAM instead of
BRAM.</p></td>
</tr>
</tbody>
</table>
<p>The following table describes the function parameters.</p>
<table class="docutils align-default" id="id244">
<caption><span class="caption-text">Table . remap Parameter Description</span><a class="headerlink" href="#id244" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PARAMETERS</p></th>
<th class="head"><p><strong>DESCRIPTION</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input xF Mat</p></td>
</tr>
<tr class="row-odd"><td><p>_remapped_m
at</p></td>
<td><p>Output xF Mat</p></td>
</tr>
<tr class="row-even"><td><p>_mapx_mat</p></td>
<td><p>mapX Mat of float type</p></td>
</tr>
<tr class="row-odd"><td><p>_mapy_mat</p></td>
<td><p>mapY Mat of float type</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of remap, for HD
(1080x1920) images generated in the Vivado HLS 2019.1 version tool for
the Xilinx xczu9eg-ffvb1156-i-es1 FPGA at 300 MHz, with WIN_ROWS as 64
for the XF_INTERPOLATION_BILINEAR mode.</p>
<table class="docutils align-default" id="id245">
<caption><span class="caption-text">Table . remap Function Resource Utilization Summary</span><a class="headerlink" href="#id245" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>1738</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>1593</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>360</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of remap, for 4K
(3840x2160) images generated in the Vivado HLS 2019.1 version tool for the
Xilinx xczu7ev-ffvc1156 FPGA at 300 MHz, with WIN_ROWS as 100 for the
XF_INTERPOLATION_BILINEAR mode using UltraRAM .</p>
<p>UltraRAM Enabled</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>URAM</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>FF</p></td>
<td><p>3196</p></td>
</tr>
<tr class="row-even"><td><p>LUT</p></td>
<td><p>3705</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of remap(), for HD
(1080x1920) images generated in the Vivado HLS 2019.1 version tool for
the Xilinx xczu9eg-ffvb1156-i-es1 FPGA at 300 MHz, with WIN_ROWS as 64
for XF_INTERPOLATION_BILINEAR mode.</p>
<table class="docutils align-default" id="id246">
<caption><span class="caption-text">Table . remap Function Performance Estimate Summary</span><a class="headerlink" href="#id246" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p>
<p>Max latency (ms)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel mode</p></td>
<td><p>300</p></td>
<td><p>7.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resolution-conversion">
<span id="id86"></span><h2>Resolution Conversion (Resize)<a class="headerlink" href="#resolution-conversion" title="Permalink to this headline">¶</a></h2>
<p>Resolution Conversion is the method used to resize the source image to
the size of the destination image. Different types of interpolation
techniques can be used in resize function, namely: Nearest-neighbor,
Bilinear, and Area interpolation. The type of interpolation can be
passed as a template parameter to the API. The following enumeration
types can be used to specify the interpolation type:</p>
<ul class="simple">
<li><p>XF_INTERPOLATION_NN - For Nearest-neighbor interpolation</p></li>
<li><p>XF_INTERPOLATION_BILINEAR - For Bilinear interpolation</p></li>
<li><p>XF_INTERPOLATION_AREA - For Area interpolation</p></li>
</ul>
<p>Note: Scaling factors greater than or equal to 0.25 are supported in
down-scaling and values less than or equal to 8 are supported for
up-scaling.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">INTERPOLATION_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="p">,</span><span class="kt">int</span> <span class="n">MAX_DOWN_SCALE</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">resize</span> <span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">SRC_ROWS</span><span class="p">,</span> <span class="n">SRC_COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">DST_ROWS</span><span class="p">,</span> <span class="n">DST_COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id247">
<caption><span class="caption-text">Table . resize Parameter Description</span><a class="headerlink" href="#id247" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>INTERPOLATIO
N_TYPE</p></td>
<td><p>Interpolation type. The different options possible
are</p>
<ul class="simple">
<li><p>XF_INTERPOLATION_NN – Nearest Neighbor
Interpolation</p></li>
<li><p>XF_INTERPOLATION_BILINEAR – Bilinear interpolation</p></li>
<li><p>XF_INTERPOLATION_AREA – Area Interpolation</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>TYPE</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>SRC_ROWS</p></td>
<td><p>Maximum Height of input image for which the hardware
kernel would be built.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_COLS</p></td>
<td><p>Maximum Width of input image for which the hardware
kernel would be built (must be a multiple of 8).</p></td>
</tr>
<tr class="row-even"><td><p>DST_ROWS</p></td>
<td><p>Maximum Height of output image for which the hardware
kernel would be built.</p></td>
</tr>
<tr class="row-odd"><td><p>DST_COLS</p></td>
<td><p>Maximum Width of output image for which the hardware
kernel would be built (must be a multiple of 8).</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Possible
options are XF_NPPC1 (1 pixel per cycle) and XF_NPPC8
(8 pixel per cycle).</p></td>
</tr>
<tr class="row-odd"><td><p>MAX_DOWN_SCA
LE</p></td>
<td><p>Set to 2 for all 1 pixel modes, and for upscale in x
direction. When down scaling in x direction in
8-pixel mode, please set this parameter to the next
highest integer value of the down scale factor i.e.,
if downscaling from 1920 columns to 1280 columns, set
to 2. For 1920 to 640, set to 3.</p></td>
</tr>
<tr class="row-even"><td><p>_src</p></td>
<td><p>Input Image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output Image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of Resize
function in Resource Optimized (8 pixel) mode and Normal mode, as
generated in the Vivado HLS 2019.1 tool for the Xilinx
xczu9eg-ffvb1156-2-i-es2 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 20%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Operating Mode</p></th>
<th class="head" colspan="10"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="5"><p>1 Pixel (at 300 MHz)</p></th>
<th class="head" colspan="5"><p>8 Pixel (at 150MHz)</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>IMAGESIZE</p></th>
<th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
<th class="head"><p>IMAGESIZE</p></th>
<th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Downscale Nearest Neighbor</p></td>
<td><p>1920X1080 TO 960X1620</p></td>
<td><p>1089</p></td>
<td><p>1593</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>2545</p></td>
<td><p>2250</p></td>
<td><p>4</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>Downscale Bilinear</p></td>
<td><p>1920X1080 TO 960X1080</p></td>
<td><p>1340</p></td>
<td><p>1846</p></td>
<td><p>8</p></td>
<td><p>2</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>5159</p></td>
<td><p>3092</p></td>
<td><p>36</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>Downscale Area</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>6146</p></td>
<td><p>8338</p></td>
<td><p>19</p></td>
<td><p>10</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>17892</p></td>
<td><p>19758</p></td>
<td><p>162</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-odd"><td><p>Upscale Nearest Neighbor</p></td>
<td><p>1920X1080 TO 3840X540</p></td>
<td><p>1089</p></td>
<td><p>1593</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>1818</p></td>
<td><p>1686</p></td>
<td><p>4</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>Upscale Bilinear</p></td>
<td><p>1920X1080 TO 3840X540</p></td>
<td><p>1340</p></td>
<td><p>1846</p></td>
<td><p>8</p></td>
<td><p>2</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>3697</p></td>
<td><p>2739</p></td>
<td><p>36</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>Upscale Area</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>5811</p></td>
<td><p>8773</p></td>
<td><p>28</p></td>
<td><p>32</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>12214</p></td>
<td><p>14003</p></td>
<td><p>98</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of Resize
function in Normal mode, as generated in the Vivado HLS 2019.1 tool for
the Xilinx xczu9eg-ffvb1156-2-i-es2 FPGA for 3channel image as input.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 31%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Operating Mode</p></th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="5"><p>1 Pixel (at 300 MHz)</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>IMAGESIZE</p></th>
<th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Downscale Nearest Neighbor</p></td>
<td><p>3840X2160 TO 1920X108</p></td>
<td><p>1184</p></td>
<td><p>168</p></td>
<td><p>4</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>Downscale Bilinear</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>1592</p></td>
<td><p>2058</p></td>
<td><p>14</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-even"><td><p>Downscale Area</p></td>
<td><p>3840X2160 TO 1920X1080</p></td>
<td><p>3212</p></td>
<td><p>4777</p></td>
<td><p>104</p></td>
<td><p>72</p></td>
</tr>
<tr class="row-odd"><td><p>Upscale Nearest Neighbor</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>1166</p></td>
<td><p>1697</p></td>
<td><p>4</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-even"><td><p>Upscale Bilinear</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>1574</p></td>
<td><p>2053</p></td>
<td><p>14</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-odd"><td><p>Upscale Area</p></td>
<td><p>1920X1080 TO 3840X2160</p></td>
<td><p>1731</p></td>
<td><p>2733</p></td>
<td><p>36</p></td>
<td><p>31</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance estimation of Resize for
various configurations, as generated in the Vivado HLS 2019.1 tool for
the xczu9eg-ffvb1156-2-i-es2 FPGA at 300 MHz to resize a grayscale image
from 1080x1920 to 480x640 (downscale); and to resize a grayscale image
from 1080x1920 to 2160x3840 (upscale). This table also shows the
latencies obtained for different interpolation types.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 19%" />
<col style="width: 21%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="6"><p>Latency Estimate (ms)</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Downscale</p>
<p>NN</p>
</th>
<th class="head"><p>Downscale</p>
<p>Bilinear</p>
</th>
<th class="head"><p>Downscale</p>
<p>Area</p>
</th>
<th class="head"><p>Upscale</p>
<p>NN</p>
</th>
<th class="head"><p>Upscale</p>
<p>Bilinear</p>
</th>
<th class="head"><p>Upscale</p>
<p>Area</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>6.94</p></td>
<td><p>6.97</p></td>
<td><p>7.09</p></td>
<td><p>27.71</p></td>
<td><p>27.75</p></td>
<td><p>27.74</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bgr2hsv">
<span id="id87"></span><h2>BGR2HSV<a class="headerlink" href="#bgr2hsv" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">BGR2HSV</span></code> function converts the input image color space to HSV
color space and returns the HSV image as the output.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
          <span class="kt">void</span> <span class="n">BGR2HSV</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The table below describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type should be XF_8UC3</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type should be XF_8UC3</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle. Only
XF_NPPC1 is supported.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scharr-filter">
<span id="id88"></span><h2>Scharr Filter<a class="headerlink" href="#scharr-filter" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Scharr</span></code> function computes the gradients of input image in both x
and y direction by convolving the kernel with input image being
processed.</p>
<p>For Kernel size 3x3:</p>
<ul class="simple">
<li><p>GradientX:
<img alt="image147" class="image" src="_images/wje1554997047563.png" /></p></li>
<li><p>GradientY:
<img alt="image148" class="image" src="_images/wge1554997033196.png" /></p></li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Scharr</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_matx</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_maty</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id248">
<caption><span class="caption-text">Table . Scharr Parameter Description</span><a class="headerlink" href="#id248" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>Border type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3
channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit unsigned, 16-bit
signed,1 and 3 channels are supported (XF_8UC1,
XF_16SC1,XF_8UC3 and XF_16SC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_matx</p></td>
<td><p>X gradient output image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst_maty</p></td>
<td><p>Y gradient output image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>728</p></td>
<td><p>1434</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>812</p></td>
<td><p>2481</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>171</p></td>
<td><p>461</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3 channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>1911</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>1392</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default" id="id249">
<caption><span class="caption-text">Table . Scharr Function Performance Estimate Summary</span><a class="headerlink" href="#id249" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 35%" />
<col style="width: 46%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency</p>
<p>(ms)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="set">
<span id="id89"></span><h2>Set<a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h2>
<p>The Set function sets the each pixel in input image to a given scalar
value and stores the result in dst.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">set</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id250">
<caption><span class="caption-text">Table . Set Parameter Description</span><a class="headerlink" href="#id250" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Scalar value</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Set
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>87</p></td>
<td><p>87</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>43</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>17</p></td>
<td><p>18</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sobel-filter">
<span id="id90"></span><h2>Sobel Filter<a class="headerlink" href="#sobel-filter" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Sobel</span></code> function Computes the gradients of input image in both x
and y direction by convolving the kernel with input image being
processed.</p>
<ul class="simple">
<li><p>For Kernel size 3x3</p>
<ul>
<li><p>GradientX:
<img alt="image149" class="image" src="_images/cpn1554997351734.svg" /></p></li>
<li><p>GradientY:
<img alt="image150" class="image" src="_images/lwl1554996996061.png" /></p></li>
</ul>
</li>
<li><p>For Kernel size 5x5</p>
<ul>
<li><p>GradientX:
<img alt="image151" class="image" src="_images/wtp1554997045334.png" /></p></li>
<li><p>GradientY:
<img alt="image152" class="image" src="_images/cua1554997256117.png" /></p></li>
</ul>
</li>
<li><p>For Kernel size 7x7</p>
<ul>
<li><p>GradientX:
<img alt="image153" class="image" src="_images/orr1554997031350.png" /></p></li>
<li><p>GradientY:
<img alt="image154" class="image" src="_images/hqv1554997071866.png" /></p></li>
</ul>
</li>
</ul>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span><span class="kt">int</span> <span class="n">FILTER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span><span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Sobel</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_matx</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_maty</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FILTER_TYPE</p></td>
<td><p>Filter size. Filter size of 3 (XF_FILTER_3X3), 5 (XF_FILTER_5X5) and 7 (XF_FILTER_7X7) are supported.</p></td>
</tr>
<tr class="row-odd"><td><p>BORDER_TYPE</p></td>
<td><p>Border Type supported is XF_BORDER_CONSTANT</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>DST_T</p></td>
<td><p>Output pixel type. Only 8-bit unsigned, 16-bit signed,1 and 3 channels are supported (XF_8UC1, XF_16SC1,XF_8UC3 and XF_16SC3)</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8 pixel operations respectively.</p></td>
</tr>
<tr class="row-odd"><td><p>USE_URAM</p></td>
<td><p>Enable to map storage structures to UltraRAM</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst_matx</p></td>
<td><p>X gradient output image.</p></td>
</tr>
<tr class="row-even"><td><p>_dst_maty</p></td>
<td><p>Y gradient output image.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><ol class="arabic simple">
<li><p>Sobel 7x7 8-pixel is not supported.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 21%" />
<col style="width: 22%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>609</p></td>
<td><p>616</p></td>
<td><p>135</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>5</p></td>
<td><p>0</p></td>
<td><p>1133</p></td>
<td><p>1499</p></td>
<td><p>308</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>7</p></td>
<td><p>0</p></td>
<td><p>2658</p></td>
<td><p>3334</p></td>
<td><p>632</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>6</p></td>
<td><p>0</p></td>
<td><p>1159</p></td>
<td><p>1892</p></td>
<td><p>341</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>10</p></td>
<td><p>0</p></td>
<td><p>3024</p></td>
<td><p>5801</p></td>
<td><p>999</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the
Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a 4K 3 Channel image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 22%" />
<col style="width: 23%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>18</p></td>
<td><p>0</p></td>
<td><p>1047</p></td>
<td><p>1107</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>30</p></td>
<td><p>0</p></td>
<td><p>5370</p></td>
<td><p>3312</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>42</p></td>
<td><p>0</p></td>
<td><p>6100</p></td>
<td><p>5496</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for the Xilinx
xczu7ev-ffvc1156-2-e FPGA, to process a grayscale 4K (3840x2160) image
with UltraRAM enable.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 21%" />
<col style="width: 22%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>URAM</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel</p></td>
<td><p>3x3</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>919</p></td>
<td><p>707</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>5x5</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>2440</p></td>
<td><p>1557</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7x7</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>4066</p></td>
<td><p>3495</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel</p></td>
<td><p>3x3</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>1803</p></td>
<td><p>2050</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>5x5</p></td>
<td><p>150</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>0</p></td>
<td><p>4159</p></td>
<td><p>6817</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1, to process a grayscale HD
(1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Filter Size</p></th>
<th class="head"><p>Latency Estimate</p>
<p>(ms)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>3x3</p></td>
<td><p>7.5</p></td>
</tr>
<tr class="row-odd"><td><p>300</p></td>
<td><p>5x5</p></td>
<td><p>7.5</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>7x7</p></td>
<td><p>7.5</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>3x3</p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>5x5</p></td>
<td><p>1.71</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="semi-global-method-for-stereo-disparity-estimation">
<span id="semi-global-method"></span><h2>Semi Global Method for Stereo Disparity Estimation<a class="headerlink" href="#semi-global-method-for-stereo-disparity-estimation" title="Permalink to this headline">¶</a></h2>
<p>Stereo matching algorithms are used for finding relative depth from a
pair of rectified stereo images. The resultant disparity information can
be used for 3D reconstruction by triangulation, using the known
intrinsic and extrinsic parameters of the stereo camera. The Semi global
method for stereo disparity estimation aggregates the cost in terms of
dissimilarity across multiple paths leading to a smoother estimate of
the disparity map.</p>
<p>For the semi-global method in Vitis Vision, census transform in conjunction
with Hamming distance is used for cost computation. The semiglobal
optimization block is based on the implementation by Hirschmuller, but
approximates the cost aggregation by considering only four directions.</p>
<p>Parallelism is achieved by computing and aggregating cost for multiple
disparities in parallel, and this parameter is included as a
compile-time input.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">BORDER_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WINDOW_SIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NDISP</span><span class="p">,</span> <span class="kt">int</span> <span class="n">PU</span><span class="p">,</span> <span class="kt">int</span> <span class="n">R</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">SemiGlobalBM</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat_l</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat_r</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span><span class="n">ROWS</span><span class="p">,</span><span class="n">COLS</span><span class="p">,</span><span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id251">
<caption><span class="caption-text">Table . SemiGlobalBM Parameter Description</span><a class="headerlink" href="#id251" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BORDER_TYPE</p></td>
<td><p>The border pixels are processed in Census transform
function based on this parameter. Only
XF_BORDER_CONSTANT is supported.</p></td>
</tr>
<tr class="row-odd"><td><p>WINDOW_SIZE</p></td>
<td><p>Size of the window used for Census transform
computation. Only ‘5’ (5x5) is supported.</p></td>
</tr>
<tr class="row-even"><td><p>NDISP</p></td>
<td><p>Number of disparities</p></td>
</tr>
<tr class="row-odd"><td><p>PU</p></td>
<td><p>Number of disparity units to be computed in parallel</p></td>
</tr>
<tr class="row-even"><td><p>R</p></td>
<td><p>Number of directions for cost aggregation. It must be
2, 3, or 4.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Type of input image Mat object. It must be XF_8UC1.</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Type of output disparity image Mat object. It must be
XF_8UC1.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of the input image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of the input image.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be computed in parallel. It must
be XF_NPPC1.</p></td>
</tr>
<tr class="row-even"><td><p>_src_mat_l</p></td>
<td><p>Left input image Mat</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat_r</p></td>
<td><p>Right input image Mat</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output disparity image Mat</p></td>
</tr>
<tr class="row-odd"><td><p>p1</p></td>
<td><p>Small penalty for cost aggregation</p></td>
</tr>
<tr class="row-even"><td><p>p2</p></td>
<td><p>Large penalty for cost aggregation. The maximum value
is 100.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization for a 1920 x
1080 image, with 64 number of disparities, and 32 parallel units.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head" rowspan="2"><p>Filter Size</p></th>
<th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 Pixel</p></td>
<td><p>5x5</p></td>
<td><p>200</p></td>
<td><p>205</p></td>
<td><p>141</p></td>
<td><p>11856</p></td>
<td><p>19102</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate for a 1920x1080
image.</p>
<table class="docutils align-default" id="id252">
<caption><span class="caption-text">Table . SemiGlobalBM Function Performance Estimate Summary</span><a class="headerlink" href="#id252" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating
Mode</p></th>
<th class="head"><p>Operating
Frequency</p></th>
<th class="head"><p>Number of
Disparities</p></th>
<th class="head"><p>Parallel
Units</p></th>
<th class="head"><p>Latency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1
pixel/clock</p></td>
<td><p>200 MHz</p></td>
<td><p>64</p></td>
<td><p>32</p></td>
<td><p>42 ms</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="stereo-local-block-matching">
<span id="stereo-local-block"></span><h2>Stereo Local Block Matching<a class="headerlink" href="#stereo-local-block-matching" title="Permalink to this headline">¶</a></h2>
<p>Stereo block matching is a method to estimate the motion of the blocks
between the consecutive frames, called stereo pair. The postulate behind
this idea is that, considering a stereo pair, the foreground objects
will have disparities higher than the background. Local block matching
uses the information in the neighboring patch based on the window size,
for identifying the conjugate point in its stereo pair. While, the
techniques under global method, used the information from the whole
image for computing the matching pixel, providing much better accuracy
than local methods. But, the efficiency in the global methods are
obtained with the cost of resources, which is where local methods stands
out.</p>
<p>Local block matching algorithm consists of pre-processing and disparity
estimation stages. The pre-processing consists of Sobel gradient
computation followed by image clipping. And the disparity estimation
consists of SAD (Sum of Absolute Difference) computation and obtaining
the disparity using winner takes all method (least SAD will be the
disparity). Invalidity of the pixel relies upon its uniqueness from the
other possible disparities. And the invalid pixels are indicated with
the disparity value of zero.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">WSIZE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NDISP</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NDISP_UNIT</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span> <span class="n">XF_NPPC1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">StereoBM</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_left_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_right_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">DST_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">_disp_mat</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">xFSBMState</span><span class="o">&lt;</span><span class="n">WSIZE</span><span class="p">,</span><span class="n">NDISP</span><span class="p">,</span><span class="n">NDISP_UNIT</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">sbmstate</span><span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id253">
<caption><span class="caption-text">Table . StereoBM Parameter Description</span><a class="headerlink" href="#id253" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WSIZE</p></td>
<td><p>Size of the window used for disparity computation</p></td>
</tr>
<tr class="row-odd"><td><p>NDISP</p></td>
<td><p>Number of disparities</p></td>
</tr>
<tr class="row-even"><td><p>NDISP_UNITS</p></td>
<td><p>Number of disparities to be computed in parallel.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1)</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output type. This is XF_16UC1, where the disparities
are arranged in Q12.4 format.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 only.</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map some storage structures to UltraRAM</p></td>
</tr>
<tr class="row-odd"><td><p>left_image</p></td>
<td><p>Image from the left camera</p></td>
</tr>
<tr class="row-even"><td><p>right_image</p></td>
<td><p>Image from the right camera</p></td>
</tr>
<tr class="row-odd"><td><p>disparity_im
age</p></td>
<td><p>Disparities output in the form of an image.</p></td>
</tr>
<tr class="row-even"><td><p>sbmstate</p></td>
<td><p>Class object consisting of various parameters
regarding the stereo block matching algorithm.</p>
<ol class="arabic simple">
<li><p>preFilterCap: Default value is 31, can be altered
by the user, value ranges from 1 to 63.</p></li>
<li><p>minDisparity: Default value is 0, can be altered
by the user, value ranges from 0 to
(imgWidth-NDISP).</p></li>
<li><p>uniquenessRatio: Default set to 15, but can be
altered to any non-negative integer.</p></li>
<li><p>textureThreshold: Default set to 10, but can be
modified to any non-negative integer.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 version tool
for the Xilinx® Xczu9eg-ffvb1156-1-i-es1 FPGA, to progress a grayscale
HD (1080x1920) image.</p>
<p>The configurations are in the format: imageSize_WSIZE_NDisp_NDispUnits.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 15%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Configurations</p></th>
<th class="head" rowspan="2"><p>Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18k</p></th>
<th class="head"><p>DSP48E</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>HD_5_16_2</p></td>
<td><p>300</p></td>
<td><p>37</p></td>
<td><p>20</p></td>
<td><p>6856</p></td>
<td><p>7181</p></td>
</tr>
<tr class="row-even"><td><p>HD_9_32_4</p></td>
<td><p>300</p></td>
<td><p>45</p></td>
<td><p>20</p></td>
<td><p>9700</p></td>
<td><p>10396</p></td>
</tr>
<tr class="row-odd"><td><p>HD_11_32_32</p></td>
<td><p>300</p></td>
<td><p>49</p></td>
<td><p>20</p></td>
<td><p>34519</p></td>
<td><p>31978</p></td>
</tr>
<tr class="row-even"><td><p>HD_15_128_32</p></td>
<td><p>300</p></td>
<td><p>57</p></td>
<td><p>20</p></td>
<td><p>41017</p></td>
<td><p>35176</p></td>
</tr>
<tr class="row-odd"><td><p>HD_21_64_16</p></td>
<td><p>300</p></td>
<td><p>69</p></td>
<td><p>20</p></td>
<td><p>29853</p></td>
<td><p>30706</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the kernel in
different configurations, generated using Vivado HLS 2019.1 version tool for
the Xilinx xczu7ev-ffvc1156-2-e FPGA, to progress a grayscale HD
(1080x1920) image with UltraRAM enable.</p>
<p>The configurations are in the format: imageSize_WSIZE_NDisp_NDispUnits.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 14%" />
<col style="width: 29%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Configurations</p></th>
<th class="head" rowspan="2"><p>Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18k</p></th>
<th class="head"><p>URAM</p></th>
<th class="head"><p>DSP48E</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>HD_5_16_2</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>12</p></td>
<td><p>20</p></td>
<td><p>7220</p></td>
<td><p>6529</p></td>
</tr>
<tr class="row-even"><td><p>HD_9_32_4</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>12</p></td>
<td><p>20</p></td>
<td><p>10186</p></td>
<td><p>9302</p></td>
</tr>
<tr class="row-odd"><td><p>HD_11_32_32</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>14</p></td>
<td><p>20</p></td>
<td><p>44046</p></td>
<td><p>30966</p></td>
</tr>
<tr class="row-even"><td><p>HD_15_128_32</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>14</p></td>
<td><p>20</p></td>
<td><p>50556</p></td>
<td><p>38132</p></td>
</tr>
<tr class="row-odd"><td><p>HD_21_64_16</p></td>
<td><p>300</p></td>
<td><p>0</p></td>
<td><p>16</p></td>
<td><p>20</p></td>
<td><p>35991</p></td>
<td><p>28464</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the Stereo
local block matching in different configurations, as generated using
Vivado HLS 2019.1 tool for Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA, to
process a grayscale HD (1080x1920) image.</p>
<p>The configurations are in the format: imageSize_WSIZE_NDisp_NDispUnits.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 22%" />
<col style="width: 29%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Configurations</p></th>
<th class="head" rowspan="2"><p>Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="2"><p>Latency (ms)</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min</p></th>
<th class="head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>HD_5_16_2</p></td>
<td><p>300</p></td>
<td><p>55.296</p></td>
<td><p>55.296</p></td>
</tr>
<tr class="row-even"><td><p>HD_9_32_4</p></td>
<td><p>300</p></td>
<td><p>55.296</p></td>
<td><p>55.296</p></td>
</tr>
<tr class="row-odd"><td><p>HD_11_32_32</p></td>
<td><p>300</p></td>
<td><p>6.912</p></td>
<td><p>6.912</p></td>
</tr>
<tr class="row-even"><td><p>HD_15_48_16</p></td>
<td><p>300</p></td>
<td><p>20.736</p></td>
<td><p>20.736</p></td>
</tr>
<tr class="row-odd"><td><p>HD_15_128_32</p></td>
<td><p>300</p></td>
<td><p>27.648</p></td>
<td><p>27.648</p></td>
</tr>
<tr class="row-even"><td><p>HD_21_64_16</p></td>
<td><p>300</p></td>
<td><p>27.648</p></td>
<td><p>27.648</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="subrs">
<span id="id91"></span><h2>SubRS<a class="headerlink" href="#subrs" title="Permalink to this headline">¶</a></h2>
<p>The SubRS function subtracts the intensity of the source image from a
scalar image and stores it in the destination image.</p>
<p>dst(I)= scl - src(I)</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">subRS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id254">
<caption><span class="caption-text">Table . SubRS Parameter Description</span><a class="headerlink" href="#id254" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Input scalar value,the size should be number of
channels</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the SubRS
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>103</p></td>
<td><p>104</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>44</p></td>
<td><p>133</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>23</p></td>
<td><p>43</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="subs">
<span id="id92"></span><h2>SubS<a class="headerlink" href="#subs" title="Permalink to this headline">¶</a></h2>
<p>The SubS function subtracts a scalar value from the intensity of source
image and stores it in the destination image.</p>
<p>dst(I)= src(I) - scl</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">POLICY_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span> <span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">subS</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">_scl</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)],</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id255">
<caption><span class="caption-text">Table . SubS Parameter Description</span><a class="headerlink" href="#id255" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>First Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_scl</p></td>
<td><p>Input scalar value, the size should be the number of
channels.</p></td>
</tr>
<tr class="row-even"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the SubS
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>103</p></td>
<td><p>104</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>44</p></td>
<td><p>133</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>23</p></td>
<td><p>43</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sum">
<span id="id93"></span><h2>Sum<a class="headerlink" href="#sum" title="Permalink to this headline">¶</a></h2>
<p>The sum function calculates the sum of all pixels in input image.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sum</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src1</span><span class="p">,</span><span class="kt">double</span> <span class="n">sum</span><span class="p">[</span><span class="n">XF_CHANNELS</span><span class="p">(</span><span class="n">SRC_T</span><span class="p">,</span><span class="n">NPC</span><span class="p">)])</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id256">
<caption><span class="caption-text">Table . Sum Parameter Description</span><a class="headerlink" href="#id256" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input pixel type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image (must be
multiple of 8).</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>Input image.</p></td>
</tr>
<tr class="row-odd"><td><p>sum</p></td>
<td><p>Array to store sum of all pixels in the image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Sum
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>341</p></td>
<td><p>408</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>304</p></td>
<td><p>338</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>71</p></td>
<td><p>87</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="svm">
<span id="id94"></span><h2>SVM<a class="headerlink" href="#svm" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">SVM</span></code> function is the SVM core operation, which performs dot
product between the input arrays. The function returns the resultant dot
product value with its fixed point type.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">SRC1_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC2_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">DST_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SVM</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC1_T</span><span class="p">,</span> <span class="n">ROWS1</span><span class="p">,</span> <span class="n">COLS1</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">in_1</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC2_T</span><span class="p">,</span> <span class="n">ROWS2</span><span class="p">,</span> <span class="n">COLS2</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">in_2</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">idx1</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">idx2</span><span class="p">,</span> <span class="n">uchar_t</span> <span class="n">frac1</span><span class="p">,</span> <span class="n">uchar_t</span> <span class="n">frac2</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">n</span><span class="p">,</span> <span class="n">uchar_t</span> <span class="o">*</span><span class="n">out_frac</span><span class="p">,</span> <span class="n">ap_int</span><span class="o">&lt;</span><span class="n">XF_PIXELDEPTH</span><span class="p">(</span><span class="n">DST_T</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id257">
<caption><span class="caption-text">Table . SVM Parameter Description</span><a class="headerlink" href="#id257" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC1_T</p></td>
<td><p>Input pixel type. 16-bit, signed, 1 channel (XF_16SC1)
is supported.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC2_T</p></td>
<td><p>Input pixel type. 16-bit, signed, 1 channel (XF_16SC1)
is supported.</p></td>
</tr>
<tr class="row-even"><td><p>DST_T</p></td>
<td><p>Output data Type. 32-bit, signed, 1 channel (XF_32SC1)
is supported.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS1</p></td>
<td><p>Number of rows in the first image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS1</p></td>
<td><p>Number of columns in the first image being processed.</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS2</p></td>
<td><p>Number of rows in the second image being processed.</p></td>
</tr>
<tr class="row-even"><td><p>COLS2</p></td>
<td><p>Number of columns in the second image being processed.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1.</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>Max number of kernel operations</p></td>
</tr>
<tr class="row-odd"><td><p>in_1</p></td>
<td><p>First Input Array.</p></td>
</tr>
<tr class="row-even"><td><p>in_2</p></td>
<td><p>Second Input Array.</p></td>
</tr>
<tr class="row-odd"><td><p>idx1</p></td>
<td><p>Starting index of the first array.</p></td>
</tr>
<tr class="row-even"><td><p>idx2</p></td>
<td><p>Starting index of the second array.</p></td>
</tr>
<tr class="row-odd"><td><p>frac1</p></td>
<td><p>Number of fractional bits in the first array data.</p></td>
</tr>
<tr class="row-even"><td><p>frac2</p></td>
<td><p>Number of fractional bits in the second array data.</p></td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>Number of kernel operations.</p></td>
</tr>
<tr class="row-even"><td><p>out_frac</p></td>
<td><p>Number of fractional bits in the resultant value.</p></td>
</tr>
<tr class="row-odd"><td><p>result</p></td>
<td><p>Resultant value</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the SVM
function, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 35%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="5"><p>Utilization Estimate (ms)</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>27</p></td>
<td><p>34</p></td>
<td><p>12</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 31%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Frequency (MHz)</p></th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head"><p>Min (cycles)</p></th>
<th class="head"><p>Max (cycles)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>204</p></td>
<td><p>204</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="thresholding">
<span id="id95"></span><h2>Thresholding<a class="headerlink" href="#thresholding" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Threshold</span></code> function performs thresholding operation on the input
image. There are several types of thresholding supported by the
function.</p>
<div class="image figure align-default" id="uti1504034282636-image-dsp-fd5-xfb">
<img alt="" src="_images/uln1554997116867.png" />
</div>
<div class="image figure align-default" id="uti1504034282636-image-lwp-kd5-xfb">
<img alt="" src="_images/tst1554997064684.png" />
</div>
<div class="image figure align-default" id="uti1504034282636-image-twr-4d5-xfb">
<img alt="" src="_images/ktk1554997270016.png" />
</div>
<div class="image figure align-default" id="uti1504034282636-image-qqd-5d5-xfb">
<img alt="" src="_images/efs1554997278968.png" />
</div>
<div class="image figure align-default" id="uti1504034282636-image-f33-yd5-xfb">
<img alt="" src="_images/rkl1554997109351.png" />
</div>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">THRESHOLD_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span><span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Threshold</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src_mat</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst_mat</span><span class="p">,</span><span class="kt">short</span> <span class="kt">int</span> <span class="n">thresh</span><span class="p">,</span><span class="kt">short</span> <span class="kt">int</span> <span class="n">maxval</span> <span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id258">
<caption><span class="caption-text">Table . Threshold Parameter Description</span><a class="headerlink" href="#id258" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>THRESHOLD_TY
PE</p></td>
<td><p>Type of thresholding.</p></td>
</tr>
<tr class="row-odd"><td><p>SRC_T</p></td>
<td><p>Input pixel type. Only 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-even"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. Must be
multiple of 8, for 8-pixel operation.</p></td>
</tr>
<tr class="row-even"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle.</p></td>
</tr>
<tr class="row-odd"><td><p>_src_mat</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>_dst_mat</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>thresh</p></td>
<td><p>Threshold value.</p></td>
</tr>
<tr class="row-even"><td><p>maxval</p></td>
<td><p>Maximum value to use with the <code class="docutils literal notranslate"><span class="pre">THRESH_BINARY</span></code> and
<code class="docutils literal notranslate"><span class="pre">THRESH_BINARY_INV</span></code> thresholding types.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the kernel
with binary thresholding in different configurations, generated using
Vivado HLS 2019.1 tool for the Xilinx Xczu9eg-ffvb1156-1 FPGA, to
process a grayscale HD (1080x1920) image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>110</p></td>
<td><p>154</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>61</p></td>
<td><p>139</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>16</p></td>
<td><p>37</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance of the kernel in
different configurations, as generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default" id="id259">
<caption><span class="caption-text">Table . Threshold Function Performance Estimate Summary</span><a class="headerlink" href="#id259" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 38%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operating Mode</p></th>
<th class="head"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency Estimate</p>
<p>(ms)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 pixel</p></td>
<td><p>300</p></td>
<td><p>7.2</p></td>
</tr>
<tr class="row-odd"><td><p>8 pixel</p></td>
<td><p>150</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="atan2">
<span id="id96"></span><h2>Atan2<a class="headerlink" href="#atan2" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Atan2LookupFP</span></code> function finds the arctangent of y/x. It returns
the angle made by the vector <img alt="image155" class="image" src="_images/lpz1554997361148.png" /> with respect to origin. The
angle returned by atan2 will also contain the quadrant information.</p>
<p><code class="docutils literal notranslate"><span class="pre">Atan2LookupFP</span></code> is a fixed point version of the standard atan2
function. This function implements the atan2 using a lookup table
approach. The values in the look up table are represented in Q4.12
format and so the values returned by this function are in Q4.12. A
maximum error of 0.2 degrees is present in the range of 89 to 90 degrees
when compared to the standard atan2 function available in glibc. For the
other angles (0 to 89) the maximum error is in the order of 10-3. This
function returns 0 when both xs and ys are zeroes.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">short</span> <span class="n">Atan2LookupFP</span><span class="p">(</span><span class="kt">short</span> <span class="n">xs</span><span class="p">,</span> <span class="kt">short</span> <span class="n">ys</span><span class="p">,</span> <span class="kt">int</span> <span class="n">M1</span><span class="p">,</span><span class="kt">int</span> <span class="n">N1</span><span class="p">,</span><span class="kt">int</span> <span class="n">M2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id260">
<caption><span class="caption-text">Table . Atan2LookupFP Parameter Description</span><a class="headerlink" href="#id260" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>xs</p></td>
<td><p>16-bit signed value x in fixed point format of QM1.N1</p></td>
</tr>
<tr class="row-odd"><td><p>ys</p></td>
<td><p>16-bit signed value y in fixed point format of QM2.N2</p></td>
</tr>
<tr class="row-even"><td><p>M1</p></td>
<td><p>Number of bits to represent integer part of x.</p></td>
</tr>
<tr class="row-odd"><td><p>N1</p></td>
<td><p>Number of bits to represent fractional part of y.
Must be equal to 16-M1.</p></td>
</tr>
<tr class="row-even"><td><p>M2</p></td>
<td><p>Number of bits to represent integer part of y.</p></td>
</tr>
<tr class="row-odd"><td><p>N2</p></td>
<td><p>Number of bits to represent fractional part of y.
Must be equal to 16-N1.</p></td>
</tr>
<tr class="row-even"><td><p>Return</p></td>
<td><p>Return value is in radians. Its range varies from -pi
to +pi in fixed point format of Q4.12</p></td>
</tr>
</tbody>
</table>
<p>..rubric:: Resource Utilization</p>
<p>The following table summarizes the resource utilization of the
<code class="docutils literal notranslate"><span class="pre">Atan2LookupFP</span></code> function , generated using Vivado HLS 2019.1 tool for
the Xilinx Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 32%" />
<col style="width: 15%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>275</p></td>
<td><p>75</p></td>
<td><p>139</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 34%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min (cycles)</p></th>
<th class="head"><p>Max (cycles)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>1</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="inverse-reciprocal">
<span id="inverse"></span><h2>Inverse (Reciprocal)<a class="headerlink" href="#inverse-reciprocal" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Inverse</span></code> function computes the reciprocal of a number x. The
values of 1/x are stored in a look up table of 2048 size. The index for
picking the 1/x value is computed using the fixed point format of x.
Once this index is computed, the corresponding 1/x value is fetched from
the look up table and returned along with the number of fractional bits
needed to represent this value in fixed point format.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Inverse</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">M</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id261">
<caption><span class="caption-text">Table . Inverse Parameter Description</span><a class="headerlink" href="#id261" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>16-bit unsigned value x in fixed point format of
QM.(16-M)</p></td>
</tr>
<tr class="row-odd"><td><p>M</p></td>
<td><p>Number of bits to represent integer part of x.</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>Pointer to a char variable which stores the number of
bits to represent fractional part of 1/x. This value
is returned from the function.</p></td>
</tr>
<tr class="row-odd"><td><p>Return</p></td>
<td><p>1/x value is returned in 32-bit format represented by
a fixed point format of Q(32-N).N</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Inverse
function, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 32%" />
<col style="width: 15%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>4</p></td>
<td><p>0</p></td>
<td><p>68</p></td>
<td><p>128</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 34%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min (cycles)</p></th>
<th class="head"><p>Max (cycles)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>1</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="square-root">
<span id="id97"></span><h2>Square Root<a class="headerlink" href="#square-root" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Sqrt</span></code> function computes the square root of a 16-bit fixed point
number using the non-restoring square root algorithm. The non-restoring
square root algorithm uses the two’s complement representation for the
square root result. At each iteration the algorithm can generate exact
result value even in the last bit.</p>
<p>Input argument D must be 16-bit number, though it is declared as 32-bit.
The output sqrt(D) is 16-bit type. If format of D is QM.N (where M+N =
16) then format of output is Q(M/2).N</p>
<p>To get a precision of ‘n’ bits in fractional part, you can simply left
shift the radicand (D) by ‘2n’ before the function call and shift the
solution right by ‘n’ to get the correct answer. For example, to find
the square root of 35 (01100011:sub:<cite>2</cite>) with one bit after the decimal
point, that is, N=1:</p>
<ol class="arabic simple">
<li><p>Shift the number (0110001100:sub:<cite>2</cite>) left by 2</p></li>
<li><p>Shift the answer (1011:sub:<cite>2</cite>) right by 1. The correct answer is
101.1, which is 5.5.</p></li>
</ol>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">Sqrt</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id262">
<caption><span class="caption-text">Table . Sqrt Parameter Description</span><a class="headerlink" href="#id262" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>D</p></td>
<td><p>Input data in a 16-bit fixed-point format.</p></td>
</tr>
<tr class="row-odd"><td><p>Return</p></td>
<td><p>Output value in short int format.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Sqrt
function, generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 33%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>BRAM_18K</p></th>
<th class="head"><p>DSP_48Es</p></th>
<th class="head"><p>FF</p></th>
<th class="head"><p>LUT</p></th>
<th class="head"><p>CLB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>8</p></td>
<td><p>6</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes the performance in different
configurations, as generated using Vivado HLS 2019.1 tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 34%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="2"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Min (cycles)</p></th>
<th class="head"><p>Max (cycles)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>300</p></td>
<td><p>18</p></td>
<td><p>18</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="warptransform">
<span id="id98"></span><h2>WarpTransform<a class="headerlink" href="#warptransform" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">warpTransform</span></code> function is designed to perform the perspective
and affine geometric transformations on an image. The type of transform
is a compile time parameter to the function.</p>
<p>The function uses a streaming interface to perform the transformation.
Due to this and due to the fact that geometric transformations need
access to many different rows of input data to compute one output row,
the function stores some rows of the input data in block RAMs/UltraRAMs.
The number of rows the function stores can be configured by the user by
modifying a template parameter. Based on the transformation matrix, you
can decide on the number of rows to be stored. You can also choose when
to start transforming the input image in terms of the number of rows of
stored image.</p>
<p>Affine Transformation</p>
<p>The transformation matrix consists of size parameters, and is as shown:</p>
<p><img alt="image156" class="image" src="_images/iyi1554997248593.png" /></p>
<p>Affine transformation is applied in the warpTransform function following
the equation:</p>
<p><img alt="image157" class="image" src="_images/alo1554997278303.png" /></p>
<p>Perspective Transformation</p>
<p>The transformation matrix is a 3x3 matrix as shown below:</p>
<p><img alt="image158" class="image" src="_images/htp1554997315669.png" /></p>
<p>Perspective transformation is applied in warpTransform following the
equation:</p>
<p><img alt="image159" class="image" src="_images/vxm1554997273591.png" /></p>
<p>The destination pixel is then computed by dividing the first two
dimensions of the dst1 by the third dimension</p>
<p><img alt="image160" class="image" src="_images/iwp1554997301948.png" /></p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">STORE_LINES</span><span class="p">,</span> <span class="kt">int</span> <span class="n">START_ROW</span><span class="p">,</span> <span class="kt">int</span> <span class="n">TRANSFORMATION_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">INTERPOLATION_TYPE</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SRC_T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kt">bool</span> <span class="n">USE_URAM</span><span class="o">=</span><span class="nb">false</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">warpTransform</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span> <span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">dst</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">transformation_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id263">
<caption><span class="caption-text">Table . warpTransform Parameter Description</span><a class="headerlink" href="#id263" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>STORE_LINES</p></td>
<td><p>Number of lines to store an input to process a given
transformation.</p></td>
</tr>
<tr class="row-odd"><td><p>START_ROW</p></td>
<td><p>Number of the input rows to store before starting the
image transformation. This must be less than or equal
to STORE_LINES.</p></td>
</tr>
<tr class="row-even"><td><p>TRANSFORMATI
ON_TYPE</p></td>
<td><p>Affine and perspective transformations are supported.
Set this flag to ‘0’ for affine and ‘1’ for
perspective transformation.</p></td>
</tr>
<tr class="row-odd"><td><p>INTERPOLATIO
N_TYPE</p></td>
<td><p>Set flag to ‘1’ for bilinear interpolation and ‘0’
for nearest neighbor interpolation.</p></td>
</tr>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input and Output pixel type. Only 8-bit, unsigned, 1
and 3 channels are supported (XF_8UC1 and XF_8UC3)</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; only
one-pixel operation supported (XF_NPPC1).</p></td>
</tr>
<tr class="row-even"><td><p>USE_URAM</p></td>
<td><p>Enable to map some storage structures to UltraRAM</p></td>
</tr>
<tr class="row-odd"><td><p>src</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-even"><td><p>dst</p></td>
<td><p>Output image</p></td>
</tr>
<tr class="row-odd"><td><p>transformati
on_matrix</p></td>
<td><p>Transformation matrix that is applied to the input
image.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Warp
transform, generated using Vivado HLS 2019.1 version tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 16%" />
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Transformation</p></th>
<th class="head" rowspan="2"><p>INTERPOLATION _TYPE</p></th>
<th class="head" rowspan="2"><p>STORE _LINES</p></th>
<th class="head" rowspan="2"><p>START _ROW</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Perspective</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7468</p></td>
<td><p>9804</p></td>
<td><p>61</p></td>
<td><p>112</p></td>
</tr>
<tr class="row-even"><td><p>Perspective</p></td>
<td><p>Nearest Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>4514</p></td>
<td><p>6761</p></td>
<td><p>35</p></td>
<td><p>104</p></td>
</tr>
<tr class="row-odd"><td><p>Affine</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>6139</p></td>
<td><p>5606</p></td>
<td><p>40</p></td>
<td><p>124</p></td>
</tr>
<tr class="row-even"><td><p>Affine</p></td>
<td><p>Nearest Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>4611</p></td>
<td><p>4589</p></td>
<td><p>18</p></td>
<td><p>112</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the Warp
transform, generated using Vivado HLS 2019.1 version tool for the Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a BGR 4K image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 16%" />
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Transformation</p></th>
<th class="head" rowspan="2"><p>INTERPOLATION _TYPE</p></th>
<th class="head" rowspan="2"><p>STORE _LINES</p></th>
<th class="head" rowspan="2"><p>START _ROW</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="4"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Perspective</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>9192</p></td>
<td><p>7910</p></td>
<td><p>48</p></td>
<td><p>616</p></td>
</tr>
<tr class="row-even"><td><p>Perspective</p></td>
<td><p>Nearest Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>10533</p></td>
<td><p>12055</p></td>
<td><p>69</p></td>
<td><p>604</p></td>
</tr>
<tr class="row-odd"><td><p>Affine</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>6397</p></td>
<td><p>8415</p></td>
<td><p>35</p></td>
<td><p>604</p></td>
</tr>
</tbody>
</table>
<p>The following table summarizes the resource utilization of the Warp
transform, generated using Vivado HLS 2019.1 version tool for the Xilinx
xczu7ev-ffvc1156-2-e FPGA, to progress a grayscale 4K image with
UltraRAM enabled.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Transformation</p></th>
<th class="head" rowspan="2"><p>INTERPOLATION _TYPE</p></th>
<th class="head" rowspan="2"><p>STORE _LINES</p></th>
<th class="head" rowspan="2"><p>START _ROW</p></th>
<th class="head" rowspan="2"><p>Operating Frequency</p>
<p>(MHz)</p>
</th>
<th class="head" colspan="5"><p>Utilization Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>LUTs</p></th>
<th class="head"><p>FFs</p></th>
<th class="head"><p>DSPs</p></th>
<th class="head"><p>BRAMs</p></th>
<th class="head"><p>URAM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Perspective</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7820</p></td>
<td><p>12458</p></td>
<td><p>61</p></td>
<td><p>7</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>Perspective</p></td>
<td><p>Nearest Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>4880</p></td>
<td><p>8323</p></td>
<td><p>35</p></td>
<td><p>2</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>Affine</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>6850</p></td>
<td><p>9516</p></td>
<td><p>40</p></td>
<td><p>13</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-even"><td><p>Affine</p></td>
<td><p>Nearest Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>4651</p></td>
<td><p>6548</p></td>
<td><p>18</p></td>
<td><p>6</p></td>
<td><p>6</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the Warp
transform, as generated using Vivado HLS 2019.1 tool for Xilinx
Xczu9eg-ffvb1156-1-i-es1 FPGA, to process a grayscale HD (1080x1920)
image.</p>
<p>Summary</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 16%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Transforma
tion</p></th>
<th class="head"><p>INTERPOLATI
ON
_TYPE</p></th>
<th class="head"><p>STORE
_LIN
ES</p></th>
<th class="head"><p>START
_ROW</p></th>
<th class="head"><p>Operatin
g
Frequenc
y</p>
<p>(MHz)</p>
</th>
<th class="head"><p>Latency
Estimate</p>
<p>Max (ms)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Perspectiv
e</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7.46</p></td>
</tr>
<tr class="row-odd"><td><p>Perspectiv
e</p></td>
<td><p>Nearest
Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7.31</p></td>
</tr>
<tr class="row-even"><td><p>Affine</p></td>
<td><p>Bilinear</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7.31</p></td>
</tr>
<tr class="row-odd"><td><p>Affine</p></td>
<td><p>Nearest
Neighbor</p></td>
<td><p>100</p></td>
<td><p>50</p></td>
<td><p>300</p></td>
<td><p>7.24</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="zero">
<span id="id99"></span><h2>Zero<a class="headerlink" href="#zero" title="Permalink to this headline">¶</a></h2>
<p>The Zero function sets the each pixel in input image to zero and stores
the result in dst.</p>
<p class="rubric">API Syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="n">SRC_T</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">ROWS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">COLS</span><span class="p">,</span> <span class="kt">int</span> <span class="n">NPC</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">zero</span><span class="p">(</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_src1</span><span class="p">,</span><span class="n">xf</span><span class="o">::</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&lt;</span><span class="n">SRC_T</span><span class="p">,</span> <span class="n">ROWS</span><span class="p">,</span> <span class="n">COLS</span><span class="p">,</span> <span class="n">NPC</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Parameter Descriptions</p>
<p>The following table describes the template and the function parameters.</p>
<table class="docutils align-default" id="id264">
<caption><span class="caption-text">Table . Zero Parameter Description</span><a class="headerlink" href="#id264" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SRC_T</p></td>
<td><p>Input Pixel Type. 8-bit, unsigned, 1 channel is
supported (XF_8UC1).</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>Maximum height of input and output image.</p></td>
</tr>
<tr class="row-even"><td><p>COLS</p></td>
<td><p>Maximum width of input and output image. In case of
N-pixel parallelism, width should be multiple of N.</p></td>
</tr>
<tr class="row-odd"><td><p>NPC</p></td>
<td><p>Number of pixels to be processed per cycle; possible
options are XF_NPPC1 and XF_NPPC8 for 1 pixel and 8
pixel operations respectively.</p></td>
</tr>
<tr class="row-even"><td><p>_src1</p></td>
<td><p>Input image</p></td>
</tr>
<tr class="row-odd"><td><p>_dst</p></td>
<td><p>Output image</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Resource Utilization</p>
<p>The following table summarizes the resource utilization of the Zero
function in Resource optimized (8 pixel) mode and normal mode as
generated using Vivado HLS 2019.1 version tool for the
Xczu9eg-ffvb1156-1-i-es1 FPGA.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="3"><p>Name</p></th>
<th class="head" colspan="2"><p>Resource Utilization</p></th>
</tr>
<tr class="row-even"><th class="head"><p>1 pixel per clock operation</p></th>
<th class="head"><p>8 pixel per clock operation</p></th>
</tr>
<tr class="row-odd"><th class="head"><p>300 MHz</p></th>
<th class="head"><p>150 MHz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BRAM_18K</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DSP48E</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>FF</p></td>
<td><p>78</p></td>
<td><p>78</p></td>
</tr>
<tr class="row-odd"><td><p>LUT</p></td>
<td><p>42</p></td>
<td><p>41</p></td>
</tr>
<tr class="row-even"><td><p>CLB</p></td>
<td><p>15</p></td>
<td><p>14</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Performance Estimate</p>
<p>The following table summarizes a performance estimate of the kernel in
different configurations, generated using Vivado HLS 2019.1 tool for
Xczu9eg-ffvb1156-1-i-es1 FPGA to process a grayscale HD (1080x1920)
image.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Operating Mode</p></th>
<th class="head"><p>Latency Estimate</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Max Latency (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1 pixel operation (300 MHz)</p></td>
<td><p>6.9</p></td>
</tr>
<tr class="row-even"><td><p>8 pixel operation (150 MHz)</p></td>
<td><p>1.7</p></td>
</tr>
</tbody>
</table>
<p><sup>1</sup> N. Dalal, B. Triggs: Histograms of oriented gradients for human
detection, IEEE Computer Society Conference on Computer Vision and
Pattern Recognition, 2005.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->

</footer>

        </div>
      </div>
	  
	  
	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on February 03, 2021.
      </span>

    </p>
  </div>	  
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
  

  
  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2020, Xilinx
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}
			
			underscoreSetup();
		</script>
	</body>
</html>